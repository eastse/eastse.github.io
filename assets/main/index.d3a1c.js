System.register("chunks:///_virtual/AccountLabel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./GameData.ts"],(function(t){var n,e,a,c,o,r,u,l;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,a=t._decorator,c=t.Label,o=t.Component},function(t){r=t.default,u=t.EventType},function(t){l=t.GameData}],execute:function(){var i;e._RF.push({},"75f7a5MSJ9F97MnZCThRyzL","AccountLabel",void 0);var s=a.ccclass;a.property,t("AccountLabel",s("AccountLabel")(i=function(t){function e(){for(var n,e=arguments.length,a=new Array(e),c=0;c<e;c++)a[c]=arguments[c];return(n=t.call.apply(t,[this].concat(a))||this).label=void 0,n}n(e,t);var a=e.prototype;return a.start=function(){this.label=this.getComponent(c),this.label.string=""+l.balance,r.Instance.add(u.account,this.updateAccountInfo,this)},a.updateAccountInfo=function(){this.label.string=""+l.balance},e}(o))||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/Audio.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts"],(function(e){var t,i,n,o,r,a,c,u,p,l,s;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,c=e.Enum,u=e.Node,p=e.Component},function(e){l=e.AudioType,s=e.AudioManager}],execute:function(){var y,d,f,h,v;r._RF.push({},"ff44aTqMyJMwLktqmLQuEhD","Audio",void 0);var A=a.ccclass,g=a.property;e("Audio",(y=A("Audio"),d=g({type:c(l)}),y((v=t((h=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"type",v,o(t)),t}i(t,e);var r=t.prototype;return r.onLoad=function(){this.node.on(u.EventType.TOUCH_END,this.play,this)},r.play=function(){s.play(l.click)},t}(p)).prototype,"type",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return l.click}}),f=h))||f));r._RF.pop()}}}));

System.register("chunks:///_virtual/AudioButton.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts"],(function(t){var e,n,i,o,r,u,a,c,p,s,l,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,u=t._decorator,a=t.Sprite,c=t.Enum,p=t.Node,s=t.Button},function(t){l=t.AudioType,y=t.AudioManager}],execute:function(){var d,f,h,g,v,A;r._RF.push({},"872704ZXSxOCKKu88lgxQzs","AudioButton",void 0);var B=u.ccclass,_=u.property,b=u.requireComponent;t("AudioButton",(d=B("AudioButton"),f=b(a),h=_({type:c(l)}),d(g=f((A=e((v=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];return(e=t.call.apply(t,[this].concat(r))||this)._transition=3,i(e,"type",A,o(e)),e}n(e,t);var r=e.prototype;return r.start=function(){this.node.on(p.EventType.TOUCH_END,this.play,this)},r.play=function(){this.enabled&&y.play(this.type)},e}(s)).prototype,"type",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return l.click}}),g=v))||g)||g));r._RF.pop()}}}));

System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts"],(function(t){var e,n,i,o,u,r,a,s;return{setters:[function(t){e=t.asyncToGenerator,n=t.regeneratorRuntime},function(t){i=t.cclegacy,o=t.Node,u=t.AudioSource,r=t.director,a=t.resources},function(t){s=t.GameData}],execute:function(){i._RF.push({},"7681bFQnlNBNoqgLQ2JkqE0","AudioManager",void 0);var c=t("AudioType",function(t){return t[t.bg=0]="bg",t[t.click=1]="click",t[t.shoot=2]="shoot",t[t.rocket=3]="rocket",t}({})),d=t("AudioManager",function(){function t(){}return t.init=function(){var t=new o;t.name="__audioMgr__";var e=new o;e.name="__bgMgr__",t.addChild(e),this.bgAudio=e.addComponent(u),r.getScene().addChild(t),r.addPersistRootNode(t),this.audio=t.addComponent(u)},t.play=function(){var t=e(n().mark((function t(e,i){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===i&&(i=1),!s.mute){t.next=3;break}return t.abrupt("return");case 3:if(this.sounds.hasOwnProperty(e)){t.next=9;break}return t.next=6,this.loadAudioClip(e);case 6:if(t.sent){t.next=9;break}return t.abrupt("return");case 9:this.audio.playOneShot(this.sounds[e],i);case 10:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),t.playMusic=function(){var t=e(n().mark((function t(){var e;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!s.mute){t.next=2;break}return t.abrupt("return");case 2:if(this.sounds.hasOwnProperty(c.bg)){t.next=12;break}return t.next=5,this.loadAudioClip(c.bg);case 5:if(e=t.sent,this.bgAudio.clip=this.sounds[c.bg],this.bgAudio.volume=.5,this.bgAudio.loop=!0,this.bgAudio.playOnAwake=!1,e){t.next=12;break}return t.abrupt("return");case 12:this.bgAudio.play();case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),t.stopMusic=function(){this.bgAudio.stop()},t.toggleMusic=function(){s.mute?(s.mute=!1,this.playMusic()):(s.mute=!0,this.audio.stop(),this.stopMusic())},t.toggleSound=function(){s.mute=!s.mute},t.loadAudioClip=function(t){var e=this;return new Promise((function(n,i){var o=c[t];a.load("audio/"+o,(function(i,o){i?n(!1):(e.sounds[t]=o,n(!0))}))}))},t}());d.audio=void 0,d.bgAudio=void 0,d.sounds={},d.audioID={},i._RF.pop()}}}));

System.register("chunks:///_virtual/BalanceView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseView.ts"],(function(e){var n,t,c,a;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,c=e._decorator},function(e){a=e.default}],execute:function(){var i,o;t._RF.push({},"7501994iX5CFKFD1aNcT+/E","BalanceView",void 0);var r=c.ccclass;c.property,e("BalanceView",r("BalanceView")(((o=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t.prototype.onBack=function(){this.close()},t}(a)).PREFAB_NAME="balance",i=o))||i);t._RF.pop()}}}));

System.register("chunks:///_virtual/Base.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./Skill.ts"],(function(t){var e,i,n,o,s,r,a,l,h,c,p,u,f,d,b,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,r=t._decorator,a=t.SpriteFrame,l=t.Color,h=t.Sprite,c=t.BoxCollider2D,p=t.Contact2DType,u=t.tween,f=t.Component},function(t){d=t.EventType,b=t.default},function(t){v=t.Skill}],execute:function(){var g,m,C,y,w,D,B,S,_;s._RF.push({},"5df61sDr0NHAKbOav3/NuIx","Base",void 0);var E=r.ccclass,I=r.property;t("Base",(g=E("Base"),m=I(a),C=I(a),y=I(a),g((B=e((D=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return e=t.call.apply(t,[this].concat(s))||this,n(e,"open",B,o(e)),n(e,"close",S,o(e)),n(e,"hit",_,o(e)),e.sprite=void 0,e.initColor=new l(255,255,255,255),e.hitColor=new l(255,0,0,255),e.hp=void 0,e}i(e,t);var s=e.prototype;return s.init=function(t){this.hp=t},s.start=function(){this.sprite=this.getComponent(h),this.node.on(d.melee,this.onMeleeEvent,this),this.getComponent(c).on(p.BEGIN_CONTACT,this.onBeginContact,this)},s.onBeginContact=function(t,e){if(!(this.hp<=0)){var i=e.node.getComponent(v).getDamage(),n=i[0],o=i[1];b.Instance.emit(d.base_hit,n,o),this.showHitStatus(),this.hp-=n,this.hp<=0&&this.baseDead()}},s.onMeleeEvent=function(t){b.Instance.emit(d.base_hit,t,!1),this.showHitStatus(),this.hp-=t,this.hp<=0&&this.baseDead()},s.baseDead=function(){b.Instance.emit(d.base_dead),this.node.off(d.melee,this.onMeleeEvent,this)},s.showHitStatus=function(){u(this.sprite).to(.1,{color:this.hitColor}).to(.1,{color:this.initColor}).start()},e}(f)).prototype,"open",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=e(D.prototype,"close",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=e(D.prototype,"hit",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=D))||w));s._RF.pop()}}}));

System.register("chunks:///_virtual/BaseView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIManager.ts"],(function(e){var t,n,o,i,a,r,c,l,s,u,p,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.createClass},function(e){r=e.cclegacy,c=e._decorator,l=e.BlockInputEvents,s=e.CCBoolean,u=e.log,p=e.Component},function(e){f=e.default}],execute:function(){var h,y,g,B,v,_;r._RF.push({},"d8c1auxg9dL34pRqF4H7CKy","BaseView",void 0);var d=c.ccclass,C=c.property,k=c.requireComponent;e("default",(h=k(l),y=C(s),d(g=h(((_=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,o(t,"openAnim",v,i(t)),t._tag=void 0,t._closeCallBack=void 0,t}n(t,e);var r=t.prototype;return r.closeCallBack=function(){this._closeCallBack&&this._closeCallBack.apply(this,arguments)},r.close=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t&&this.closeCallBack.apply(this,t),f.close(this)},r.init=function(){},r.onDestroy=function(){},r.onShow=function(){u("BaseUI onShow")},a(t,[{key:"tag",get:function(){return this._tag},set:function(e){this._tag=e}}],[{key:"URL",get:function(){return"view/"+this.PREFAB_NAME}}]),t}(p)).PREFAB_NAME="BaseUI",v=t((B=_).prototype,"openAnim",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),g=B))||g)||g));r._RF.pop()}}}));

System.register("chunks:///_virtual/Boss.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigManager.ts","./Utils.ts","./Bullet.ts","./EventManager.ts","./GameDefined.ts","./Skill.ts"],(function(t){var e,n,i,s,o,a,r,h,c,d,u,l,p,f,m,v,g,k;return{setters:[function(t){e=t.inheritsLoose,n=t.asyncToGenerator,i=t.regeneratorRuntime},function(t){s=t.cclegacy,o=t._decorator,a=t.sp,r=t.UITransform,h=t.BoxCollider2D,c=t.Contact2DType,d=t.Component,u=t.Vec3},function(t){l=t.default},function(t){p=t.default},function(t){f=t.Bullet},function(t){m=t.default,v=t.EventType},function(t){g=t.BossType},function(t){k=t.Skill}],execute:function(){var C;s._RF.push({},"91d16OHxsdDQJoITMQysbBA","Boss",void 0);var y=o.ccclass,D=(o.property,function(t){return t.idle="idle",t.run="run",t.stand="stand",t}(D||{})),b=function(t){return t[t.ready=0]="ready",t[t.idle=1]="idle",t[t.attack=2]="attack",t[t.dead=3]="dead",t}(b||{});t("Boss",y("Boss")(C=function(t){function s(){for(var e,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))||this).base=void 0,e.bossType=void 0,e.spine=void 0,e.config=void 0,e.width=void 0,e.status=b.ready,e.hp=void 0,e.maxHp=void 0,e.roles=[],e.skillCD={},e.isGameOver=!1,e}e(s,t);var o=s.prototype;return o.onLoad=function(){this.spine=this.getComponent(a.Skeleton)},o.init=function(){var t=n(i().mark((function t(e,n){var s=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.bossType=e.id,this.base=n,this.config=e,this.hp=p.random(e.hp[0],e.hp[1]),this.maxHp=this.hp,e.skill.forEach((function(t){var e=t.range/10*l.MAX_RANGE;s.skillCD[t.id]={id:t.id,cd:t.cd,range:e},s.updateSkillCD(t.id,t.cd)}));case 6:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),o.start=function(){var t=this;this.width=this.node.getComponent(r).width,this.getComponent(h).on(c.BEGIN_CONTACT,this.onBeginContact,this),this.scheduleOnce((function(){t.status=b.idle,t.spine.setAnimation(0,D.run,!0)}),2),m.Instance.on(v.role_dead,this.onRoleDead,this),m.Instance.on(v.base_dead,this.onBaseBoomEvent,this),this.node.on(v.melee,this.onMeleeEvent,this),this.node.on(v.role_enter,this.onRoleEnter,this),this.spine.setEventListener(this.onSpineEvent.bind(this))},o.onBaseBoomEvent=function(){this.isGameOver=!0,this.status=b.ready,this.spine.setAnimation(0,D.stand,!0)},o.bossDead=function(){m.Instance.emit(v.boss_dead),this.status=b.dead,this.unscheduleAllCallbacks(),this.node.destroy(),m.Instance.remove(v.role_dead,this.onRoleDead,this),m.Instance.remove(v.role_enter,this.onRoleEnter,this)},o.onRoleEnter=function(t,e){this.roles.push({type:t,node:e}),this.roles.sort((function(t,e){return e.node.x-t.node.x}))},o.onRoleDead=function(t){var e=this.roles.findIndex((function(e){return e.type===t}));-1!==e&&this.roles.splice(e,1)},o.onMeleeEvent=function(t){this.hp-=t,this.showDamage(t,!1),m.Instance.emit(v.boss_hit,this.hp),this.hp<=0&&this.bossDead()},o.onBeginContact=function(t,e){var n=e.node.getComponent(f).getDamage(),i=n[0],s=n[1];this.hp-=i,this.showDamage(i,s),m.Instance.emit(v.boss_hit,this.hp),this.hp<=0&&this.bossDead()},o.onSpineEvent=function(t,e){var n=t.animation.name;switch(this.bossType){case g.mummies:"attack"===n&&this.createMummiesSkill1()}},o.createMummiesSkill1=function(){var t=n(i().mark((function t(){var e,n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.loadPrefab("prefab/skill/skill");case 2:(e=t.sent).position=new u(this.node.x,this.node.y+15),n=this.getSkillConfig(1),e.getComponent(k).init(n.dps,n.hit),e.parent=this.node.parent;case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.showDamage=function(){var t=n(i().mark((function t(e,n){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:m.Instance.emit(v.show_damage,e,n,this.node);case 1:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),o.updateSkillCD=function(t,e){var n=this;this.skillCD[t].cd=e,this.scheduleOnce((function(){return n.skillCD[t].cd=0}),e)},o.getSkillConfig=function(t){return this.config.skill.find((function(e){return e.id===t}))},o.update=function(t){var e=this;if(!this.isGameOver&&this.status===b.idle){var n=this.base;this.roles.length>0&&(n=this.roles[0].node);var i,s=n.getComponent(r).width,o=Math.abs(this.node.x-this.width/2-(n.x+s/2)),a=function(){var t=e.skillCD[h];if(t.cd<=0&&o<=t.range){e.status=b.attack;var i=e.getSkillConfig(parseInt(h));if(e.spine.setAnimation(0,i.anim,!1),e.bossType===g.mummies&&(e.spine.timeScale=3),e.spine.setCompleteListener((function(){e.bossType===g.mummies&&(e.spine.timeScale=1),e.spine.setAnimation(0,D.stand,!0),e.spine.setCompleteListener(null),e.status=b.idle})),e.updateSkillCD(parseInt(h),i.cd),!i.event){var s=p.random(0,1e3)<=i.hit?2*i.dps:i.dps;e.scheduleOnce((function(){n.emit(v.melee,s)}),.55)}return{v:void 0}}};for(var h in this.skillCD)if(i=a())return i.v;var c=n.x+s/2+this.width/2;this.node.x>c?(this.node.x-=30*t,this.spine.animation!==D.run&&this.spine.setAnimation(0,D.run,!0)):this.spine.animation!==D.stand&&this.spine.setAnimation(0,D.stand,!0)}},s}(d))||C);s._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigManager.ts","./Utils.ts"],(function(t){var e,i,n,o,s,r,a,c,l,u,p,h,d,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,r=t._decorator,a=t.sp,c=t.Vec3,l=t.tween,u=t.BoxCollider2D,p=t.Contact2DType,h=t.Component},function(t){d=t.default},function(t){f=t.default}],execute:function(){var g,m,v,y,B;s._RF.push({},"6a2d3oCgsJLw4OSSJyWvqVP","Bullet",void 0);var C=r.ccclass,D=r.property;t("Bullet",(g=C("Bullet"),m=D(a.Skeleton),g((B=e((y=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return e=t.call.apply(t,[this].concat(s))||this,n(e,"spine",B,o(e)),e.isBoom=void 0,e.dps=void 0,e.hit=void 0,e}i(e,t);var s=e.prototype;return s.init=function(t,e){this.dps=t,this.hit=e,this.node.scale=new c(0,0,1),this.isBoom=!1},s.start=function(){l(this.node).to(.1,{scale:new c(1,1,1)}).start(),this.getComponent(u).once(p.BEGIN_CONTACT,this.onBeginContact,this)},s.getDamage=function(){var t=f.random(0,1e3)<=this.hit;return[t?2*this.dps:this.dps,t]},s.onBeginContact=function(t,e){var i=this;this.isBoom=!0,this.spine.setAnimation(0,"boom",!1),this.spine.setCompleteListener((function(){i.node.destroy()}))},s.update=function(t){this.isBoom||(this.node.x+=d.ATTACK_MOVE_SPEED*t,Math.abs(this.node.x)>390&&this.node.destroy())},e}(h)).prototype,"spine",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=y))||v));s._RF.pop()}}}));

System.register("chunks:///_virtual/Chapter.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIManager.ts","./TimeoutView.ts","./ConfigManager.ts","./GameData.ts","./ProtoManager.ts","./BalanceView.ts"],(function(e){var t,n,r,a,i,c,o,l,s,u,p,f,h,d,v,b,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,i=e.asyncToGenerator,c=e.regeneratorRuntime},function(e){o=e.cclegacy,l=e._decorator,s=e.Node,u=e.Label,p=e.Component},function(e){f=e.default},function(e){h=e.TimeoutView},function(e){d=e.default},function(e){v=e.GameData},function(e){b=e.ProtoManager},function(e){m=e.BalanceView}],execute:function(){var g,y,w,I,L,k,S,C,E,z,D;o._RF.push({},"27c53K315JJnYrpfFHow+31","Chapter",void 0);var T=l.ccclass,x=l.property;e("Chapter",(g=T("Chapter"),y=x(s),w=x(s),I=x([s]),L=x(u),g((C=t((S=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return t=e.call.apply(e,[this].concat(i))||this,r(t,"blockEvent",C,a(t)),r(t,"gameScene",E,a(t)),r(t,"levelSelecteds",z,a(t)),r(t,"timerLabel",D,a(t)),t.selectedId=1,t}n(t,e);var o=t.prototype;return o.onLoad=function(){},o.start=function(){var e=this;this.levelSelecteds.forEach((function(t,n){t.active=n===e.selectedId-1})),this.startTimerLabel()},o.onSelectLevel=function(e,t){var n=this;this.selectedId=parseInt(t),this.levelSelecteds.forEach((function(e,t){e.active=t===n.selectedId-1}))},o.onStartGame=function(){var e=i(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.blockEvent.active=!0,t=d.getChapterConfigByID(this.selectedId),!(v.balance<t.fee)){e.next=6;break}return f.open(m),this.blockEvent.active=!1,e.abrupt("return");case 6:return e.next=8,b.startGame(this.selectedId).then((function(e){v.updateBalance(e.balance),n.blockEvent.active=!1,v.chapterId=n.selectedId,n.gameScene.active=!0,n.node.active=!1})).catch(i(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.blockEvent.active=!1,f.open(m);case 2:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.startTimerLabel=function(){var e=this;this.timerLabel.string="30",this.schedule((function(){var t=parseInt(e.timerLabel.string);t>0?(t-=1,e.timerLabel.string=t.toString()):(e.unscheduleAllCallbacks(),f.open(h))}),1)},t}(p)).prototype,"blockEvent",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=t(S.prototype,"gameScene",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=t(S.prototype,"levelSelecteds",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),D=t(S.prototype,"timerLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=S))||k));o._RF.pop()}}}));

System.register("chunks:///_virtual/ConfigManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,t,r,o,i,c,u;return{setters:[function(n){e=n.createClass,t=n.asyncToGenerator,r=n.regeneratorRuntime},function(n){o=n.cclegacy,i=n.resources,c=n.JsonAsset,u=n.log}],execute:function(){o._RF.push({},"3a395fxwLNA27BnAEQzZsbJ","ConfigManager",void 0);var a=n("default",function(){function n(){}return n.load=function(){var n=t(r().mark((function n(){var e;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u("begin clientConfig"),n.next=3,this.loadGameConfig();case 3:return e=n.sent,u("end clientConfig"),u("配置表",this.config),n.abrupt("return",e);case 7:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),n.loadGameConfig=function(){var n=t(r().mark((function n(){var e,t,o,i,c;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e=["config"],t={code:0},o=0;case 3:if(!(o<e.length)){n.next=17;break}return i=e[o],n.next=7,this.loadConifgJson(i);case 7:if((c=n.sent).code){n.next=12;break}this._config=c.data.json,n.next=14;break;case 12:return c={code:-3,msg:"配置表加载失败"},n.abrupt("break",17);case 14:o++,n.next=3;break;case 17:return n.abrupt("return",t);case 18:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),n.loadConifgJson=function(n){return new Promise((function(e,t){i.load("config/"+n,c,(function(n,t){e(n?{code:1}:{code:0,data:t})}))}))},n.getChapterConfigByID=function(n){return this.config.ChapterConfig.find((function(e){return e.id===n}))},n.getBossConfig=function(n){return this.config.BossConfig.find((function(e){return e.id===n}))},n.getRoleConfig=function(n){return this.config.RoleConfig.find((function(e){return e.type===n}))},e(n,null,[{key:"config",get:function(){return this._config}}]),n}());a.MAX_RANGE=200,a.BOSS_MOVE_X=170,a.ATTACK_MOVE_SPEED=300,a._config=void 0,a.CONFIG_FILES_KEY="marbles_config_files",o._RF.pop()}}}));

System.register("chunks:///_virtual/CutsceneAnim.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,r,s,a,l,c,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.tween,c=t.director,u=t.Component}],execute:function(){var p,h,d,m,y,b,f;r._RF.push({},"f6dcbSEhyNGSK9QJYgYjRur","CutsceneAnim",void 0);var Y=s.ccclass,g=s.property;t("CutsceneAnim",(p=Y("CutsceneAnim"),h=g(a),d=g(a),p((b=e((y=function(t){function e(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"top",b,n(e)),i(e,"bottom",f,n(e)),e.topShowY=189,e.topHideY=609,e.bottomShowY=-209.5,e.bottomHideY=-590.5,e}return o(e,t),e.prototype.playCutsceneAnim=function(t){var e=this;this.node.active=!0,this.top.y=this.topHideY,this.bottom.y=this.bottomHideY,l(this.node).parallel(l(this.top).to(.9,{y:this.topShowY},{easing:"sineOut"}),l(this.bottom).to(.9,{y:this.bottomShowY},{easing:"sineOut"})).call((function(){c.loadScene(t)})).delay(.3).parallel(l(this.top).to(.9,{y:this.topHideY},{easing:"sineOut"}),l(this.bottom).to(.9,{y:this.bottomHideY},{easing:"sineOut"})).call((function(){return e.node.active=!1}),this).start()},e}(u)).prototype,"top",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=e(y.prototype,"bottom",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=y))||m));r._RF.pop()}}}));

System.register("chunks:///_virtual/EventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,o,i;return{setters:[function(e){t=e.inheritsLoose,n=e.createClass},function(e){o=e.cclegacy,i=e.Node}],execute:function(){o._RF.push({},"30d12Wk6JVFXrH3XLn9IZe5","EventManager",void 0),e("default",function(e){function o(){return e.apply(this,arguments)||this}t(o,e);var i=o.prototype;return i.add=function(e,t,n){this.on(e,t,n)},i.addOnce=function(e,t,n){this.once(e,t,n)},i.remove=function(e,t,n){this.off(e,t,n)},i.event=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this.emit.apply(this,[e].concat(n))},n(o,null,[{key:"Instance",get:function(){return this._instance||(this._instance=new o)}}]),o}(i))._instance=void 0;e("EventType",function(e){return e.account="account",e.init_role="init.role",e.show_damage="show.damage",e.base_hit="base.hit",e.base_dead="base.dead",e.role_enter="role.enter",e.role_dead="role.dead",e.boss_dead="boss.dead",e.role_hit="role.hit",e.boss_hit="boss.hit",e.melee="melee",e}({}));o._RF.pop()}}}));

System.register("chunks:///_virtual/Game.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameDefined.ts","./Utils.ts","./Role.ts","./ConfigManager.ts","./Boss.ts","./RoleListItem.ts","./EventManager.ts","./ProtoManager.ts","./GameData.ts","./UIManager.ts","./Base.ts"],(function(e){var t,n,r,a,i,o,s,c,u,l,h,p,f,b,d,v,g,m,w,y,k,x,B,C,E,G,R,I,P,D,z;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,i=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e._decorator,u=e.Node,l=e.Prefab,h=e.ProgressBar,p=e.Label,f=e.director,b=e.Component,d=e.instantiate,v=e.UITransform,g=e.Vec3,m=e.tween,w=e.UIOpacity},function(e){y=e.RoleType},function(e){k=e.default},function(e){x=e.Role},function(e){B=e.default},function(e){C=e.Boss},function(e){E=e.RoleListItem},function(e){G=e.default,R=e.EventType},function(e){I=e.ProtoManager},function(e){P=e.GameData},function(e){D=e.default},function(e){z=e.Base}],execute:function(){var T,A,L,M,_,O,H,V,S,N,U,F,j,W,Y,J,K,q,Q,X,Z,$,ee,te,ne,re,ae;s._RF.push({},"578b5YaA+dKUILWcJejMT+l","Game",void 0);var ie=c.ccclass,oe=c.property;e("Game",(T=ie("Game"),A=oe(u),L=oe(u),M=oe(u),_=oe(u),O=oe(l),H=oe(l),V=oe(h),S=oe(h),N=oe(u),U=oe(u),F=oe(p),j=oe(z),T((J=t((Y=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,r(t,"blockEvent",J,a(t)),r(t,"guideBlockEvent",K,a(t)),r(t,"winAlert",q,a(t)),r(t,"winLabel",Q,a(t)),r(t,"hit",X,a(t)),r(t,"hitDouble",Z,a(t)),r(t,"bossProg",$,a(t)),r(t,"playerProg",ee,a(t)),r(t,"overMask",te,a(t)),r(t,"overView",ne,a(t)),r(t,"winAmount",re,a(t)),r(t,"base",ae,a(t)),t.chapterConfig=void 0,t.boss=void 0,t.roles=[],t}n(t,e);var s=t.prototype;return s.onLoad=function(){var e=i(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.chapterConfig=B.getChapterConfigByID(P.chapterId),this.base.init(this.chapterConfig.baseHP);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.start=function(){var e=i(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P.isGuide&&(this.guideBlockEvent.active=!0),this.startGame(),G.Instance.on(R.show_damage,this.onShowDamage,this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.startGame=function(){var e=i(o().mark((function e(){var t,n,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadBoss();case 2:if(!P.isGuide){e.next=17;break}this.loadRole(y.make),G.Instance.emit(R.init_role,y.make),t=o().mark((function e(){var t,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=y[n])!=y.make){e.next=3;break}return e.abrupt("return",0);case 3:if(!(Math.random()>.5)){e.next=5;break}return e.abrupt("return",0);case 5:a=k.random(1,3),r.scheduleOnce((function(){r.loadRole(t),G.Instance.emit(R.init_role,t)}),a);case 7:case"end":return e.stop()}}),e)})),e.t0=o().keys(y);case 7:if((e.t1=e.t0()).done){e.next=15;break}return n=e.t1.value,e.delegateYield(t(),"t2",10);case 10:if(0!==e.t2){e.next=13;break}return e.abrupt("continue",7);case 13:e.next=7;break;case 15:e.next=19;break;case 17:this.loadRole(this.chapterConfig.role),G.Instance.emit(R.init_role,this.chapterConfig.role);case 19:G.Instance.add(R.boss_hit,this.onBossHitEvent,this),G.Instance.add(R.boss_dead,this.onBossDeadEvent,this),G.Instance.add(R.base_hit,this.onBaseHitEvent,this),G.Instance.add(R.base_dead,this.onBaseDeadEvent,this);case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.loadRole=function(){var e=i(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.loadPrefab("prefab/role/"+t);case 2:(n=e.sent).x=this.base.node.x,(r=n.getComponent(x)).init(t,this.boss.node),this.roles.push(r),n.parent=this.node;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.loadBoss=function(){var e=i(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=k.randOneList(this.chapterConfig.boss),n=B.getBossConfig(t),e.next=4,k.loadPrefab("prefab/boss/"+n.name);case 4:r=e.sent,this.boss=r.getComponent(C),this.boss.init(n,this.base.node),this.node.addChild(r);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.onAddRoleEvent=function(){var e=i(o().mark((function e(t){var n,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.getComponent(E),!this.hasRole(n.roleType)){e.next=4;break}return D.showTip("The character is in battle"),e.abrupt("return");case 4:if(!(P.balance<n.getFee())){e.next=7;break}return D.showTip("Insufficient coins to select this character"),e.abrupt("return");case 7:if(this.blockEvent.active=!0,!P.isGuide){e.next=10;break}return e.abrupt("return");case 10:I.startBattle(n.id).then((function(e){P.updateBalance(e.balance),r.loadRole(n.roleType),n.toggleFight(),r.blockEvent.active=!1})).catch((function(e){r.blockEvent.active=!1,console.error("Error starting battle:",e)}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.onBackHall=function(){f.loadScene("hall")},s.onBaseHitEvent=function(e,t){this.onShowDamage(e,t,this.base.node);var n=this.base.hp/this.chapterConfig.baseHP;this.playerProg.progress=n},s.onBossHitEvent=function(e){var t=this.boss.hp/this.boss.maxHp;this.bossProg.progress=t},s.onBossDeadEvent=function(){var e=this;this.bossProg.progress=0,this.scheduleOnce((function(){e.gameOver(!0)}),2)},s.onBaseDeadEvent=function(){this.playerProg.progress=0,this.gameOver(!1)},s.gameOver=function(e){var t=this;if(this.blockEvent.active=!1,P.isGuide)return this.winAlert.active=!1,this.overMask.active=!0,this.overView.active=!0,this.winLabel.y=0,this.overView.getChildByName("win").active=e,this.overView.getChildByName("lose").active=!e,void this.scheduleOnce((function(){D.playCutsceneAnim("hall")}),3);I.updateGameResult(e).then((function(n){if(e){var r=n.winAmount;t.winAmount.string=""+r}t.overMask.active=!0,t.overView.active=!0,t.winAlert.active=!0,t.winLabel.y=83,t.overView.getChildByName("win").active=e,t.overView.getChildByName("lose").active=!e,e||t.scheduleOnce((function(){D.playCutsceneAnim("hall")}),3)})).catch((function(e){console.error("Error updating game result:",e)}))},s.hasRole=function(e){return this.roles.some((function(t){return t.roleType===e}))},s.onShowDamage=function(){var e=i(o().mark((function e(t,n,r){var a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=d(n?this.hitDouble:this.hit),i=r.getComponent(v).height,a.x=r.x,a.y=r.y+i,this.node.addChild(a),a.scale=new g(0,0),a.getChildByName("num").getComponent(p).string=""+t,m(a).parallel(m(a).to(.3,{scale:new g(1,1)},{easing:"backOut"}),m(a).by(.3,{position:new g(0,30)})).parallel(m(a.getComponent(w)).to(.6,{opacity:0}),m(a).by(.6,{position:new g(0,30)})).destroySelf().start();case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),s.onTestGameLose=function(){var e=i(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.updateGameResult(!1);case 2:t=e.sent,console.log("Game result updated:",t),f.loadScene("hall");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s.onTestGameWin=function(){var e=i(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.updateGameResult(!0);case 2:t=e.sent,console.log("Game result updated:",t),f.loadScene("hall");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t}(b)).prototype,"blockEvent",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=t(Y.prototype,"guideBlockEvent",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=t(Y.prototype,"winAlert",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=t(Y.prototype,"winLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=t(Y.prototype,"hit",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=t(Y.prototype,"hitDouble",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=t(Y.prototype,"bossProg",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=t(Y.prototype,"playerProg",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=t(Y.prototype,"overMask",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=t(Y.prototype,"overView",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=t(Y.prototype,"winAmount",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=t(Y.prototype,"base",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=Y))||W));s._RF.pop()}}}));

System.register("chunks:///_virtual/GameData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ProtoManager.ts","./EventManager.ts"],(function(e){var n,t,r,a,c,u,s,o,i;return{setters:[function(e){n=e.createClass,t=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){a=e.cclegacy,c=e.game,u=e.Game},function(e){s=e.ProtoManager},function(e){o=e.default,i=e.EventType}],execute:function(){var f;a._RF.push({},"adbb3mlg9hD1a1292gehp9P","GameData",void 0);var p=function(){function e(){this.mute=!1,this.balance=0,this.isGuide=!1,this.chapterId=0}var a=e.prototype;return a.load=function(){var e=t(r().mark((function e(){var n=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.hasEventListener(u.EVENT_SHOW)||c.on(u.EVENT_HIDE,(function(){n.updateUserInfo().catch((function(e){console.error("更新用户信息失败:",e)}))}),this),e.abrupt("return",this.updateUserInfo());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.updateUserInfo=function(){var e=t(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(t(r().mark((function e(n,t){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.getUserInfo();case 3:if(a=e.sent,l.balance=a.info.Balance,!a.info.inGame){e.next=8;break}return e.next=8,s.updateGameResult(!1);case 8:n(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),t(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a.updateBalance=function(e){this.balance=e,o.Instance.emit(i.account)},n(e,null,[{key:"Instance",get:function(){return this._instance}}]),e}();f=p,p._instance=new f;var l=e("GameData",p.Instance);a._RF.pop()}}}));

System.register("chunks:///_virtual/GameDefined.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){e("defined",void 0),n._RF.push({},"0d7eechcSJINp01eBSw1Ugx","GameDefined",void 0);e("GameState",function(e){return e[e.ready=0]="ready",e[e.run=1]="run",e[e.end=2]="end",e}({})),e("LevelType",function(e){return e.easy="easy",e.normal="normal",e.hard="hard",e}({})),e("RoleType",function(e){return e.make="make",e.allen="allen",e.tarma="tarma",e.fio="fio",e}({})),e("BossType",function(e){return e[e.Soldiers=1]="Soldiers",e[e.mummies=2]="mummies",e[e.Conga=3]="Conga",e[e.DropTank=4]="DropTank",e[e.MV280B=5]="MV280B",e[e.M3RocketVan=6]="M3RocketVan",e[e.N_Soldiers=7]="N_Soldiers",e}({}));n._RF.pop()}}}));

System.register("chunks:///_virtual/GameView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts"],(function(e){var t,i,a,n,r,c,o,l,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,a=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){r=e.cclegacy,c=e._decorator,o=e.Node,l=e.Component},function(e){u=e.GameData}],execute:function(){var s,p,m,f,h,y,b;r._RF.push({},"7a95bu5lzlPw5PSeN7bWOD9","GameView",void 0);var d=c.ccclass,g=c.property;e("GameView",(s=d("GameView"),p=g(o),m=g(o),s((y=t((h=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),c=0;c<i;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r))||this,a(t,"chapterScene",y,n(t)),a(t,"gameScene",b,n(t)),t}i(t,e);var r=t.prototype;return r.onLoad=function(){this.chapterScene.active=!u.isGuide,this.gameScene.active=u.isGuide},r.startGame=function(){},t}(l)).prototype,"chapterScene",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=t(h.prototype,"gameScene",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=h))||f));r._RF.pop()}}}));

System.register("chunks:///_virtual/Hall.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts","./UIManager.ts","./Utils.ts"],(function(t){var n,e,o,a,i,u,c;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,a=t.Component},function(t){i=t.GameData},function(t){u=t.default},function(t){c=t.default}],execute:function(){var r;e._RF.push({},"c7ff1Drd3RFOIPdoSIuXiF8","Hall",void 0);var s=o.ccclass;o.property,t("Hall",s("Hall")(r=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var o=e.prototype;return o.onContinue=function(){i.isGuide=!1,u.playCutsceneAnim("game")},o.onDemo=function(){i.isGuide=!0,i.chapterId=c.random(1,3),u.playCutsceneAnim("game")},e}(a))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/kunpo-inspector.min.mjs",["./rollupPluginModLoBabelHelpers.js","cc"],(function(){var e,n,t,i;return{setters:[function(i){e=i.inheritsLoose,n=i.assertThisInitialized,t=i.createForOfIteratorHelperLoose},function(e){i=e.cclegacy}],execute:function(){i._RF.push({},"16ee7Zig1lA47ZkvRxt6c+o","kunpo-inspector.min",void 0);var r=function(){function e(e){this.tooltip=null,this.tooltipTimer=null,this.parent=e,this.applyStyles()}var n=e.prototype;return n.applyStyles=function(){var e=document.createElement("style");e.textContent="\n            .global-inspector-tooltip {\n                position: fixed; /* 使用 fixed 定位，相对于视口 */\n                background-color: rgba(0, 0, 0, 0.8);\n                color: white;\n                padding: 8px 12px;\n                border-radius: 5px;\n                font-size: 12px;\n                z-index: 9999; /* 确保在最顶层 */\n                pointer-events: none;\n                opacity: 0;\n                transition: opacity 0.3s ease;\n                white-space: nowrap; /* 防止文本换行 */\n            }\n\n            .global-inspector-tooltip.show {\n                opacity: 1;\n            }\n        ",document.head.appendChild(e)},n.show=function(e,n){var t=this;this.tooltipTimer&&clearTimeout(this.tooltipTimer),this.tooltip||(this.tooltip=document.createElement("div"),this.tooltip.className="global-inspector-tooltip",this.parent.appendChild(this.tooltip)),this.tooltip.textContent=e;var i=n.getBoundingClientRect(),r=this.tooltip.getBoundingClientRect(),o=i.top-40,a=i.left+i.width/2-r.width/2;this.tooltip.style.top=o+"px",this.tooltip.style.left=a+"px",this.tooltip.offsetWidth,this.tooltip.classList.add("show"),this.tooltipTimer=window.setTimeout((function(){t.tooltip&&t.tooltip.classList.remove("show")}),2e3)},e}(),o=function(){function e(){this.container=null,this.content=null,this.toggleButton=null,this.resizeHandle=null,this.isOpen=!1,this.toggleCallback=null,this.isResizing=!1,this.startX=0,this.startWidth=0,this.minWidth=150,this.maxWidth=800,this.defaultWidth=300,this.tooltipManager=null}var n=e.prototype;return n.create=function(){this.createContainer(),this.createToggleButton(),this.createContent(),this.createResizeHandle(),this.applyStyles(),this.bindEvents(),this.bindResizeEvents(),this.setInitialState(),this.tooltipManager=new r(this.container)},n.createContainer=function(){this.container=document.createElement("div"),this.container.id="node-inspector-drawer",this.container.style.width=this.defaultWidth+"px",document.body.appendChild(this.container)},n.createToggleButton=function(){this.toggleButton=document.createElement("div"),this.toggleButton.id="node-inspector-toggle",this.toggleButton.innerHTML="节<br>点<br>树",this.toggleButton.title="切换节点调试器",this.container.appendChild(this.toggleButton)},n.createContent=function(){this.content=document.createElement("div"),this.content.id="node-inspector-content",this.container.appendChild(this.content)},n.createResizeHandle=function(){this.resizeHandle=document.createElement("div"),this.resizeHandle.id="node-inspector-resize-handle",this.container.appendChild(this.resizeHandle)},n.applyStyles=function(){var e=document.createElement("style");e.textContent="\n            #node-inspector-drawer {\n                position: fixed;\n                top: 0;\n                left: 0;\n                height: 100vh;\n                background: #2d2d2d;\n                border-right: 1px solid #444;\n                z-index: 10000;\n                transition: transform 0.3s ease;\n                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n                font-size: 12px;\n                color: #fff;\n                box-shadow: 2px 0 10px rgba(0,0,0,0.3);\n                min-width: "+this.minWidth+"px;\n                max-width: "+this.maxWidth+"px;\n            }\n\n            #node-inspector-drawer.closed {\n                transform: translateX(-100%);\n            }\n\n            #node-inspector-toggle {\n                position: absolute;\n                top: calc(50vh - 100px);\n                right: -30px;\n                transform: translateY(-50%);\n                width: 30px;\n                height: 160px;\n                background: #2d2d2d;\n                border: 1px solid #444;\n                border-left: none;\n                border-radius: 0 5px 5px 0;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                cursor: pointer;\n                font-size: 14px;\n                color: #fff;\n                user-select: none;\n                transition: background 0.2s ease;\n            }\n\n            #node-inspector-toggle:hover {\n                background: #3d3d3d;\n            }\n\n            #node-inspector-resize-handle {\n                position: absolute;\n                top: 0;\n                right: 0;\n                width: 4px;\n                height: 100%;\n                background: transparent;\n                cursor: col-resize;\n                z-index: 1001;\n                transition: background 0.2s ease;\n            }\n\n            #node-inspector-resize-handle:hover {\n                background: #0078d4;\n            }\n\n            #node-inspector-content {\n                width: 100%;\n                height: 100%;\n                overflow: hidden;\n                display: flex;\n                flex-direction: column;\n                padding-right: 4px;\n            }\n\n            .node-inspector-panel {\n                background: #2d2d2d;\n                border-bottom: 1px solid #444;\n                overflow: auto;\n            }\n\n            .node-inspector-panel h3 {\n                margin: 0;\n                padding: 10px;\n                font-size: 14px;\n                font-weight: bold;\n            }\n\n            .node-tree {\n                flex: 1;\n                min-height: 200px;\n                display: flex;\n                flex-direction: column;\n                overflow: auto;\n            }\n\n            .property-panel {\n                flex: 0 0 auto;\n                min-height: auto;\n            }\n\n            /* 滚动条样式 */\n            .node-inspector-panel::-webkit-scrollbar {\n                width: 8px;\n            }\n\n            .node-inspector-panel::-webkit-scrollbar-track {\n                background: #1e1e1e;\n            }\n\n            .node-inspector-panel::-webkit-scrollbar-thumb {\n                background: #555;\n                border-radius: 4px;\n            }\n\n            .node-inspector-panel::-webkit-scrollbar-thumb:hover {\n                background: #666;\n            }\n\n            /* 拖拽时的样式 */\n            body.resizing-drawer {\n                user-select: none;\n                cursor: col-resize !important;\n            }\n\n            body.resizing-drawer * {\n                pointer-events: none !important;\n            }\n\n            body.resizing-drawer #node-inspector-drawer {\n                pointer-events: auto !important;\n            }\n\n            body.resizing-drawer #node-inspector-resize-handle {\n                pointer-events: auto !important;\n            }\n\n            /* 防止iframe或canvas干扰 */\n            body.resizing-drawer iframe,\n            body.resizing-drawer canvas,\n            body.resizing-drawer embed,\n            body.resizing-drawer object {\n                pointer-events: none !important;\n            }\n        ",document.head.appendChild(e)},n.bindEvents=function(){var e=this;this.toggleButton&&this.toggleButton.addEventListener("click",(function(){e.toggle()}))},n.toggle=function(){this.container&&(this.isOpen=!this.isOpen,this.isOpen?this.container.classList.remove("closed"):this.container.classList.add("closed"),this.toggleCallback&&this.toggleCallback(this.isOpen))},n.onToggle=function(e){this.toggleCallback=e},n.getContentContainer=function(){return this.content},n.destroy=function(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.content=null,this.toggleButton=null,this.resizeHandle=null},n.setInitialState=function(){this.container&&this.container.classList.add("closed")},n.bindResizeEvents=function(){var e=this;this.resizeHandle&&(this.resizeHandle.addEventListener("mousedown",(function(n){e.startResize(n)})),document.addEventListener("mousemove",(function(n){e.handleResize(n)}),{capture:!0}),document.addEventListener("mouseup",(function(n){e.stopResize()}),{capture:!0}),document.addEventListener("mouseleave",(function(){e.stopResize()})),window.addEventListener("blur",(function(){e.stopResize()})))},n.startResize=function(e){this.isResizing=!0,this.startX=e.clientX,this.startWidth=this.container.clientWidth,document.body.classList.add("resizing-drawer"),this.resizeHandle.style.background="#0078d4",e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},n.handleResize=function(e){if(this.isResizing){var n=e.clientX-this.startX,t=Math.max(this.minWidth,Math.min(this.maxWidth,this.startWidth+n));this.container.style.width=t+"px",e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}},n.stopResize=function(){this.isResizing&&(this.isResizing=!1,document.body.classList.remove("resizing-drawer"),this.resizeHandle.style.background="")},n.showTooltip=function(e,n){this.tooltipManager&&this.tooltipManager.show(e,n)},n.resetWidth=function(){this.container&&(this.container.style.width=this.defaultWidth+"px")},e}();function a(){var e=window.cc,n=(null==e?void 0:e.ENGINE_VERSION)||"";return n.startsWith("3.")||n.startsWith("4.")}var s=function(){function e(){}return e.log=function(){},e}(),l=function(){function e(){}return e.calculate=function(e){var n;try{var t=(null===(n=e.__classname__)||void 0===n?void 0:n.replace("cc.",""))||e.constructor.name;this._loged_type.has(t)||this._ignore_type.has(t)||(this._loged_type.set(t,!0),s.log("************************************************"),s.log("资源类型",t),s.log("原始数据:",e));var i=0;switch(t){case"Texture2D":case"cc_Texture2D":i=this.calculateTextureSize(e);break;case"ImageAsset":case"cc_ImageAsset":i=this.calculateImageAssetSize(e);break;case"AudioClip":case"cc_AudioClip":i=this.calculateAudioSize(e);break;case"Prefab":case"cc_Prefab":i=this.calculatePrefabSize(e);break;case"Material":case"cc_Material":i=this.calculateMaterialSize(e);break;case"Mesh":case"cc_Mesh":i=this.calculateMeshSize(e);break;case"AnimationClip":case"cc_AnimationClip":i=this.calculateAnimationSize(e);break;case"EffectAsset":case"cc_EffectAsset":i=this.calculateEffectSize(e);break;case"TTFFont":case"cc_TTFFont":i=this.calculateFontSize(e);break;case"JsonAsset":case"cc_JsonAsset":i=this.calculateJSONSize(e.json);break;case"BufferAsset":case"cc_BufferAsset":i=this.calculateBufferSize(e);break;case"sp_SkeletonData":case"sp.SkeletonData":case"SkeletonData":i=this.calculateSkeletonDataSize(e);break;case"TextAsset":case"cc_TextAsset":i=this.calculateTextAssetSize(e);break;case"Asset":case"cc_Asset":i=this.calculateAssetSize(e);break;default:i=-1}return this._loged_type.has(t)||this._ignore_type.has(t)||(this._loged_type.set(t,!0),s.log("大小:",i)),i}catch(e){return console.warn("计算资源大小时出错:",e),102400}},e.calculateTextureSize=function(e){try{var n=e.width||e._width||0,t=e.height||e._height||0;if(n>0&&t>0){var i=Math.max(1,Math.min(n,8192)),r=Math.max(1,Math.min(t,8192)),o=4;if(void 0!==e._format){var a=this.getFormatInfoFrom2x(e._format);o=a.bytesPerPixel,a.name}else if(e.getPixelFormat){var s=e.getPixelFormat();o=this.getBytesPerPixel(s),s}else e.pixelFormat?(o=this.getBytesPerPixel(e.pixelFormat),e.pixelFormat):e._pixelFormat&&(o=this.getBytesPerPixel(e._pixelFormat),e._pixelFormat);var l=i*r*o;return(e._compressed||e._texture&&e._texture._compressed)&&(l=Math.floor(l/4)),!!(e._genMipmaps||e.genMipmaps||e._texture&&e._texture._genMipmaps)&&(l=Math.floor(1.33*l)),l>1073741824?(console.warn("纹理尺寸异常: "+n+"x"+t+", 计算内存="+this.formatBytes(l)+", 使用默认值"),16384):l}if(e._nativeTexture){var c=e._nativeTexture;if(c.width&&c.height)return Math.max(1,Math.min(c.width,8192))*Math.max(1,Math.min(c.height,8192))*4}if(e._texture){var d=e._texture;if(d._width&&d._height){var u=Math.max(1,Math.min(d._width,8192))*Math.max(1,Math.min(d._height,8192))*4;return d._compressed&&(u=Math.floor(u/4)),u}}if(e._image&&e._image.width&&e._image.height)return Math.max(1,Math.min(e._image.width,8192))*Math.max(1,Math.min(e._image.height,8192))*4;if(e._nativeUrl){var h=e._nativeUrl.toLowerCase();if(h.includes(".png")||h.includes(".jpg")||h.includes(".jpeg")){var p=h.match(/(\d+)x(\d+)/);return p?Math.max(1,Math.min(parseInt(p[1]),8192))*Math.max(1,Math.min(parseInt(p[2]),8192))*4:16384}}return 16384}catch(e){return console.warn("计算纹理大小时出错:",e),16384}},e.getFormatInfoFrom2x=function(e){return{0:{bytesPerPixel:.5,name:"RGB_DXT1"},1:{bytesPerPixel:.5,name:"RGBA_DXT1"},2:{bytesPerPixel:1,name:"RGBA_DXT3"},3:{bytesPerPixel:1,name:"RGBA_DXT5"},4:{bytesPerPixel:.5,name:"RGB_ETC1"},5:{bytesPerPixel:.25,name:"RGB_PVRTC_2BPPV1"},6:{bytesPerPixel:.25,name:"RGBA_PVRTC_2BPPV1"},7:{bytesPerPixel:.5,name:"RGB_PVRTC_4BPPV1"},8:{bytesPerPixel:.5,name:"RGBA_PVRTC_4BPPV1"},9:{bytesPerPixel:1,name:"A8"},10:{bytesPerPixel:1,name:"L8"},11:{bytesPerPixel:2,name:"L8_A8"},12:{bytesPerPixel:2,name:"R5_G6_B5"},13:{bytesPerPixel:2,name:"R5_G5_B5_A1"},14:{bytesPerPixel:2,name:"R4_G4_B4_A4"},15:{bytesPerPixel:3,name:"RGB8"},16:{bytesPerPixel:4,name:"RGBA8"},17:{bytesPerPixel:6,name:"RGB16F"},18:{bytesPerPixel:8,name:"RGBA16F"},19:{bytesPerPixel:12,name:"RGB32F"},20:{bytesPerPixel:16,name:"RGBA32F"},21:{bytesPerPixel:4,name:"R32F"},22:{bytesPerPixel:4,name:"111110F"},23:{bytesPerPixel:3,name:"SRGB"},24:{bytesPerPixel:4,name:"SRGBA"},25:{bytesPerPixel:2,name:"D16"},26:{bytesPerPixel:4,name:"D32"},27:{bytesPerPixel:4,name:"D24S8"},28:{bytesPerPixel:.5,name:"RGB_ETC2"},29:{bytesPerPixel:1,name:"RGBA_ETC2"},30:{bytesPerPixel:1,name:"RGBA_ASTC_4X4"},31:{bytesPerPixel:.8,name:"RGBA_ASTC_5X4"},32:{bytesPerPixel:.64,name:"RGBA_ASTC_5X5"},33:{bytesPerPixel:.53,name:"RGBA_ASTC_6X5"},34:{bytesPerPixel:.44,name:"RGBA_ASTC_6X6"},35:{bytesPerPixel:.32,name:"RGBA_ASTC_8X5"},36:{bytesPerPixel:.27,name:"RGBA_ASTC_8X6"},37:{bytesPerPixel:.25,name:"RGBA_ASTC_8X8"},38:{bytesPerPixel:.2,name:"RGBA_ASTC_10X5"},39:{bytesPerPixel:.17,name:"RGBA_ASTC_10X6"},40:{bytesPerPixel:.125,name:"RGBA_ASTC_10X8"},41:{bytesPerPixel:.1,name:"RGBA_ASTC_10X10"},42:{bytesPerPixel:.083,name:"RGBA_ASTC_12X10"},43:{bytesPerPixel:.069,name:"RGBA_ASTC_12X12"},44:{bytesPerPixel:1,name:"SRGBA_ASTC_4X4"},45:{bytesPerPixel:.8,name:"SRGBA_ASTC_5X4"},46:{bytesPerPixel:.64,name:"SRGBA_ASTC_5X5"},47:{bytesPerPixel:.53,name:"SRGBA_ASTC_6X5"},48:{bytesPerPixel:.44,name:"SRGBA_ASTC_6X6"},49:{bytesPerPixel:.32,name:"SRGBA_ASTC_8X5"},50:{bytesPerPixel:.27,name:"SRGBA_ASTC_8X6"},51:{bytesPerPixel:.25,name:"SRGBA_ASTC_8X8"},52:{bytesPerPixel:.2,name:"SRGBA_ASTC_10X5"},53:{bytesPerPixel:.17,name:"SRGBA_ASTC_10X6"},54:{bytesPerPixel:.125,name:"SRGBA_ASTC_10X8"},55:{bytesPerPixel:.1,name:"SRGBA_ASTC_10X10"},56:{bytesPerPixel:.083,name:"SRGBA_ASTC_12X10"},57:{bytesPerPixel:.069,name:"SRGBA_ASTC_12X12"}}[e]||{bytesPerPixel:4,name:"RGBA8"}},e.getFormatInfoFrom3x=function(e){return{0:{bytesPerPixel:4,name:"UNKNOWN"},1:{bytesPerPixel:1,name:"A8"},2:{bytesPerPixel:1,name:"L8"},3:{bytesPerPixel:2,name:"LA8"},4:{bytesPerPixel:1,name:"R8"},5:{bytesPerPixel:1,name:"R8SN"},6:{bytesPerPixel:1,name:"R8UI"},7:{bytesPerPixel:1,name:"R8I"},8:{bytesPerPixel:2,name:"R16F"},9:{bytesPerPixel:2,name:"R16UI"},10:{bytesPerPixel:2,name:"R16I"},11:{bytesPerPixel:4,name:"R32F"},12:{bytesPerPixel:4,name:"R32UI"},13:{bytesPerPixel:4,name:"R32I"},14:{bytesPerPixel:2,name:"RG8"},15:{bytesPerPixel:2,name:"RG8SN"},16:{bytesPerPixel:2,name:"RG8UI"},17:{bytesPerPixel:2,name:"RG8I"},18:{bytesPerPixel:4,name:"RG16F"},19:{bytesPerPixel:4,name:"RG16UI"},20:{bytesPerPixel:4,name:"RG16I"},21:{bytesPerPixel:8,name:"RG32F"},22:{bytesPerPixel:8,name:"RG32UI"},23:{bytesPerPixel:8,name:"RG32I"},24:{bytesPerPixel:3,name:"RGB8"},25:{bytesPerPixel:3,name:"SRGB8"},26:{bytesPerPixel:3,name:"RGB8SN"},27:{bytesPerPixel:3,name:"RGB8UI"},28:{bytesPerPixel:3,name:"RGB8I"},29:{bytesPerPixel:6,name:"RGB16F"},30:{bytesPerPixel:6,name:"RGB16UI"},31:{bytesPerPixel:6,name:"RGB16I"},32:{bytesPerPixel:12,name:"RGB32F"},33:{bytesPerPixel:12,name:"RGB32UI"},34:{bytesPerPixel:12,name:"RGB32I"},35:{bytesPerPixel:4,name:"RGBA8"},36:{bytesPerPixel:4,name:"BGRA8"},37:{bytesPerPixel:4,name:"SRGB8_A8"},38:{bytesPerPixel:4,name:"RGBA8SN"},39:{bytesPerPixel:4,name:"RGBA8UI"},40:{bytesPerPixel:4,name:"RGBA8I"},41:{bytesPerPixel:8,name:"RGBA16F"},42:{bytesPerPixel:8,name:"RGBA16UI"},43:{bytesPerPixel:8,name:"RGBA16I"},44:{bytesPerPixel:16,name:"RGBA32F"},45:{bytesPerPixel:16,name:"RGBA32UI"},46:{bytesPerPixel:16,name:"RGBA32I"},47:{bytesPerPixel:2,name:"R5G6B5"},48:{bytesPerPixel:4,name:"R11G11B10F"},49:{bytesPerPixel:2,name:"RGB5A1"},50:{bytesPerPixel:2,name:"RGBA4"},51:{bytesPerPixel:4,name:"RGB10A2"},52:{bytesPerPixel:4,name:"RGB10A2UI"},53:{bytesPerPixel:4,name:"RGB9E5"},54:{bytesPerPixel:4,name:"DEPTH"},55:{bytesPerPixel:4,name:"DEPTH_STENCIL"},56:{bytesPerPixel:.5,name:"BC1"},57:{bytesPerPixel:.5,name:"BC1_ALPHA"},58:{bytesPerPixel:.5,name:"BC1_SRGB"},59:{bytesPerPixel:.5,name:"BC1_SRGB_ALPHA"},60:{bytesPerPixel:1,name:"BC2"},61:{bytesPerPixel:1,name:"BC2_SRGB"},62:{bytesPerPixel:1,name:"BC3"},63:{bytesPerPixel:1,name:"BC3_SRGB"},64:{bytesPerPixel:.5,name:"BC4"},65:{bytesPerPixel:.5,name:"BC4_SNORM"},66:{bytesPerPixel:1,name:"BC5"},67:{bytesPerPixel:1,name:"BC5_SNORM"},68:{bytesPerPixel:1,name:"BC6H_UF16"},69:{bytesPerPixel:1,name:"BC6H_SF16"},70:{bytesPerPixel:1,name:"BC7"},71:{bytesPerPixel:1,name:"BC7_SRGB"},72:{bytesPerPixel:.5,name:"ETC_RGB8"},73:{bytesPerPixel:.5,name:"ETC2_RGB8"},74:{bytesPerPixel:.5,name:"ETC2_SRGB8"},75:{bytesPerPixel:.5,name:"ETC2_RGB8_A1"},76:{bytesPerPixel:.5,name:"ETC2_SRGB8_A1"},77:{bytesPerPixel:1,name:"ETC2_RGBA8"},78:{bytesPerPixel:1,name:"ETC2_SRGB8_A8"},79:{bytesPerPixel:.5,name:"EAC_R11"},80:{bytesPerPixel:.5,name:"EAC_R11SN"},81:{bytesPerPixel:1,name:"EAC_RG11"},82:{bytesPerPixel:1,name:"EAC_RG11SN"},83:{bytesPerPixel:.25,name:"PVRTC_RGB2"},84:{bytesPerPixel:.25,name:"PVRTC_RGBA2"},85:{bytesPerPixel:.5,name:"PVRTC_RGB4"},86:{bytesPerPixel:.5,name:"PVRTC_RGBA4"},87:{bytesPerPixel:.25,name:"PVRTC2_2BPP"},88:{bytesPerPixel:.5,name:"PVRTC2_4BPP"},89:{bytesPerPixel:1,name:"ASTC_RGBA_4X4"},90:{bytesPerPixel:.8,name:"ASTC_RGBA_5X4"},91:{bytesPerPixel:.64,name:"ASTC_RGBA_5X5"},92:{bytesPerPixel:.53,name:"ASTC_RGBA_6X5"},93:{bytesPerPixel:.44,name:"ASTC_RGBA_6X6"},94:{bytesPerPixel:.4,name:"ASTC_RGBA_8X5"},95:{bytesPerPixel:.33,name:"ASTC_RGBA_8X6"},96:{bytesPerPixel:.25,name:"ASTC_RGBA_8X8"},97:{bytesPerPixel:.32,name:"ASTC_RGBA_10X5"},98:{bytesPerPixel:.27,name:"ASTC_RGBA_10X6"},99:{bytesPerPixel:.2,name:"ASTC_RGBA_10X8"},100:{bytesPerPixel:.16,name:"ASTC_RGBA_10X10"},101:{bytesPerPixel:.13,name:"ASTC_RGBA_12X10"},102:{bytesPerPixel:.11,name:"ASTC_RGBA_12X12"},103:{bytesPerPixel:1,name:"ASTC_SRGBA_4X4"},104:{bytesPerPixel:.8,name:"ASTC_SRGBA_5X4"},105:{bytesPerPixel:.64,name:"ASTC_SRGBA_5X5"},106:{bytesPerPixel:.53,name:"ASTC_SRGBA_6X5"},107:{bytesPerPixel:.44,name:"ASTC_SRGBA_6X6"},108:{bytesPerPixel:.4,name:"ASTC_SRGBA_8X5"},109:{bytesPerPixel:.33,name:"ASTC_SRGBA_8X6"},110:{bytesPerPixel:.25,name:"ASTC_SRGBA_8X8"},111:{bytesPerPixel:.32,name:"ASTC_SRGBA_10X5"},112:{bytesPerPixel:.27,name:"ASTC_SRGBA_10X6"},113:{bytesPerPixel:.2,name:"ASTC_SRGBA_10X8"},114:{bytesPerPixel:.16,name:"ASTC_SRGBA_10X10"},115:{bytesPerPixel:.13,name:"ASTC_SRGBA_12X10"},116:{bytesPerPixel:.11,name:"ASTC_SRGBA_12X12"}}[e]||{bytesPerPixel:4,name:"Unknown"}},e.calculateTextAssetSize=function(e){try{var n="";return e.text?n=e.text:e._text?n=e._text:e.nativeAsset&&"string"==typeof e.nativeAsset?n=e.nativeAsset:e._file&&"string"==typeof e._file&&(n=e._file),n&&"string"==typeof n?2*n.length+100:(console.warn("TextAsset没有找到文本内容，使用默认大小"),1024)}catch(e){return console.warn("计算TextAsset大小时出错:",e),1024}},e.calculateAssetSize=function(e){var n,t;try{return".atlas"===e._native||(null===(t=null===(n=e._native)||void 0===n?void 0:n.endsWith)||void 0===t?void 0:t.call(n,".atlas"))?this.calculateSpineAtlasSize(e):e._file&&"string"==typeof e._file?new Blob([e._file]).size:1024}catch(e){return console.warn("计算Asset大小时出错:",e),1024}},e.calculateSpineAtlasSize=function(e){try{var n=e._file||e.nativeAsset||"";return new Blob([n]).size}catch(e){return console.warn("计算Spine Atlas大小时出错:",e),2048}},e.calculateImageAssetSize=function(e){try{var n=e._width||e.width||0,t=e._height||e.height||0;if(n>0&&t>0){var i=Math.max(1,Math.min(n,8192)),r=Math.max(1,Math.min(t,8192)),o=4;if(void 0!==e._format){var a=this.getFormatInfoFrom3x(e._format);o=a.bytesPerPixel,a.name}else if(void 0!==e.format){var s=this.getFormatInfoFrom3x(e.format);o=s.bytesPerPixel,s.name}var l=i*r*o,c=l;return e._nativeData&&e._nativeData.byteLength&&(c=Math.max(c,e._nativeData.byteLength)),e._canvas&&(c+=.1*l),e._imageBitmap&&(c+=.05*l),c>1073741824?(console.warn("图像尺寸异常: "+n+"x"+t+", 计算内存="+this.formatBytes(c)+", 使用默认值"),65536):c}if(e._file&&e._file.size){var d=e._file.size;if(d>0&&d<104857600)return 3*d}if(e._nativeUrl||e.nativeUrl){var u=(e._nativeUrl||e.nativeUrl||"").toLowerCase();if(u.includes(".png"))return 262144;if(u.includes(".jpg")||u.includes(".jpeg"))return 786432;if(u.includes(".webp"))return 262144}return 65536}catch(e){return console.warn("计算图像资源大小时出错:",e),65536}},e.calculateAudioSize=function(e){var n,t,i,r,o,a,s,l,c,d,u,h;try{var p=null===(t=null===(n=null==e?void 0:e._player)||void 0===n?void 0:n._player)||void 0===t?void 0:t._audioBuffer;if(p&&p.length&&p.numberOfChannels){var f=Math.max(0,Math.min(p.length,6912e5))*Math.max(1,Math.min(p.numberOfChannels,8))*4;if(f>0&&f<1073741824)return p.sampleRate,p.duration,f}if(e._audio&&e._audio instanceof AudioBuffer){var g=e._audio,m=Math.max(0,Math.min(g.length,6912e5))*Math.max(1,Math.min(g.numberOfChannels,8))*4;if(m>0&&m<1073741824)return g.sampleRate,g.duration,m}if(e._audioBuffer){var y=e._audioBuffer;if(y.length&&y.numberOfChannels){var b=Math.max(0,Math.min(y.length,6912e5))*Math.max(1,Math.min(y.numberOfChannels,8))*4;if(b>0&&b<1073741824)return b}if(y.byteLength&&y.byteLength>0&&y.byteLength<1073741824)return y.byteLength}var v=0;if("number"==typeof e._duration&&e._duration>0?v=e._duration:"number"==typeof e.duration&&e.duration>0?v=e.duration:"number"==typeof(null===(r=null===(i=null==e?void 0:e._player)||void 0===i?void 0:i._player)||void 0===r?void 0:r.duration)&&e._player._player.duration>0?v=e._player._player.duration:"number"==typeof(null===(o=e._meta)||void 0===o?void 0:o.duration)&&e._meta.duration>0&&(v=e._meta.duration),v>0&&v<3600){var x=44100,P=2;"number"==typeof e.sampleRate&&e.sampleRate>0&&e.sampleRate<=192e3?x=e.sampleRate:"number"==typeof(null===(s=null===(a=null==e?void 0:e._player)||void 0===a?void 0:a._player)||void 0===s?void 0:s.sampleRate)&&e._player._player.sampleRate>0&&e._player._player.sampleRate<=192e3&&(x=e._player._player.sampleRate),"number"==typeof e.channels&&e.channels>0&&e.channels<=8?P=e.channels:"number"==typeof(null===(c=null===(l=null==e?void 0:e._player)||void 0===l?void 0:l._player)||void 0===c?void 0:c.channels)&&e._player._player.channels>0&&e._player._player.channels<=8&&(P=e._player._player.channels);var _=v*x*P*4;if(_>0&&_<1073741824)return _}var C="";if("string"==typeof e._nativeUrl?C=e._nativeUrl.toLowerCase():"string"==typeof e.url?C=e.url.toLowerCase():"string"==typeof(null===(d=e._meta)||void 0===d?void 0:d.url)?C=e._meta.url.toLowerCase():"string"==typeof(null===(h=null===(u=null==e?void 0:e._player)||void 0===u?void 0:u._player)||void 0===h?void 0:h.src)&&(C=e._player._player.src.toLowerCase()),C){if(C.includes(".mp3"))return 131072;if(C.includes(".wav"))return 524288;if(C.includes(".ogg"))return 204800;if(C.includes(".m4a")||C.includes(".aac"))return 153600}return 131072}catch(e){return console.warn("计算音频大小时出错:",e),131072}},e.calculatePrefabSize=function(e){try{var n=0;if(n+=2048,e.data&&(n+=this.calculateNodeTreeSize(e.data)),n<=2048&&e._data&&(n+=this.calculateNodeTreeSize(e._data)),n<=2048){var t=(e._name||"").toLowerCase(),i=(e._nativeUrl||"").toLowerCase();n=t.includes("ui")||i.includes("ui")||t.includes("button")?51200:t.includes("character")||t.includes("player")||i.includes("character")?153600:t.includes("effect")||t.includes("particle")||i.includes("effect")?81920:t.includes("scene")||t.includes("level")?204800:30720}return n}catch(e){return console.warn("计算预制体大小时出错:",e),30720}},e.calculateNodeTreeSize=function(e){var n=this;if(!e)return 0;var t=0;try{t+=1024,e._components&&Array.isArray(e._components)&&e._components.forEach((function(e){t+=n.calculateComponentSize(e)})),e._trs&&e._trs.byteLength&&(t+=e._trs.byteLength),e._worldMatrix&&(t+=64),e._children&&Array.isArray(e._children)&&e._children.forEach((function(e){t+=n.calculateNodeTreeSize(e)}))}catch(e){console.warn("计算节点树大小时出错:",e),t=1024}return t},e.calculateComponentSize=function(e){var n;if(!e)return 0;try{switch((null===(n=e.constructor)||void 0===n?void 0:n.name)||""){case"cc_Sprite":case"Sprite":return 2048;case"cc_Label":case"Label":case"cc_RigidBody":case"RigidBody":return 1024;case"cc_Button":case"Button":return 1536;case"cc_Animation":case"Animation":return 4096;case"cc_Collider":case"Collider":default:return 512;case"cc_AudioSource":case"AudioSource":return 768;case"cc_ParticleSystem":case"ParticleSystem":return 8192}}catch(e){return 512}},e.calculateMaterialSize=function(e){try{var n=0;if(n+=1024,e._effect?n+=this.calculateEffectSize(e._effect):e._effectAsset&&(n+=this.calculateEffectSize(e._effectAsset)),e._props)try{n+=2*JSON.stringify(e._props).length}catch(e){n+=1024}if(e._defines)try{n+=2*JSON.stringify(e._defines).length}catch(e){n+=512}if(e._states&&(n+=256),n<=2048){var t=(e._name||"").toLowerCase();n=t.includes("builtin")?8192:t.includes("ui")||t.includes("sprite")?4096:t.includes("particle")||t.includes("effect")?12288:t.includes("3d")||t.includes("pbr")?16384:6144}return(e.refCount||e._ref||1)>5&&(n+=2048),n}catch(e){return console.warn("计算材质大小时出错:",e),6144}},e.calculateMeshSize=function(e){try{if(e.vertexCount&&"number"==typeof e.vertexCount){var n=32*Math.max(0,Math.min(e.vertexCount,1e7));return n>1073741824?(console.warn("网格顶点数异常: "+e.vertexCount+", 计算内存="+this.formatBytes(n)+", 使用默认值"),1048576):n}return e._vertexCount&&"number"==typeof e._vertexCount?32*Math.max(0,Math.min(e._vertexCount,1e7)):e._vertexBuffer&&e._vertexBuffer.byteLength?Math.min(e._vertexBuffer.byteLength,1073741824):1048576}catch(e){return console.warn("计算网格大小时出错:",e),1048576}},e.calculateAnimationSize=function(e){try{var n=0;n+=1024;var t=e._duration||e.duration||0,i=e.sample||e.frameRate||60,r=Math.ceil(t*i);if(e.curveData&&e.curveData.paths){var o=e.curveData.paths;for(var a in o){var s=o[a];if(s.props)for(var l in s.props){0;var c=s.props[l];Array.isArray(c)&&(c.length,c.forEach((function(e){n+=32,Array.isArray(e.value)?n+=8*e.value.length:"number"==typeof e.value?n+=8:"string"==typeof e.value&&(n+=2*e.value.length),e.curve&&(n+=16)})))}}}if(e.events&&Array.isArray(e.events)&&e.events.forEach((function(e){n+=64,e.func&&"string"==typeof e.func&&(n+=2*e.func.length),e.params&&Array.isArray(e.params)&&(n+=16*e.params.length)})),r>300?n+=4096:r>100&&(n+=2048),n<2048){var d=(e._name||"").toLowerCase();n=d.includes("ui")||d.includes("button")?4096:d.includes("character")||d.includes("walk")||d.includes("run")?16384:d.includes("effect")||d.includes("particle")?8192:d.includes("camera")||d.includes("scene")?12288:6144}return n}catch(e){return console.warn("计算动画大小时出错:",e),6144}},e.calculateFontSize=function(e){try{var n=0,t=(e._name||"").toLowerCase(),i=(e._native||"").toLowerCase();return e._fontFamily,n=i.includes(".ttf")?t.includes("chinese")||t.includes("cn")||t.includes("zh")?8388608:t.includes("english")||t.includes("en")||t.includes("latin")?204800:t.includes("icon")||t.includes("symbol")?153600:t.includes("emoji")?2097152:512e3:i.includes(".otf")?614400:i.includes(".woff")||i.includes(".woff2")?307200:409600,n+=1048576,n+=65536,(e.refCount||e._ref||1)>3&&(n+=524288),n}catch(e){return console.warn("计算字体大小时出错:",e),512e3}},e.calculateJSONSize=function(e,n){void 0===n&&(n=0);try{if(n>50)return console.warn("JSON递归深度超过限制，停止计算"),1024;if(null==e)return 4;var t=0;if("string"==typeof e)return 2*Math.min(e.length,1e7);if("number"==typeof e)return 8;if("boolean"==typeof e)return 1;if(Array.isArray(e)){t+=24;for(var i=0;i<Math.min(e.length,1e5);i++)t+=this.calculateJSONSize(e[i],n+1);return t}if("object"==typeof e){t+=24;var r=0;for(var o in e)if(e.hasOwnProperty(o)){if(++r>1e4){console.warn("JSON对象属性数量超过限制，停止计算");break}t+=2*Math.min(o.length,1e3),t+=this.calculateJSONSize(e[o],n+1),t+=16}return t}return 8}catch(e){return console.warn("计算JSON大小时出错:",e),10240}},e.calculateEffectSize=function(e){try{var n=0;if(e.shaders&&Array.isArray(e.shaders)&&e.shaders.forEach((function(e){e.glsl3&&(e.glsl3.vert&&(n+=2*e.glsl3.vert.length),e.glsl3.frag&&(n+=2*e.glsl3.frag.length)),e.glsl1&&(e.glsl1.vert&&(n+=2*e.glsl1.vert.length),e.glsl1.frag&&(n+=2*e.glsl1.frag.length)),e.defines&&Array.isArray(e.defines)&&(n+=50*e.defines.length),e.builtins&&(n+=2*JSON.stringify(e.builtins).length)})),e.techniques&&Array.isArray(e.techniques)&&e.techniques.forEach((function(e){e.passes&&Array.isArray(e.passes)&&e.passes.forEach((function(e){n+=1024,e.blendState&&(n+=256),e.rasterizerState&&(n+=128),e.properties&&(n+=2*JSON.stringify(e.properties).length),e.program&&(n+=2*e.program.length)}))})),e._effect&&(n+=2048),e.properties)try{n+=2*JSON.stringify(e.properties).length}catch(e){n+=512}if(0===n){var t=e._name||"";n=t.includes("builtin")?8192:t.includes("ui")||t.includes("sprite")?4096:t.includes("particle")||t.includes("effect")?16384:12288}return n}catch(e){return console.warn("计算特效大小时出错:",e),8192}},e.calculateBufferSize=function(e){try{if(e._buffer&&e._buffer instanceof ArrayBuffer)return e._buffer.byteLength;if(e.buffer&&e.buffer instanceof ArrayBuffer)return e.buffer.byteLength;if(void 0!==e.byteLength)return e.byteLength;if(void 0!==e.length)return e.length;if(e._serialized&&e._serialized.data){if(e._serialized.data.byteLength)return e._serialized.data.byteLength;if(e._serialized.data.length)return e._serialized.data.length}var n=(e._nativeUrl||e.url||"").toLowerCase();return n.includes(".bin")?51200:n.includes(".dat")?30720:10240}catch(e){return console.warn("计算BufferAsset大小时出错:",e),10240}},e.calculateSkeletonDataSize=function(e){try{var n=0;if(n+=2048,e._buffer&&e._buffer instanceof ArrayBuffer&&(n+=e._buffer.byteLength),e._atlasText&&(n+=2*e._atlasText.length),e.textures&&Array.isArray(e.textures)&&e.textures.forEach((function(e){e&&(n+=64)})),e._skeletonJson)try{n+=2*JSON.stringify(e._skeletonJson).length}catch(e){n+=10240}else e.skeletonJsonStr&&(n+=2*e.skeletonJsonStr.length);var t=e.textureNames?e.textureNames.length:0,i=e.scale||1;if(t>5?n+=8192:t>2&&(n+=4096),i>1.5&&(n+=6144),(e.refCount||e._ref||1)>3&&(n+=4096),n<5120){var r=(e._name||"").toLowerCase();n=r.includes("character")||r.includes("hero")?51200:r.includes("effect")||r.includes("fx")?30720:r.includes("ui")||r.includes("button")?15360:25600}return n}catch(e){return console.warn("计算骨骼数据大小时出错:",e),25600}},e.getBytesPerPixel=function(e){switch(e){case"RGBA8888":case"BGRA8888":default:return 4;case"RGB888":case"BGR888":return 3;case"RGB565":case"RGBA4444":return 2;case"A8":case"L8":return 1}},e.formatBytes=function(e){if(-1===e)return"未计算";if(0===e)return"0 B";var n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(2))+" "+["B","KB","MB","GB"][n]},e}();l._loged_type=new Map,l._ignore_type=new Set(["cc_Texture2D","cc_AudioClip","cc_EffectAsset","cc_Prefab","cc_TTFFont","cc_JsonAsset","cc_BufferAsset","cc_Material","cc_AnimationClip","cc_TextAsset","sp_SkeletonData","JsonAsset","BufferAsset","AudioClip","Prefab","EffectAsset","TTFFont","Material","AnimationClip","ImageAsset","SkeletonData","TextAsset","Asset"]);var c=function(){function e(){}return e.getTotalMemory=function(){try{var e=window.cc;if(e&&e.sys){if(e.sys.getTotalMemory)return e.sys.getTotalMemory();if(e.sys.totalMemory)return e.sys.totalMemory}return performance.memory?performance.memory.jsHeapSizeLimit:1073741824}catch(e){return 1073741824}},e.getUsedMemory=function(){return this._totalSize},e.getTotalCount=function(){return this._totalCount},e.getBundleInfo=function(){this._unknown_assets.length=0,e.parseBundleInfos(),this._unknown_assets.length>0&&console.warn("资源缓存中未查到的资源:",this._unknown_assets);var n=[];return this._bundleInfos.forEach((function(e){n.push(e)})),n.sort((function(e,n){return(n.size||0)-(e.size||0)})),n},e.getBundleDirectoryInfo=function(){this._unknown_assets.length=0,e.parseBundleInfos();var n=[];return this._bundleDirectoryInfos.forEach((function(e){n.push(e)})),n.sort((function(e,n){return(n.size||0)-(e.size||0)})),n},e.getAssetInfo=function(e){return this._assets.get(e)},e.parseBundleInfos=function(){var e,n;try{var t=window.cc;t&&t.assetManager&&t.assetManager.bundles||console.warn("cc.assetManager.bundles is not available");var i=t.assetManager.bundles,r=null==i?void 0:i._map;if(!r)return;for(var o in r){var a=r[o],s=a.name||a._config.base,l=(null===(e=a.config)||void 0===e?void 0:e.assetInfos)||(null===(n=a._config)||void 0===n?void 0:n.assetInfos);for(var c in l._count,l._map){var d=l._map[c].path;this.addAssetInfo(c,d,s)}}}catch(e){console.warn("获取bundle分组资源分类失败:",e)}this.parseLoadedAssets()},e.parseLoadedAssets=function(){var e;this._bundleInfos.clear(),this._bundleDirectoryInfos.clear();try{var n=window.cc.assetManager.assets;if(n)for(var t in this._totalCount=n._count,this._totalSize=0,n._map){var i=n._map[t],r=(null===(e=i.__classname__)||void 0===e?void 0:e.replace("cc.",""))||i.constructor.name;this._assets.has(t)||this.addLooseAsset(t,i,r),this.addLoadedAssets(r,t,i),this.addLoadedAssetsToDirectory(r,t,i)}}catch(e){console.warn("解析已加载资源失败:",e)}this.sortBundleAssetGroups(),this.sortBundleDirectoryGroups()},e.sortBundleAssetGroups=function(){var e=this;this._bundleInfos.forEach((function(n){for(var t in n.groups)n.groups[t].uuids.sort((function(n,t){var i=e._assets.get(n);return(e._assets.get(t).size||0)-(i.size||0)}))}))},e.sortBundleDirectoryGroups=function(){var e=this;this._bundleDirectoryInfos.forEach((function(n){for(var t in n.directories)n.directories[t].uuids.sort((function(n,t){var i=e._assets.get(n);return(e._assets.get(t).size||0)-(i.size||0)}))}))},e.addAssetInfo=function(e,n,t){if(this._assets.has(e)){var i=this._assets.get(e);i.bundleName=t,i.path=n}else this._assets.set(e,{path:n,bundleName:t,size:0})},e.addLooseAsset=function(e,n,t){try{var i=this.getAssetName(n,e);this._assets.set(e,{path:i,bundleName:"不在bundle中或bundle未加载",size:0})}catch(n){console.warn("处理非bundle资源失败 "+e+":",n)}},e.getAssetName=function(e,n){try{return e.name&&"string"==typeof e.name&&e.name.trim()?e.name:e._path&&"string"==typeof e._path&&e._path.trim()?e._path:e.nativeUrl&&"string"==typeof e.nativeUrl&&e.nativeUrl.trim()?e.nativeUrl:n}catch(e){return n}},e.addLoadedAssets=function(e,n,t){if(this._assets.has(n)){var i=this._assets.get(n),r=i.bundleName,o=(i.path,i.size);if(!this.shouldSkipMemoryCalculation(e,t)){o=o||l.calculate(t),i.size=o,this._bundleInfos.has(r)||this._bundleInfos.set(r,{name:r,count:0,size:0,groups:{}});var a=this._bundleInfos.get(r);a.count++,-1!==o&&(this._totalSize+=o,a.size+=o);var s=a.groups[e];s?(s.count++,-1!==o&&(s.size+=o),s.uuids=s.uuids||[],s.uuids.push(n)):a.groups[e]={type:e,count:1,size:o,uuids:[n]}}}else this._unknown_assets.push(n)},e.shouldSkipMemoryCalculation=function(e,n){return a()?!!(e.includes("SpriteFrame")||e.includes("Texture2D")||e.includes("TextureCube")):!!e.includes("SpriteFrame")},e.addLoadedAssetsToDirectory=function(e,n,t){if(this._assets.has(n)){var i=this._assets.get(n);i.extension||(i.extension=this.getExtension(e,t._native));var r=i.bundleName,o=i.path,a=i.size;if(r=r||"未知",!this.shouldSkipMemoryCalculation(e,t)){var s=this.getDirectoryPath(o);this._bundleDirectoryInfos.has(r)||this._bundleDirectoryInfos.set(r,{name:r,count:0,size:0,directories:{}});var l=this._bundleDirectoryInfos.get(r);l.count++,-1!==a&&(l.size+=a);var c=l.directories[s];c?(c.count++,-1!==a&&(c.size+=a),c.uuids=c.uuids||[],c.uuids.push(n)):l.directories[s]={path:s,count:1,size:a,uuids:[n]}}}},e.getExtension=function(e,n){var t="UNKNOWN";if(n&&"string"==typeof n)if(n.includes(".")){var i=n.split(".");t=i[i.length-1].toLowerCase()}else t=n.startsWith(".")?n.substring(1).toLowerCase():n.toLowerCase();else t=e.toLowerCase();return t.length>10&&(t=e.toLowerCase()),this._log_set.has(t)||this._log_set.add(t),t},e.getDirectoryPath=function(e){if(!e)return"/";var n=e.replace(/\\/g,"/"),t=n.lastIndexOf("/");return-1===t?"/":n.substring(0,t)||"/"},e}();c._totalCount=0,c._totalSize=0,c._assets=new Map,c._bundleInfos=new Map,c._bundleDirectoryInfos=new Map,c._unknown_assets=[],c._log_set=new Set;var d=function(){function e(){this.container=null,this.updateInterval=null,this.isMonitoring=!1,this.scrollHandler=null,this.displayMode="type",this.filterConditions={memorySize:null,resourceTypes:[]},this.isFilterPanelVisible=!1}var n=e.prototype;return n.create=function(e){this.createContainer(e),this.applyStyles(),this.startMonitoring()},n.createContainer=function(e){this.container=document.createElement("div"),this.container.className="node-inspector-right-panel resource-memory-panel",this.container.innerHTML='\n            <div class="resource-memory-header">\n                <h3>资源内存监控</h3>\n                <div class="memory-stats">\n                    <div class="stat-item">\n                        <span class="stat-label">已用内存:</span>\n                        <span class="stat-value" id="used-memory">--</span>\n                    </div>\n                    <div class="stat-item">\n                        <span class="stat-label">已加载资源数量:</span>\n                        <span class="stat-value" id="loaded-assets-count">--</span>\n                    </div>\n                </div>\n            </div>\n            <div class="resource-memory-filter">\n                <button class="filter-toggle-button" id="filter-toggle-btn">\n                    <span class="filter-icon">🔍</span>\n                    筛选条件\n                    <span class="filter-count" id="filter-count" style="display: none;"></span>\n                </button>\n                <div class="filter-panel" id="filter-panel" style="display: none;">\n                    <div class="filter-section">\n                        <h4>按内存大小筛选</h4>\n                        <div class="filter-size-controls">\n                            <label>最小值:</label>\n                            <input type="number" id="filter-min-size-input" placeholder="输入数值" min="0" step="1" value="">\n                            <select id="filter-size-unit">\n                                <option value="1">B</option>\n                                <option value="1024" selected>KB</option>\n                                <option value="1048576">MB</option>\n                                <option value="1073741824">GB</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div class="filter-section">\n                        <h4>按资源类型筛选</h4>\n                        <div class="filter-type-controls" id="filter-type-list">\n                            \x3c!-- 动态生成资源类型复选框 --\x3e\n                        </div>\n                    </div>\n                    <div class="filter-actions">\n                        <button class="filter-apply-btn" id="filter-apply-btn">应用筛选</button>\n                        <button class="filter-clear-btn" id="filter-clear-btn">清除筛选</button>\n                    </div>\n                </div>\n            </div>\n            <div class="resource-memory-content">\n                <div id="resource-type-list">\n                    \x3c!-- 动态生成资源类型分块 --\x3e\n                </div>\n            </div>\n            <div class="resource-memory-mode-selector">\n                <div class="mode-selector-label">显示模式:</div>\n                <div class="mode-selector-options">\n                    <label class="mode-option">\n                        <input type="radio" name="display-mode" value="type" checked>\n                        <span class="radio-label">资源类型模式</span>\n                    </label>\n                    <label class="mode-option">\n                        <input type="radio" name="display-mode" value="directory">\n                        <span class="radio-label">目录模式</span>\n                    </label>\n                </div>\n            </div>\n            <div class="resource-memory-footer">\n                <button class="refresh-button-container" id="refresh-memory-btn">\n                    <span class="refresh-icon">🔄</span>\n                    刷新数据\n                </button>\n                <div class="last-update" id="last-update-time">\n                    最后更新: 未更新\n                </div>\n                <div class="memory-tips">\n                    tips: 由于creator未提供资源内存占用的接口，本插件中的内存是插件自主计算获得，不保证一定准确！！！\n                </div>\n            </div>\n        ',e.appendChild(this.container)},n.applyStyles=function(){var e=document.createElement("style");e.textContent='\n            .resource-memory-panel {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                overflow: hidden;\n            }\n\n            .resource-memory-header {\n                flex-shrink: 0;\n                padding: 10px;\n                padding-right: 15px;\n                background: #1a1a1a;\n                border-bottom: 1px solid #444;\n            }\n\n            .resource-memory-header h3 {\n                margin: 0 0 10px 0;\n                color: #fff;\n                font-size: 14px;\n                font-weight: bold;\n            }\n\n            .resource-memory-content {\n                flex: 1;\n                overflow-y: scroll;\n                padding: 0px 15px 0px 10px;\n            }\n\n            /* 滚动条样式 - 参考左侧抽屉 */\n            .resource-memory-content::-webkit-scrollbar {\n                width: 8px;\n            }\n\n            .resource-memory-content::-webkit-scrollbar-track {\n                background: #1e1e1e;\n            }\n\n            .resource-memory-content::-webkit-scrollbar-thumb {\n                background: #555;\n                border-radius: 4px;\n            }\n\n            .resource-memory-content::-webkit-scrollbar-thumb:hover {\n                background: #666;\n            }\n\n            .resource-memory-mode-selector {\n                flex-shrink: 0;\n                padding: 10px;\n                padding-right: 15px;\n                background: #1a1a1a;\n                border-top: 1px solid #444;\n                border-bottom: 1px solid #444;\n            }\n\n            .mode-selector-label {\n                color: #ccc;\n                font-size: 12px;\n                margin-bottom: 8px;\n            }\n\n            .mode-selector-options {\n                display: flex;\n                gap: 20px;\n            }\n\n            .mode-option {\n                display: flex;\n                align-items: center;\n                gap: 6px;\n                cursor: pointer;\n                font-size: 12px;\n                color: #ccc;\n                user-select: none;\n            }\n\n            .mode-option input[type="radio"] {\n                margin: 0;\n                accent-color: #007acc;\n            }\n\n            .mode-option:hover {\n                color: #fff;\n            }\n\n            .radio-label {\n                cursor: pointer;\n            }\n\n            .resource-type {\n                margin-right: 10px;\n                color: #888;\n                font-size: 11px;\n                font-style: italic;\n                white-space: nowrap;\n                flex-shrink: 0;\n            }\n\n            .resource-memory-footer {\n                flex-shrink: 0;\n                padding: 10px;\n                padding-right: 15px;\n                background: #1a1a1a;\n                border-top: 1px solid #444;\n                text-align: center;\n            }\n\n            .memory-stats {\n                background: #1e1e1e;\n                border: 1px solid #444;\n                border-radius: 4px;\n                padding: 10px;\n                margin-bottom: 0;\n            }\n\n            .stat-item {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 5px 0;\n                border-bottom: 1px solid #333;\n            }\n\n            .stat-item:last-child {\n                border-bottom: none;\n            }\n\n            .stat-label {\n                color: #ccc;\n                font-size: 12px;\n            }\n\n            .stat-value {\n                color: #fff;\n                font-weight: bold;\n                font-size: 12px;\n            }\n\n            .resource-categories,\n            .texture-info,\n            .audio-info {\n                background: #1e1e1e;\n                border: 1px solid #444;\n                border-radius: 4px;\n                padding: 10px;\n                margin-bottom: 15px;\n            }\n\n            .resource-categories h4,\n            .texture-info h4,\n            .audio-info h4 {\n                margin: 0 0 10px 0;\n                color: #fff;\n                font-size: 13px;\n                font-weight: bold;\n                border-bottom: 1px solid #444;\n                padding-bottom: 5px;\n                cursor: pointer;\n                user-select: none;\n                display: flex;\n                align-items: center;\n            }\n\n            .bundle-group-block {\n                background: #2a2a2a;\n                border: 2px solid #555;\n                border-radius: 6px;\n                padding: 0;\n                margin: 15px 0;\n            }\n\n            .bundle-group-block:first-child {\n                margin-top: 10px;\n            }\n\n            .bundle-group-block:last-child {\n                margin-bottom: 10px;\n            }\n\n            .bundle-group-header {\n                margin: 0;\n                color: #fff;\n                font-size: 14px;\n                font-weight: bold;\n                background: #333;\n                border-bottom: 1px solid #555;\n                padding: 12px 15px;\n                cursor: pointer;\n                user-select: none;\n                display: flex;\n                align-items: center;\n            }\n\n            .bundle-group-header:hover {\n                background: #3a3a3a;\n            }\n\n            .bundle-content {\n                max-height: 0;\n                overflow: hidden;\n                transition: max-height 0.3s ease;\n                position: relative;\n            }\n\n            .bundle-content.expanded {\n                max-height: none;\n                overflow: visible;\n            }\n\n            /* 移除bundle内容区域滚动条样式 */\n\n            .resource-type-block {\n                border-bottom: 1px solid #444;\n            }\n\n            .resource-type-block:last-child {\n                border-bottom: none;\n            }\n\n            .resource-type-header {\n                margin: 0;\n                color: #fff;\n                font-size: 13px;\n                font-weight: bold;\n                background: #2a2a2a;\n                padding: 10px 15px;\n                cursor: pointer;\n                user-select: none;\n                display: flex;\n                align-items: center;\n                border-bottom: 1px solid #444;\n                transition: background-color 0.2s ease;\n            }\n\n            .resource-type-header:hover {\n                background: #3a3a3a;\n            }\n\n            /* Bundle标题粘性样式 */\n            .bundle-group-header {\n                position: sticky;\n                top: 0;\n                z-index: 20;\n                background: #333;\n            }\n\n            .bundle-group-header.is-sticky {\n                background: #3a3a3a !important;\n                box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n            }\n\n            /* 资源类型标题粘性样式 */\n            .resource-type-header.sticky-header {\n                position: sticky;\n                z-index: 10;\n                background: #2a2a2a;\n                border-bottom: 2px solid #555;\n            }\n\n            .resource-type-header.is-sticky {\n                background: #3a3a3a !important;\n                box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n            }\n\n            .resource-details {\n                max-height: 0;\n                overflow: hidden;\n                transition: max-height 0.3s ease;\n                background: #1e1e1e;\n            }\n\n            .resource-details.expanded {\n                max-height: none;\n                overflow: visible;\n            }\n\n            .resource-detail-item {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 8px 20px;\n                border-bottom: 1px solid #333;\n                font-size: 12px;\n                cursor: pointer;\n            }\n\n            .resource-detail-item:last-child {\n                border-bottom: none;\n            }\n\n            .resource-detail-item:hover {\n                background: #333;\n            }\n\n            .resource-detail-item:hover .inspect-icon {\n                opacity: 1;\n            }\n\n            .resource-detail-name {\n                color: #ccc;\n                flex: 1;\n                margin-right: 10px;\n                overflow: hidden;\n                text-overflow: ellipsis;\n                white-space: nowrap;\n                text-align: left;\n            }\n\n            .resource-detail-size {\n                color: #fff;\n                font-weight: bold;\n                flex-shrink: 0;\n            }\n\n            .inspect-icon {\n                margin-left: 8px;\n                color: #888;\n                font-size: 14px;\n                opacity: 0;\n                transition: opacity 0.2s ease;\n                cursor: pointer;\n                flex-shrink: 0;\n            }\n\n            .inspect-icon:hover {\n                color: #0078d4;\n            }\n\n            .expand-toggle {\n                color: #888;\n                font-size: 12px;\n                margin-right: 8px;\n                transition: transform 0.2s ease;\n                display: inline-block;\n                width: 16px;\n                text-align: center;\n                flex-shrink: 0;\n            }\n\n            .expand-toggle.expanded {\n                transform: rotate(90deg);\n                color: #fff;\n            }\n\n            .bundle-count,\n            .category-count {\n                color: #888;\n                font-weight: normal;\n                font-size: 12px;\n                margin-left: auto;\n                flex-shrink: 0;\n            }\n\n            .bundle-title,\n            .category-title {\n                flex: 1;\n                margin-right: 10px;\n                white-space: nowrap;\n                overflow: hidden;\n                text-overflow: ellipsis;\n                min-width: 0;\n                text-align: left;\n            }\n\n            /* 当文本过长时自动缩小字号 */\n            .category-title {\n                font-size: 13px;\n                display: flex;\n                align-items: center;\n                transition: font-size 0.1s ease;\n            }\n\n            .category-title.text-overflow {\n                font-size: 11px;\n            }\n\n            .category-title.text-overflow-small {\n                font-size: 9px;\n            }\n\n            .no-data {\n                text-align: center;\n                color: #888;\n                padding: 40px 20px;\n                font-style: italic;\n            }\n\n            .category-summary {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 5px 0;\n                border-bottom: 1px solid #333;\n                font-weight: bold;\n            }\n\n            .category-summary:last-child {\n                border-bottom: none;\n            }\n\n            .refresh-button-container {\n                background: #0078d4;\n                color: white;\n                border: none;\n                padding: 8px 16px;\n                border-radius: 4px;\n                cursor: pointer;\n                font-size: 12px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                margin: 0 auto 8px auto;\n                transition: background 0.2s ease;\n            }\n\n            .refresh-button-container:hover {\n                background: #106ebe;\n            }\n\n            .refresh-button-container:active {\n                background: #005a9e;\n            }\n\n            .refresh-icon {\n                margin-right: 6px;\n                font-size: 14px;\n            }\n\n            .refresh-button-container.loading .refresh-icon {\n                animation: spin 1s linear infinite;\n            }\n\n            @keyframes spin {\n                from { transform: rotate(0deg); }\n                to { transform: rotate(360deg); }\n            }\n\n            .last-update {\n                color: #888;\n                font-size: 10px;\n            }\n\n            .memory-tips {\n                color: #f39c12;\n                font-size: 9px;\n                margin-top: 8px;\n                padding: 6px 8px;\n                background: rgba(243, 156, 18, 0.1);\n                border: 1px solid rgba(243, 156, 18, 0.3);\n                border-radius: 3px;\n                text-align: left;\n                line-height: 1.4;\n            }\n\n            /* 筛选相关样式 */\n            .resource-memory-filter {\n                flex-shrink: 0;\n                padding: 8px 10px;\n                background: #1a1a1a;\n                border-bottom: 1px solid #444;\n            }\n\n            .filter-toggle-button {\n                width: 100%;\n                background: #2a2a2a;\n                color: #fff;\n                border: 1px solid #555;\n                padding: 8px 12px;\n                border-radius: 4px;\n                cursor: pointer;\n                font-size: 12px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                transition: background 0.2s ease;\n                position: relative;\n            }\n\n            .filter-toggle-button:hover {\n                background: #3a3a3a;\n            }\n\n            .filter-icon {\n                margin-right: 6px;\n                font-size: 14px;\n            }\n\n            .filter-count {\n                background: #e74c3c;\n                color: white;\n                border-radius: 10px;\n                padding: 2px 6px;\n                margin-left: 8px;\n                font-size: 10px;\n                font-weight: bold;\n            }\n\n            .filter-panel {\n                margin-top: 8px;\n                background: #1e1e1e;\n                border: 1px solid #444;\n                border-radius: 4px;\n                padding: 12px;\n                animation: slideDown 0.2s ease;\n            }\n\n            @keyframes slideDown {\n                from {\n                    opacity: 0;\n                    transform: translateY(-10px);\n                }\n                to {\n                    opacity: 1;\n                    transform: translateY(0);\n                }\n            }\n\n            .filter-section {\n                margin-bottom: 12px;\n            }\n\n            .filter-section:last-child {\n                margin-bottom: 0;\n            }\n\n            .filter-section h4 {\n                margin: 0 0 8px 0;\n                color: #fff;\n                font-size: 12px;\n                font-weight: bold;\n            }\n\n            .filter-size-controls {\n                display: grid;\n                grid-template-columns: auto 1fr auto;\n                gap: 8px;\n                align-items: center;\n            }\n\n            .filter-size-controls label {\n                color: #ccc;\n                font-size: 11px;\n            }\n\n            .filter-size-controls input,\n            .filter-size-controls select {\n                background: #333;\n                color: #fff;\n                border: 1px solid #555;\n                border-radius: 3px;\n                padding: 4px 6px;\n                font-size: 11px;\n            }\n\n            .filter-size-controls input:focus {\n                outline: none;\n                border-color: #0078d4;\n            }\n\n            .filter-type-controls {\n                max-height: 120px;\n                overflow-y: auto;\n                border: 1px solid #333;\n                border-radius: 3px;\n                padding: 6px;\n                background: #333;\n            }\n\n            .filter-type-item {\n                display: flex;\n                align-items: center;\n                padding: 4px 0;\n                color: #ccc;\n                font-size: 11px;\n            }\n\n            .filter-type-item input[type="checkbox"] {\n                margin-right: 6px;\n            }\n\n            .filter-actions {\n                display: flex;\n                gap: 8px;\n                margin-top: 12px;\n            }\n\n            .filter-apply-btn,\n            .filter-clear-btn {\n                flex: 1;\n                padding: 6px 12px;\n                border: none;\n                border-radius: 3px;\n                font-size: 11px;\n                cursor: pointer;\n                transition: background 0.2s ease;\n            }\n\n            .filter-apply-btn {\n                background: #27ae60;\n                color: white;\n            }\n\n            .filter-apply-btn:hover {\n                background: #2ecc71;\n            }\n\n            .filter-clear-btn {\n                background: #e74c3c;\n                color: white;\n            }\n\n            .filter-clear-btn:hover {\n                background: #c0392b;\n            }\n        ',document.head.appendChild(e)},n.bindEvents=function(){var e=this;this.container.addEventListener("click",(function(n){var t=n.target;if(t.classList.contains("inspect-icon")){n.stopPropagation();var i=t.getAttribute("data-uuid");i&&e.inspectAssetInDevTools(i)}else if(t.classList.contains("resource-detail-item")||t.closest(".resource-detail-item")){var r=t.classList.contains("resource-detail-item")?t:t.closest(".resource-detail-item"),o=null==r?void 0:r.getAttribute("data-uuid");o&&e.inspectAssetInDevTools(o)}else{var a=t.closest(".bundle-group-header");if(a){var s=a.getAttribute("data-target");s&&e.toggleExpand(s)}else{var l=t.closest(".resource-type-header");if(l){var c=l.getAttribute("data-target");c&&e.toggleExpand(c)}}}})),this.container.querySelectorAll('input[name="display-mode"]').forEach((function(n){n.addEventListener("change",(function(n){var t=n.target;t.checked&&(e.displayMode=t.value,e.updateResourceTypeList())}))}));var n=this.container.querySelector("#refresh-memory-btn");n&&n.addEventListener("click",(function(){e.refreshData()})),this.bindFilterEvents()},n.bindFilterEvents=function(){var e=this,n=this.container.querySelector("#filter-toggle-btn");n&&n.addEventListener("click",(function(){e.toggleFilterPanel()}));var t=this.container.querySelector("#filter-apply-btn");t&&t.addEventListener("click",(function(){e.applyFilter()}));var i=this.container.querySelector("#filter-clear-btn");i&&i.addEventListener("click",(function(){e.clearFilter()}))},n.toggleFilterPanel=function(){var e=this.container.querySelector("#filter-panel");e&&(this.isFilterPanelVisible=!this.isFilterPanelVisible,e.style.display=this.isFilterPanelVisible?"block":"none",this.isFilterPanelVisible&&this.updateFilterTypeList())},n.updateFilterTypeList=function(){var e=this,n=this.container.querySelector("#filter-type-list");if(n){n.innerHTML="";var t=c.getBundleInfo(),i=new Set;t.forEach((function(e){Object.keys(e.groups).forEach((function(e){i.add(e)}))})),Array.from(i).sort().forEach((function(t){var i=document.createElement("div");i.className="filter-type-item";var r=document.createElement("input");r.type="checkbox",r.id="filter-type-"+t,r.value=t,r.checked=e.filterConditions.resourceTypes.includes(t);var o=document.createElement("label");o.htmlFor="filter-type-"+t,o.textContent=t,i.appendChild(r),i.appendChild(o),n.appendChild(i)}))}},n.applyFilter=function(){var e=this.container.querySelector("#filter-min-size-input"),n=this.container.querySelector("#filter-size-unit"),t=parseFloat(e.value)||0,i=parseInt(n.value)||1;if(t>0){var r=t*i;this.filterConditions.memorySize={min:r,max:Number.MAX_SAFE_INTEGER}}else this.filterConditions.memorySize=null;var o=this.container.querySelectorAll('#filter-type-list input[type="checkbox"]:checked');this.filterConditions.resourceTypes=Array.from(o).map((function(e){return e.value})),this.updateFilterCount(),this.isFilterPanelVisible=!1;var a=this.container.querySelector("#filter-panel");a&&(a.style.display="none"),this.updateResourceTypeList(),s.log("应用筛选条件:",this.filterConditions)},n.clearFilter=function(){this.filterConditions.memorySize=null,this.filterConditions.resourceTypes=[];var e=this.container.querySelector("#filter-min-size-input"),n=this.container.querySelector("#filter-size-unit");e&&(e.value=""),n&&(n.value="1024"),this.container.querySelectorAll('#filter-type-list input[type="checkbox"]').forEach((function(e){return e.checked=!1})),this.updateFilterCount(),this.isFilterPanelVisible=!1;var t=this.container.querySelector("#filter-panel");t&&(t.style.display="none"),this.updateResourceTypeList()},n.inspectAssetInDevTools=function(e){var n,t,i,r,o;try{var a=window.cc,s=null===(i=null===(t=null===(n=null==a?void 0:a.assetManager)||void 0===n?void 0:n.assets)||void 0===t?void 0:t.get)||void 0===i?void 0:i.call(t,e);if(!s)return console.warn("无法找到UUID为 "+e+" 的资源"),void this.showInspectFeedback("资源未找到或已被释放");var l=this.getAssetUrl(s);l?(this.openResourceInGrayWindow(l),this.showInspectFeedback("已在新窗口中打开资源"),console.group("🔍 资源定位信息 - "+((null===(r=s.constructor)||void 0===r?void 0:r.name)||"Unknown")),console.log("📋 资源UUID: "+e),console.log("🔗 资源URL: "+l),console.log("📄 资源对象:",s),console.groupEnd()):(console.group("🔍 资源信息 - "+((null===(o=s.constructor)||void 0===o?void 0:o.name)||"Unknown")),console.log("📋 资源UUID: "+e),console.log("📄 资源对象:",s),console.groupEnd(),this.showInspectFeedback("已在控制台打印资源信息"))}catch(e){console.error("定位资源时发生错误:",e),this.showInspectFeedback("定位资源失败，请查看控制台")}},n.openResourceInGrayWindow=function(e){var n=new Blob(['\n            <!DOCTYPE html>\n            <html>\n            <head>\n                <meta charset="UTF-8">\n                <title>资源预览</title>\n                <style>\n                    body {\n                        background-color: #808080;\n                        margin: 0;\n                        padding: 20px;\n                        display: flex;\n                        justify-content: center;\n                        align-items: center;\n                        min-height: 100vh;\n                        font-family: Arial, sans-serif;\n                    }\n                    .resource-container {\n                        background: white;\n                        border-radius: 8px;\n                        padding: 20px;\n                        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n                        max-width: 90%;\n                        max-height: 90%;\n                        overflow: auto;\n                    }\n                    img {\n                        max-width: 100%;\n                        max-height: 100%;\n                        object-fit: contain;\n                        display: block;\n                        margin: 0 auto;\n                    }\n                    .resource-info {\n                        text-align: center;\n                        margin-top: 10px;\n                        color: #666;\n                        font-size: 14px;\n                    }\n                </style>\n            </head>\n            <body>\n                <div class="resource-container">\n                    <img src="'+e+'" alt="资源预览" onerror="this.style.display=\'none\'; this.nextElementSibling.style.display=\'block\';">\n                    <div class="resource-info" style="display: none;">\n                        <p>无法显示资源预览</p>\n                        <p><a href="'+e+'" target="_blank">点击此处访问原始资源</a></p>\n                    </div>\n                    <div class="resource-info">\n                        <p>资源地址: '+e+"</p>\n                    </div>\n                </div>\n            </body>\n            </html>\n        "],{type:"text/html"}),t=URL.createObjectURL(n);window.open(t,"_blank","width=900,height=700,scrollbars=yes,resizable=yes"),setTimeout((function(){URL.revokeObjectURL(t)}),1e3)},n.getAssetUrl=function(e){try{if(!e||!e.nativeUrl)return null;var n=e.nativeUrl,t=n.split(".").pop();if(t&&!["png","jpg","jpeg","gif","webp","svg","ico","bmp","tiff","tif","raw","heic","heif"].includes(t))return null;if(n.startsWith("http://")||n.startsWith("https://")||n.startsWith("//"))return n;if(n.startsWith("./")||n.startsWith("/")||!n.includes("://")){var i=window.location.origin+window.location.pathname.replace(/\/[^\/]*$/,"/");return new URL(n,i).href}return null}catch(e){return console.warn("获取资源URL失败:",e),null}},n.showInspectFeedback=function(e){var n=document.createElement("div");n.style.cssText="\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: #0078d4;\n            color: white;\n            padding: 10px 15px;\n            border-radius: 4px;\n            font-size: 12px;\n            z-index: 10000;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.3);\n            animation: slideInRight 0.3s ease;\n        ",n.textContent=e;var t=document.createElement("style");t.textContent="\n            @keyframes slideInRight {\n                from { transform: translateX(100%); opacity: 0; }\n                to { transform: translateX(0); opacity: 1; }\n            }\n            @keyframes slideOutRight {\n                from { transform: translateX(0); opacity: 1; }\n                to { transform: translateX(100%); opacity: 0; }\n            }\n        ",document.head.appendChild(t),document.body.appendChild(n),setTimeout((function(){n.style.animation="slideOutRight 0.3s ease",setTimeout((function(){n.parentNode&&n.parentNode.removeChild(n),t.parentNode&&t.parentNode.removeChild(t)}),300)}),3e3)},n.updateFilterCount=function(){var e=this.container.querySelector("#filter-count");if(e){var n=0;this.filterConditions.memorySize&&n++,this.filterConditions.resourceTypes.length>0&&n++,n>0?(e.textContent=""+n,e.style.display="inline"):e.style.display="none"}},n.applyFilterToData=function(e){var n=this;if(!this.filterConditions.memorySize&&0===this.filterConditions.resourceTypes.length)return e;var t=[];return e.forEach((function(e){var i={},r=!1;if(Object.keys(e.groups).forEach((function(t){var o=e.groups[t];if(!(n.filterConditions.resourceTypes.length>0)||n.filterConditions.resourceTypes.includes(t)){if(n.filterConditions.memorySize){var a=o.size||0;if(a<n.filterConditions.memorySize.min||a>n.filterConditions.memorySize.max)return}if(n.filterConditions.memorySize&&o.uuids){var s=[],l=0,d=0;o.uuids.forEach((function(e){var t=c.getAssetInfo(e);if(t){var i=t.size||0;i>=n.filterConditions.memorySize.min&&i<=n.filterConditions.memorySize.max&&(s.push(e),l+=i,d++)}})),s.length>0&&(i[t]=Object.assign(Object.assign({},o),{uuids:s,size:l,count:d}),r=!0)}else i[t]=o,r=!0}})),r){var o=0,a=0;Object.values(i).forEach((function(e){o+=e.size||0,a+=e.count||0})),t.push(Object.assign(Object.assign({},e),{groups:i,size:o,count:a}))}})),t},n.applyFilterToDirectoryData=function(e){var n=this;if(!this.filterConditions.memorySize&&0===this.filterConditions.resourceTypes.length)return e;var t=[];return e.forEach((function(e){var i={},r=!1;if(Object.keys(e.directories).forEach((function(t){var o=e.directories[t];if(o.uuids){var a=[],s=0,l=0;o.uuids.forEach((function(e){var t,i,r,o,d=c.getAssetInfo(e);if(d){var u=window.cc,h=null===(r=null===(i=null===(t=null==u?void 0:u.assetManager)||void 0===t?void 0:t.assets)||void 0===i?void 0:i._map)||void 0===r?void 0:r[e],p=(null===(o=null==h?void 0:h.constructor)||void 0===o?void 0:o.name)||"Unknown";if(n.filterConditions.resourceTypes.length>0&&!n.filterConditions.resourceTypes.includes(p))return;var f=d.size||0;if(n.filterConditions.memorySize&&(f<n.filterConditions.memorySize.min||f>n.filterConditions.memorySize.max))return;a.push(e),s+=f,l++}})),a.length>0&&(i[t]=Object.assign(Object.assign({},o),{uuids:a,size:s,count:l}),r=!0)}})),r){var o=0,a=0;Object.values(i).forEach((function(e){o+=e.size||0,a+=e.count||0})),t.push(Object.assign(Object.assign({},e),{directories:i,size:o,count:a}))}})),t},n.refreshData=function(){var e=this,n=this.container.querySelector("#refresh-memory-btn");n&&(n.classList.add("loading"),n.textContent="刷新中..."),setTimeout((function(){e.updateMemoryInfo(),e.updateLastUpdateTime(),n&&(n.classList.remove("loading"),n.innerHTML='<span class="refresh-icon">🔄</span>刷新数据')}),500)},n.updateLastUpdateTime=function(){var e=this.container.querySelector("#last-update-time");if(e){var n=(new Date).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"});e.textContent="最后更新: "+n}},n.toggleExpand=function(e){var n=this,t=this.container.querySelector("#"+e);if(t){var i=this.container.querySelector('[data-target="'+e+'"]'),r=null==i?void 0:i.querySelector(".expand-toggle");t.classList.contains("expanded")?(t.classList.remove("expanded"),r&&r.classList.remove("expanded")):(t.classList.add("expanded"),r&&r.classList.add("expanded")),setTimeout((function(){n.addStickyHeaderBehavior()}),50)}else console.warn("无法找到目标元素: "+e)},n.startMonitoring=function(){this.isMonitoring||(this.isMonitoring=!0,this.bindEvents(),this.updateMemoryInfo(),this.updateLastUpdateTime(),console.log("资源内存监控已开始（手动刷新模式）"))},n.stopMonitoring=function(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.isMonitoring=!1,console.log("资源内存监控已停止")},n.updateMemoryInfo=function(){try{this.updateResourceTypeList(),this.updateSystemMemory()}catch(e){console.warn("更新内存信息失败:",e)}},n.updateSystemMemory=function(){var e=c.getUsedMemory(),n=c.getTotalCount();this.updateElement("used-memory",l.formatBytes(e)),this.updateElement("loaded-assets-count",n.toString())},n.updateResourceTypeList=function(){var e=this.container.querySelector("#resource-type-list");e&&("type"===this.displayMode?this.renderResourceTypeMode(e):this.renderDirectoryMode(e))},n.renderResourceTypeMode=function(e){var n=this,t=new Map;e.querySelectorAll(".expanded").forEach((function(e){e.id&&t.set(e.id,!0)})),e.innerHTML="";var i=c.getBundleInfo();0!==i.length?0!==(i=this.applyFilterToData(i)).length?(i.forEach((function(i){var r=document.createElement("div");r.className="bundle-group-block";var o=n.escapeSelector(i.name),a=document.createElement("h3");a.className="bundle-group-header",a.setAttribute("data-target","bundle-"+o),a.innerHTML='\n                <span class="expand-toggle">▶</span>\n                <span class="bundle-title">'+i.name+'</span>\n                <span class="bundle-count">'+(i.count||0)+" 个资源 / "+l.formatBytes(i.size||0)+"</span>\n            ",r.appendChild(a);var s=document.createElement("div");if(s.className="bundle-content",s.id="bundle-"+o,t.get(s.id)){s.classList.add("expanded");var d=a.querySelector(".expand-toggle");d&&d.classList.add("expanded")}var u=i.groups;Object.keys(u).sort((function(e,n){return(u[n].size||0)-(u[e].size||0)})).forEach((function(e){var i=u[e],r=document.createElement("div");r.className="resource-type-block";var a=n.escapeSelector(e),d=document.createElement("h4");if(d.className="resource-type-header sticky-header",d.setAttribute("data-target","type-"+o+"-"+a),d.innerHTML='\n                    <span class="expand-toggle">▶</span>\n                    <span class="category-title">'+e+'</span>\n                    <span class="category-count">'+i.count+" 个 / "+l.formatBytes(i.size)+"</span>\n                ",r.appendChild(d),i.uuids&&i.uuids.length>0){var h=document.createElement("div");if(h.className="resource-details",h.id="type-"+o+"-"+a,t.get(h.id)){h.classList.add("expanded");var p=d.querySelector(".expand-toggle");p&&p.classList.add("expanded")}var f=[];i.uuids.forEach((function(e){var n=c.getAssetInfo(e);n&&f.push({name:n.path||e,size:n.size||0,uuid:e})})),f.sort((function(e,n){return n.size-e.size})),f.forEach((function(e){var n=document.createElement("div");n.className="resource-detail-item",n.setAttribute("data-uuid",e.uuid),n.setAttribute("title","点击打开资源预览\n资源名称: "+e.name+"\n提示: 会在新标签页中打开资源，同时在控制台提供Network页签定位指引"),n.innerHTML='\n                            <span class="resource-detail-name" title="'+e.name+'">'+e.name+'</span>\n                            <span class="resource-detail-size">'+l.formatBytes(e.size)+'</span>\n                            <span class="inspect-icon" data-uuid="'+e.uuid+'" title="在新标签页打开资源预览">🔍</span>\n                        ',h.appendChild(n)})),r.appendChild(h)}s.appendChild(r)})),r.appendChild(s),e.appendChild(r)})),this.addStickyHeaderBehavior()):e.innerHTML='<div class="no-data">没有符合筛选条件的资源数据</div>':e.innerHTML='<div class="no-data">暂无资源数据，请点击刷新按钮获取数据</div>'},n.renderDirectoryMode=function(e){var n=this,t=new Map;e.querySelectorAll(".expanded").forEach((function(e){e.id&&t.set(e.id,!0)})),e.innerHTML="";var i=c.getBundleDirectoryInfo();0!==i.length?0!==(i=this.applyFilterToDirectoryData(i)).length?(i.forEach((function(i){var r=document.createElement("div");r.className="bundle-group-block";var o=n.escapeSelector(i.name),a=document.createElement("h3");a.className="bundle-group-header",a.setAttribute("data-target","bundle-dir-"+o),a.innerHTML='\n                <span class="expand-toggle">▶</span>\n                <span class="bundle-title">'+i.name+'</span>\n                <span class="bundle-count">'+(i.count||0)+" 个资源 / "+l.formatBytes(i.size||0)+"</span>\n            ",r.appendChild(a);var s=document.createElement("div");if(s.className="bundle-content",s.id="bundle-dir-"+o,t.get(s.id)){s.classList.add("expanded");var d=a.querySelector(".expand-toggle");d&&d.classList.add("expanded")}var u=i.directories;Object.keys(u).sort((function(e,n){return(u[n].size||0)-(u[e].size||0)})).forEach((function(e){var i=u[e],r=document.createElement("div");r.className="resource-type-block";var a=n.escapeSelector(e),d=document.createElement("h4");d.className="resource-type-header sticky-header",d.setAttribute("data-target","dir-"+o+"-"+a);var h="/"===e?"根目录":e;d.innerHTML='\n                    <span class="expand-toggle">▶</span>\n                    <span class="category-title">📁 '+h+'</span>\n                    <span class="category-count">'+i.count+" 个 / "+l.formatBytes(i.size)+"</span>\n                ",r.appendChild(d);var p=d.querySelector(".category-title");if(p&&setTimeout((function(){return n.adjustSingleTitleOverflow(p)}),0),i.uuids&&i.uuids.length>0){var f=document.createElement("div");if(f.className="resource-details",f.id="dir-"+o+"-"+a,t.get(f.id)){f.classList.add("expanded");var g=d.querySelector(".expand-toggle");g&&g.classList.add("expanded")}var m=[];i.uuids.forEach((function(e){var n=c.getAssetInfo(e);if(n){var t=n.path?n.path.split("/").pop():e,i=n.extension||"UNKNOWN";m.push({name:t||"unknown",size:n.size||0,type:i,uuid:e})}})),m.sort((function(e,n){return n.size-e.size})),m.forEach((function(e){var n=document.createElement("div");n.className="resource-detail-item",n.setAttribute("data-uuid",e.uuid),n.setAttribute("title","点击打开资源预览\n文件名: "+e.name+"\n类型: "+e.type+"\n提示: 会在新标签页中打开资源，同时在控制台提供Network页签定位指引"),n.innerHTML='\n                            <span class="resource-detail-name" title="'+e.name+'">'+e.name+'</span>\n                            <span class="resource-type">['+e.type+']</span>\n                            <span class="resource-detail-size">'+l.formatBytes(e.size)+'</span>\n                            <span class="inspect-icon" data-uuid="'+e.uuid+'" title="在新标签页打开资源预览">🔍</span>\n                        ',f.appendChild(n)})),r.appendChild(f)}s.appendChild(r)})),r.appendChild(s),e.appendChild(r)})),this.addStickyHeaderBehavior()):e.innerHTML='<div class="no-data">没有符合筛选条件的资源数据</div>':e.innerHTML='<div class="no-data">暂无资源数据，请点击刷新按钮获取数据</div>'},n.addStickyHeaderBehavior=function(){var e=this.container.querySelector(".resource-memory-content");e&&(this.scrollHandler&&e.removeEventListener("scroll",this.scrollHandler),this.scrollHandler=this.createStickyScrollHandler(),e.addEventListener("scroll",this.scrollHandler),this.adjustTextOverflow())},n.createStickyScrollHandler=function(){var e=this,n=!1;return function(){n||(requestAnimationFrame((function(){e.updateStickyHeaders(),n=!1})),n=!0)}},n.updateStickyHeaders=function(){var e=this.container.querySelector(".resource-memory-content");if(e){var n=e.getBoundingClientRect().top,t=e.querySelectorAll(".bundle-group-block"),i=null,r=0;if(t.forEach((function(e){var t=e.querySelector(".bundle-group-header"),r=e.querySelector(".bundle-content");if(t&&r){t.style.top="0px",t.classList.remove("is-sticky"),e.querySelectorAll(".resource-type-header").forEach((function(e){e.style.top="0px",e.classList.remove("is-sticky")}));var o=t.getBoundingClientRect(),a=r.getBoundingClientRect();o.top<=n&&a.bottom>n&&(i=t)}})),i){i.style.top="0px",i.classList.add("is-sticky"),r=i.offsetHeight;var o=i.closest(".bundle-group-block"),a=null==o?void 0:o.querySelector(".bundle-content");if(o&&a&&a.classList.contains("expanded")){var s=o.querySelectorAll(".resource-type-header"),l=null;s.forEach((function(e){var t=e.nextElementSibling;if(t&&t.classList.contains("expanded")){var i=e.getBoundingClientRect(),o=t.getBoundingClientRect();i.top<=n+r&&o.bottom>n+r&&(l=e)}})),l&&(l.style.top=r+"px",l.classList.add("is-sticky"))}}}},n.updateElement=function(e,n){var t=document.getElementById(e);t&&(t.textContent=n)},n.destroy=function(){if(this.stopMonitoring(),this.scrollHandler&&this.container){var e=this.container.querySelector(".resource-memory-content");e&&e.removeEventListener("scroll",this.scrollHandler)}this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.scrollHandler=null},n.adjustTextOverflow=function(){var e=this;this.container&&this.container.querySelectorAll(".category-title").forEach((function(n){e.adjustSingleTitleOverflow(n)}))},n.adjustSingleTitleOverflow=function(e){e.hasAttribute("data-overflow-checked")||(e.setAttribute("data-overflow-checked","true"),e.scrollWidth>e.clientWidth&&(e.classList.add("text-overflow"),setTimeout((function(){e.scrollWidth>e.clientWidth&&(e.classList.remove("text-overflow"),e.classList.add("text-overflow-small"))}),250)))},n.escapeSelector=function(e){return e.replace(/[^\w-]/g,"_")},e}(),u=function(){function e(){this.container=null,this.content=null,this.toggleButton=null,this.resizeHandle=null,this.isOpen=!1,this.toggleCallback=null,this.isResizing=!1,this.startX=0,this.startWidth=0,this.minWidth=150,this.maxWidth=800,this.defaultWidth=300}var n=e.prototype;return n.create=function(){this.createContainer(),this.createToggleButton(),this.createContent(),this.createResizeHandle(),this.applyStyles(),this.bindEvents(),this.bindResizeEvents(),this.setInitialState()},n.createContainer=function(){this.container=document.createElement("div"),this.container.id="node-inspector-right-drawer",this.container.style.width=this.defaultWidth+"px",document.body.appendChild(this.container)},n.createToggleButton=function(){this.toggleButton=document.createElement("div"),this.toggleButton.id="node-inspector-right-toggle",this.toggleButton.innerHTML="内<br>存<br>监<br>控",this.toggleButton.title="切换资源监控器",this.container.appendChild(this.toggleButton)},n.createContent=function(){this.content=document.createElement("div"),this.content.id="node-inspector-right-content",this.container.appendChild(this.content)},n.createResizeHandle=function(){this.resizeHandle=document.createElement("div"),this.resizeHandle.id="node-inspector-right-resize-handle",this.container.appendChild(this.resizeHandle)},n.applyStyles=function(){var e=document.createElement("style");e.textContent="\n            #node-inspector-right-drawer {\n                position: fixed;\n                top: 0;\n                right: 0;\n                height: 100vh;\n                background: #2d2d2d;\n                border-left: 1px solid #444;\n                z-index: 10000;\n                transition: transform 0.3s ease;\n                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n                font-size: 12px;\n                color: #fff;\n                box-shadow: -2px 0 10px rgba(0,0,0,0.3);\n                min-width: "+this.minWidth+"px;\n                max-width: "+this.maxWidth+"px;\n            }\n\n            #node-inspector-right-drawer.closed {\n                transform: translateX(100%);\n            }\n\n            #node-inspector-right-toggle {\n                position: absolute;\n                top: calc(50vh + 100px);\n                left: -30px;\n                transform: translateY(-50%);\n                width: 30px;\n                height: 160px;\n                background: #2d2d2d;\n                border: 1px solid #444;\n                border-right: none;\n                border-radius: 5px 0 0 5px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                cursor: pointer;\n                font-size: 14px;\n                color: #fff;\n                user-select: none;\n                transition: background 0.2s ease;\n            }\n\n            #node-inspector-right-toggle:hover {\n                background: #3d3d3d;\n            }\n\n            #node-inspector-right-resize-handle {\n                position: absolute;\n                top: 0;\n                left: 0;\n                width: 4px;\n                height: 100%;\n                background: transparent;\n                cursor: col-resize;\n                z-index: 1001;\n                transition: background 0.2s ease;\n            }\n\n            #node-inspector-right-resize-handle:hover {\n                background: #0078d4;\n            }\n\n            #node-inspector-right-content {\n                width: 100%;\n                height: 100%;\n                overflow: hidden;\n                padding-left: 4px;\n                padding-right: 12px;\n                box-sizing: border-box;\n                background: transparent;\n            }\n\n            .node-inspector-right-panel {\n                background: #2d2d2d;\n                border-bottom: 1px solid #444;\n                overflow: auto;\n            }\n\n            .node-inspector-right-panel h3 {\n                margin: 0;\n                padding: 10px;\n                background: #1e1e1e;\n                border-bottom: 1px solid #444;\n                font-size: 14px;\n                font-weight: bold;\n            }\n\n            /* 拖拽时的样式 */\n            body.resizing-right-drawer {\n                user-select: none;\n                cursor: col-resize !important;\n            }\n\n            body.resizing-right-drawer * {\n                pointer-events: none !important;\n            }\n\n            body.resizing-right-drawer #node-inspector-right-drawer {\n                pointer-events: auto !important;\n            }\n\n            body.resizing-right-drawer #node-inspector-right-resize-handle {\n                pointer-events: auto !important;\n            }\n\n            /* 防止iframe或canvas干扰 */\n            body.resizing-right-drawer iframe,\n            body.resizing-right-drawer canvas,\n            body.resizing-right-drawer embed,\n            body.resizing-right-drawer object {\n                pointer-events: none !important;\n            }\n        ",document.head.appendChild(e)},n.bindEvents=function(){var e=this;this.toggleButton&&this.toggleButton.addEventListener("click",(function(){e.toggle()}))},n.toggle=function(){this.isOpen=!this.isOpen,this.updateUI(),this.toggleCallback&&this.toggleCallback(this.isOpen)},n.onToggle=function(e){this.toggleCallback=e},n.isDrawerOpen=function(){return this.isOpen},n.getContentContainer=function(){return this.content},n.destroy=function(){this.container&&(document.body.removeChild(this.container),this.container=null),this.content=null,this.toggleButton=null,this.resizeHandle=null},n.setInitialState=function(){this.isOpen=!1,this.updateUI()},n.updateUI=function(){this.container&&(this.isOpen?this.container.classList.remove("closed"):this.container.classList.add("closed"))},n.bindResizeEvents=function(){var e=this;this.resizeHandle&&(this.resizeHandle.addEventListener("mousedown",(function(n){e.startResize(n)})),document.addEventListener("mousemove",(function(n){e.handleResize(n)}),{capture:!0}),document.addEventListener("mouseup",(function(n){e.stopResize()}),{capture:!0}),document.addEventListener("mouseleave",(function(){e.stopResize()})),window.addEventListener("blur",(function(){e.stopResize()})))},n.startResize=function(e){this.isResizing=!0,this.startX=e.clientX,this.startWidth=this.container.clientWidth,document.body.classList.add("resizing-right-drawer"),this.resizeHandle.style.background="#0078d4",e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},n.handleResize=function(e){if(this.isResizing){var n=this.startX-e.clientX,t=Math.max(this.minWidth,Math.min(this.maxWidth,this.startWidth+n));this.container.style.width=t+"px",e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}},n.stopResize=function(){this.isResizing&&(this.isResizing=!1,document.body.classList.remove("resizing-right-drawer"),this.resizeHandle.style.background="")},n.resetWidth=function(){this.container&&(this.container.style.width=this.defaultWidth+"px")},e}(),h=function(){function e(){this.container=null,this.treeContainer=null,this.nodeSelectCallback=null,this.nodeHighlightCallback=null,this.expandedNodes=new Set,this.selectedNodeId=null,this.lastNodesHash="",this.isInteracting=!1,this.filterInput=null,this.clearButton=null,this.allNodes=[],this.filterText=""}var n=e.prototype;return n.create=function(e){this.createContainer(e),this.applyStyles()},n.createContainer=function(e){var n=this;this.container=document.createElement("div"),this.container.className="node-inspector-panel node-tree";var t=document.createElement("div");t.className="node-tree-header";var i=document.createElement("h3");i.textContent="节点树",t.appendChild(i);var r=document.createElement("div");r.className="filter-container",this.filterInput=document.createElement("input"),this.filterInput.type="text",this.filterInput.placeholder="过滤节点...",this.filterInput.className="filter-input",this.filterInput.addEventListener("input",(function(e){n.filterText=e.target.value,n.applyFilter()})),this.clearButton=document.createElement("button"),this.clearButton.textContent="×",this.clearButton.className="clear-button",this.clearButton.title="清除过滤",this.clearButton.addEventListener("click",(function(){n.clearFilter()})),r.appendChild(this.filterInput),r.appendChild(this.clearButton),t.appendChild(r),this.container.appendChild(t),this.treeContainer=document.createElement("div"),this.treeContainer.className="tree-container",this.container.appendChild(this.treeContainer),e.appendChild(this.container)},n.applyStyles=function(){var e=document.createElement("style");e.textContent="\n            .node-tree-header {\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                padding: 8px 12px;\n                border-bottom: 1px solid #444;\n                margin-bottom: 8px;\n            }\n\n            .node-tree-header h3 {\n                margin: 0;\n                font-size: 14px;\n                color: #fff;\n            }\n\n            .filter-container {\n                display: flex;\n                align-items: center;\n                gap: 4px;\n            }\n\n            .filter-input {\n                width: 120px;\n                height: 24px;\n                padding: 0 8px;\n                border: 1px solid #555;\n                border-radius: 3px;\n                background: #2d2d2d;\n                color: #fff;\n                font-size: 12px;\n                outline: none;\n            }\n\n            .filter-input:focus {\n                border-color: #0078d4;\n            }\n\n            .filter-input::placeholder {\n                color: #888;\n            }\n\n            .clear-button {\n                width: 24px;\n                height: 24px;\n                padding: 0;\n                border: 1px solid #555;\n                border-radius: 3px;\n                background: #2d2d2d;\n                color: #fff;\n                font-size: 14px;\n                cursor: pointer;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                transition: all 0.2s ease;\n            }\n\n            .clear-button:hover {\n                background: #3d3d3d;\n                border-color: #666;\n            }\n\n            .clear-button:active {\n                background: #1d1d1d;\n            }\n\n            .tree-container {\n                padding: 5px;\n            }\n\n            .tree-node {\n                margin: 2px 0;\n                user-select: none;\n            }\n\n            .tree-node-header {\n                display: flex;\n                align-items: center;\n                padding: 4px 8px;\n                cursor: pointer;\n                border-radius: 3px;\n                transition: background 0.2s ease;\n            }\n\n            .tree-node-header.inactive {\n                opacity: 0.5;\n            }\n\n            .tree-node-header.filtered {\n                background: #4a4a00;\n            }\n\n            .tree-node-header:hover {\n                background: #3d3d3d;\n            }\n\n            .tree-node-header.selected {\n                background: #0078d4;\n            }\n\n            .tree-node-header.filtered:hover {\n                background: #3d3d3d;\n            }\n\n            .tree-node-header.filtered.selected {\n                background: #0078d4;\n            }\n\n            .tree-node-expand {\n                width: 16px;\n                height: 16px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                margin-right: 4px;\n                font-size: 10px;\n                color: #ccc;\n                cursor: pointer;\n            }\n\n            .tree-node-expand.empty {\n                visibility: hidden;\n            }\n\n            .tree-node-name {\n                flex: 1;\n                font-size: 12px;\n                color: #fff;\n                overflow: hidden;\n                text-overflow: ellipsis;\n                white-space: nowrap;\n                text-align: left;\n            }\n\n            .tree-node-highlight {\n                width: 36px;\n                height: 20px;\n                margin-left: 4px;\n                padding: 0;\n                border: 1px solid #666;\n                border-radius: 3px;\n                background: #2d2d2d;\n                color: #fff;\n                font-size: 20px;\n                cursor: pointer;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                transition: all 0.2s ease;\n                flex-shrink: 0;\n                opacity: 0;\n                visibility: hidden;\n            }\n\n            .tree-node-header:hover .tree-node-highlight {\n                opacity: 1;\n                visibility: visible;\n            }\n\n            .tree-node-highlight:hover {\n                background: #3d3d3d;\n                border-color: #0078d4;\n            }\n\n            .tree-node-highlight:active {\n                background: #1d1d1d;\n            }\n\n            .tree-node-children {\n                margin-left: 10px;\n                border-left: 1px solid #444;\n                padding-left: 4px;\n            }\n\n            .tree-node-children.collapsed {\n                display: none;\n            }\n\n            .tree-empty {\n                padding: 20px;\n                text-align: center;\n                color: #888;\n                font-style: italic;\n            }\n        ",document.head.appendChild(e)},n.updateTree=function(e){if(this.treeContainer&&!this.isInteracting){this.allNodes=e;var n=this.calculateNodesHash(e);n!==this.lastNodesHash&&(this.lastNodesHash=n,this.renderTree())}},n.renderTree=function(){var e=this;if(this.treeContainer){this.treeContainer.innerHTML="";var n=this.filterText?this.getFilteredNodes():this.allNodes;if(0===n.length){var t=document.createElement("div");return t.className="tree-empty",t.textContent=this.filterText?"未找到匹配的节点":"未找到节点",void this.treeContainer.appendChild(t)}n.forEach((function(n){var t=e.createNodeElement(n,0);e.treeContainer&&e.treeContainer.appendChild(t)}))}},n.getFilteredNodes=function(){if(!this.filterText)return this.allNodes;var e=this.filterText.toLowerCase(),n=[],t=function n(t){var i=t.name.toLowerCase().includes(e),r=[];return t.children&&t.children.length>0&&t.children.forEach((function(e){var t=n(e);t&&r.push(t)})),i?Object.assign(Object.assign({},t),{children:t.children}):r.length>0?Object.assign(Object.assign({},t),{children:r}):null};return this.allNodes.forEach((function(e){var i=t(e);i&&n.push(i)})),n},n.applyFilter=function(){this.renderTree(),this.filterText&&this.expandFilteredNodes()},n.expandFilteredNodes=function(){var e=this,n=new Set,i=function t(i){i.name.toLowerCase().includes(e.filterText.toLowerCase())&&n.add(i.id),i.children&&i.children.length>0&&i.children.forEach((function(e){return t(e)}))};this.expandedNodes.clear();var r=function i(r){var o=!1;if(r.children&&r.children.length>0)for(var a,s=t(r.children);!(a=s()).done;){var l=a.value;n.has(l.id)&&(o=!0),i(l)&&(o=!0)}return o&&e.expandedNodes.add(r.id),o};this.allNodes.forEach((function(e){return i(e)})),this.allNodes.forEach((function(e){return r(e)})),this.renderTree()},n.clearFilter=function(){this.filterInput&&(this.filterInput.value="",this.filterText="",this.applyFilter())},n.calculateNodesHash=function(e){var n=[],t=function e(t){n.push(t.id+"|"+t.name+"|"+t.active),t.children&&t.children.length>0&&(n.push("children:"+t.children.length),t.children.forEach((function(n){return e(n)})))};return e.forEach((function(e){return t(e)})),n.join("#")},n.createNodeElement=function(e,n){var t=this,i=document.createElement("div");i.className="tree-node",i.dataset.nodeId=e.id;var r=document.createElement("div");r.className="tree-node-header",e.active||r.classList.add("inactive"),this.selectedNodeId===e.id&&r.classList.add("selected"),this.filterText&&e.name.toLowerCase().includes(this.filterText.toLowerCase())&&r.classList.add("filtered");var o=document.createElement("div");if(o.className="tree-node-expand",e.children.length>0){var a=this.expandedNodes.has(e.id);o.textContent=a?"▼":"▶",o.addEventListener("click",(function(n){n.stopPropagation(),t.handleNodeExpansion(e.id)}))}else o.classList.add("empty");var s=document.createElement("div");s.className="tree-node-name",s.textContent=e.name;var l=document.createElement("button");if(l.className="tree-node-highlight",l.textContent="🎯",l.title="显示包围盒",l.addEventListener("click",(function(n){n.stopPropagation(),t.handleNodeHighlight(e)})),r.appendChild(o),r.appendChild(s),r.appendChild(l),r.addEventListener("click",(function(n){n.target!==l&&t.handleNodeClick(e)})),i.appendChild(r),e.children.length>0){var c=document.createElement("div");c.className="tree-node-children",this.expandedNodes.has(e.id)||c.classList.add("collapsed"),e.children.forEach((function(e){var i=t.createNodeElement(e,n+1);c.appendChild(i)})),i.appendChild(c)}return i},n.handleNodeExpansion=function(e){var n=this;this.isInteracting=!0,this.toggleNodeExpansion(e),setTimeout((function(){n.isInteracting=!1}),200)},n.toggleNodeExpansion=function(e){var n;this.expandedNodes.has(e)?this.expandedNodes.delete(e):this.expandedNodes.add(e);var t=null===(n=this.treeContainer)||void 0===n?void 0:n.querySelector('[data-node-id="'+e+'"]');if(t){var i=t.querySelector(".tree-node-expand"),r=t.querySelector(".tree-node-children");if(i&&r){var o=this.expandedNodes.has(e);i.textContent=o?"▼":"▶",o?r.classList.remove("collapsed"):r.classList.add("collapsed")}}},n.handleNodeClick=function(e){var n=this;this.isInteracting=!0,this.selectNode(e),setTimeout((function(){n.isInteracting=!1}),200)},n.handleNodeHighlight=function(e){this.nodeHighlightCallback&&this.nodeHighlightCallback(e)},n.selectNode=function(e){var n,t;if(this.selectedNodeId){var i=null===(n=this.treeContainer)||void 0===n?void 0:n.querySelector('[data-node-id="'+this.selectedNodeId+'"] .tree-node-header');i&&i.classList.remove("selected")}this.selectedNodeId=e.id;var r=null===(t=this.treeContainer)||void 0===t?void 0:t.querySelector('[data-node-id="'+e.id+'"] .tree-node-header');r&&r.classList.add("selected"),this.nodeSelectCallback&&this.nodeSelectCallback(e)},n.onNodeSelect=function(e){this.nodeSelectCallback=e},n.onNodeHighlight=function(e){this.nodeHighlightCallback=e},e}(),p=function(){function e(){this.container=null,this.propertiesContainer=null,this.propertyChangeCallback=null,this.refreshNodeCallback=null,this.showTooltipCallback=null,this.currentNode=null,this.debugButton=null,this.refreshButton=null,this.header=null}var n=e.prototype;return n.create=function(e){this.createContainer(e),this.applyStyles()},n.createContainer=function(e){var n=this;this.container=document.createElement("div"),this.container.className="node-inspector-panel property-panel",this.header=document.createElement("h3"),this.header.className="property-panel-header",this.header.textContent="节点属性";var t=document.createElement("div");t.className="property-panel-buttons",this.refreshButton=document.createElement("button"),this.refreshButton.className="refresh-button",this.refreshButton.textContent="刷新",this.refreshButton.title="重新读取选中节点的属性",this.refreshButton.style.display="none",this.refreshButton.addEventListener("click",(function(){n.refreshNodeProperties()})),t.appendChild(this.refreshButton),this.debugButton=document.createElement("button"),this.debugButton.className="debug-output-button",this.debugButton.textContent="输出",this.debugButton.title="输出选中节点的路径和属性",this.debugButton.disabled=!0,this.debugButton.addEventListener("click",(function(){n.outputNodeDebugInfo()})),t.appendChild(this.debugButton),this.header.appendChild(t),this.container.appendChild(this.header),this.propertiesContainer=document.createElement("div"),this.propertiesContainer.className="properties-container",this.container.appendChild(this.propertiesContainer),e.appendChild(this.container),this.showEmptyState()},n.applyStyles=function(){var e=document.createElement("style");e.textContent='\n            .property-panel-header {\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                position: relative;\n            }\n\n            .property-panel-buttons {\n                display: flex;\n                align-items: center;\n                justify-content: flex-end;\n                gap: 4px;\n                height: 22px;\n            }\n\n            .refresh-button, .debug-output-button {\n                /* 重置所有默认样式 */\n                margin: 0;\n                padding: 0;\n                border: none;\n                outline: none;\n                background: none;\n                font-family: inherit;\n                font-size: 11px;\n                line-height: 1;\n                text-align: center;\n                color: white;\n                cursor: pointer;\n                transition: background-color 0.2s;\n                \n                /* 布局属性 */\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                box-sizing: border-box;\n                height: 22px;\n                border-radius: 3px;\n                \n                /* 去除浏览器默认样式 */\n                -webkit-appearance: none;\n                -moz-appearance: none;\n                appearance: none;\n                vertical-align: baseline;\n            }\n\n            .refresh-button {\n                background: #28a745;\n                width: 60px;\n            }\n\n            .refresh-button:hover {\n                background: #218838;\n            }\n\n            .debug-output-button {\n                background: #0078d4;\n                width: 30px;\n            }\n\n            .debug-output-button:hover:not(:disabled) {\n                background: #106ebe;\n            }\n\n            .debug-output-button:disabled {\n                background: #444;\n                cursor: not-allowed;\n                color: #888;\n            }\n\n            .properties-container {\n                padding: 8px;\n                overflow: visible;\n            }\n\n            .property-row {\n                display: flex;\n                align-items: center;\n                margin-bottom: 6px;\n                padding: 2px 0;\n            }\n\n            .property-label {\n                flex: 0 0 60px;\n                font-size: 11px;\n                color: #ccc;\n                margin-right: 6px;\n                text-align: right;\n            }\n\n            .property-input {\n                flex: 1;\n                background: #1e1e1e;\n                border: 1px solid #444;\n                border-radius: 3px;\n                padding: 3px 5px;\n                color: #fff;\n                font-size: 11px;\n                font-family: monospace;\n            }\n\n            .property-input:focus {\n                outline: none;\n                border-color: #0078d4;\n                box-shadow: 0 0 0 1px #0078d4;\n            }\n\n            .property-input[type="checkbox"] {\n                flex: none;\n                width: 16px;\n                height: 16px;\n                margin: 0;\n            }\n\n            .property-input[type="color"] {\n                flex: none;\n                width: 40px;\n                height: 22px;\n                padding: 0;\n                border: none;\n                border-radius: 3px;\n                cursor: pointer;\n            }\n\n            .property-empty {\n                padding: 15px;\n                text-align: center;\n                color: #888;\n                font-style: italic;\n                font-size: 12px;\n            }\n\n            .color-input-group {\n                display: flex;\n                align-items: center;\n                gap: 3px;\n            }\n\n            .color-input-group input[type="number"] {\n                width: 45px;\n            }\n        ',document.head.appendChild(e)},n.displayNodeProperties=function(e){var n=this;this.propertiesContainer&&(this.currentNode=e,this.propertiesContainer.innerHTML="",this.debugButton&&(this.debugButton.disabled=!1),this.refreshButton&&(this.refreshButton.style.display="inline-block"),[{key:"active",label:"激活",value:e.active,type:"boolean"},{key:"name",label:"名称",value:e.name,type:"string"},{key:"x",label:"X坐标",value:e.position.x,type:"number"},{key:"y",label:"Y坐标",value:e.position.y,type:"number"},{key:"anchorX",label:"锚点X",value:e.anchor.x,type:"number"},{key:"anchorY",label:"锚点Y",value:e.anchor.y,type:"number"},{key:"width",label:"宽度",value:e.size.width,type:"number"},{key:"height",label:"高度",value:e.size.height,type:"number"},{key:"scaleX",label:"X缩放",value:e.scale.x,type:"number"},{key:"scaleY",label:"Y缩放",value:e.scale.y,type:"number"},{key:"rotation",label:"旋转",value:e.rotation,type:"number"},{key:"opacity",label:"透明度",value:e.color.a,type:"number"}].forEach((function(e){var t=n.createPropertyRow(e.key,e.label,e.value,e.type);n.propertiesContainer.appendChild(t)})),this.createColorPropertyRows(e.color))},n.refreshNodeProperties=function(){if(this.currentNode)if(this.refreshNodeCallback)try{var e=this.refreshNodeCallback(this.currentNode);this.currentNode=e,this.displayNodeProperties(e),console.log("节点属性已刷新"),this.showTooltipCallback&&this.refreshButton&&this.showTooltipCallback("刷新完成",this.refreshButton)}catch(e){console.error("刷新节点属性失败:",e)}else console.warn("没有设置刷新回调函数");else console.warn("没有选中的节点")},n.outputNodeDebugInfo=function(){if(this.currentNode){var e=this.getNodePath(this.currentNode),n=this.getNodeProperties(this.currentNode);console.log("=== 节点调试信息 ==="),console.log("节点路径:",e),console.log("节点属性:",n),console.log("原始节点对象:",this.currentNode),console.log("=================="),this.showTooltipCallback&&this.debugButton&&this.showTooltipCallback("节点信息已输出到控制台",this.debugButton)}else console.warn("没有选中的节点")},n.getNodePath=function(e){var n=[],t=e;if(n.unshift(t.name),t.ccNode)try{for(var i=t.ccNode.parent,r=0;i&&r<20;){var o=this.getNodeName(i);n.unshift(o),i=i.parent,r++}}catch(e){console.warn("获取节点路径时出错:",e),n.unshift("[路径获取失败]")}return n.join("/")},n.getNodeName=function(e){var n,t;return e?e.name||e._name||(null===(n=e.node)||void 0===n?void 0:n.name)||"Node_"+((null===(t=e.uuid)||void 0===t?void 0:t.substring(0,8))||"Unknown"):"UnknownNode"},n.getNodeProperties=function(e){var n={"基本信息":{ID:e.id,"名称":e.name,"激活状态":e.active},"位置信息":{"坐标":"("+e.position.x+", "+e.position.y+")","锚点":"("+e.anchor.x+", "+e.anchor.y+")"},"尺寸信息":{"大小":e.size.width+" x "+e.size.height,"缩放":"("+e.scale.x+", "+e.scale.y+")"},"变换信息":{"旋转角度":e.rotation+"°"},"外观信息":{"颜色":"RGB("+e.color.r+", "+e.color.g+", "+e.color.b+")","透明度":e.color.a},"层级信息":{"子节点数量":e.children.length,"子节点":e.children.map((function(e){return e.name}))}};return e.ccNode&&(n.Creator信息=this.getCreatorSpecificInfo(e.ccNode)),n},n.getCreatorSpecificInfo=function(e){var n,t,i,r,o,a={"版本检测":this.detectCreatorVersion(),"节点类型":(null===(n=e.constructor)||void 0===n?void 0:n.name)||"Unknown"};try{if(void 0!==e.color)a.Creator版本="2.x",a.原始属性={uuid:e.uuid,x:e.x,y:e.y,width:e.width,height:e.height,scaleX:e.scaleX,scaleY:e.scaleY,angle:e.angle,opacity:e.opacity,anchorX:e.anchorX,anchorY:e.anchorY};else{a.Creator版本="3.x+";var s=null===(t=e.getComponent)||void 0===t?void 0:t.call(e,"cc.UITransform"),l=(null===(i=e.getComponent)||void 0===i?void 0:i.call(e,"cc.UIRenderer"))||(null===(r=e.getComponent)||void 0===r?void 0:r.call(e,"cc.Renderable2D"));a.原始属性={uuid:e.uuid,position:e.position,scale:e.scale,angle:e.angle},s&&(a.UITransform组件={width:s.width,height:s.height,anchorX:s.anchorX,anchorY:s.anchorY}),l&&(a.渲染组件={"类型":(null===(o=l.constructor)||void 0===o?void 0:o.name)||"Unknown","颜色":l.color})}a.父节点=e.parent?this.getNodeName(e.parent):"无",a.组件列表=this.getNodeComponents(e)}catch(e){a.错误="获取Creator信息时出错: "+(e instanceof Error?e.message:String(e))}return a},n.detectCreatorVersion=function(){try{var e=window.cc,n=(null==e?void 0:e.ENGINE_VERSION)||"未知";return n.startsWith("2.")?"Creator 2.x ("+n+")":n.startsWith("3.")?"Creator 3.x ("+n+")":n.startsWith("4.")?"Creator 4.x ("+n+")":"未知版本 ("+n+")"}catch(e){return"版本检测失败"}},n.getNodeComponents=function(e){try{return e._components&&Array.isArray(e._components)?e._components.map((function(e){var n;return(null===(n=e.constructor)||void 0===n?void 0:n.name)||e.__classname__||"Unknown"})):["组件信息不可用"]}catch(e){return["获取组件失败"]}},n.createColorPropertyRows=function(e){var n=this;if(this.propertiesContainer){var t=document.createElement("div");t.className="property-row";var i=document.createElement("div");i.className="property-label",i.textContent="RGB",t.appendChild(i);var r=document.createElement("div");r.className="color-input-group";var o=document.createElement("input");o.type="number",o.className="property-input",o.value=e.r.toString(),o.min="0",o.max="255",o.addEventListener("change",(function(){var e=Math.max(0,Math.min(255,Math.round(parseInt(o.value)||0)));o.value=e.toString(),n.handlePropertyChange("color.r",e)}));var a=document.createElement("input");a.type="number",a.className="property-input",a.value=e.g.toString(),a.min="0",a.max="255",a.addEventListener("change",(function(){var e=Math.max(0,Math.min(255,Math.round(parseInt(a.value)||0)));a.value=e.toString(),n.handlePropertyChange("color.g",e)}));var s=document.createElement("input");s.type="number",s.className="property-input",s.value=e.b.toString(),s.min="0",s.max="255",s.addEventListener("change",(function(){var e=Math.max(0,Math.min(255,Math.round(parseInt(s.value)||0)));s.value=e.toString(),n.handlePropertyChange("color.b",e)}));var l=document.createElement("input");l.type="color",l.className="property-input",l.value=this.rgbToHex(e.r,e.g,e.b),l.addEventListener("change",(function(){var e=n.hexToRgb(l.value);if(e){var t=Math.max(0,Math.min(255,Math.round(e.r))),i=Math.max(0,Math.min(255,Math.round(e.g))),r=Math.max(0,Math.min(255,Math.round(e.b)));o.value=t.toString(),a.value=i.toString(),s.value=r.toString(),n.handlePropertyChange("color.r",t),n.handlePropertyChange("color.g",i),n.handlePropertyChange("color.b",r)}})),r.appendChild(o),r.appendChild(a),r.appendChild(s),r.appendChild(l),t.appendChild(r),this.propertiesContainer.appendChild(t)}},n.createPropertyRow=function(e,n,t,i){var r=this,o=document.createElement("div");o.className="property-row";var a=document.createElement("div");a.className="property-label",a.textContent=n,o.appendChild(a);var s=document.createElement("input");switch(s.className="property-input",i){case"boolean":s.type="checkbox",s.checked=Boolean(t),s.addEventListener("change",(function(){r.handlePropertyChange(e,s.checked)}));break;case"number":s.type="number",s.value=t.toString(),s.step=e.includes("scale")?"0.1":"1","opacity"===e&&(s.min="0",s.max="255"),s.addEventListener("change",(function(){var n=parseFloat(s.value);"opacity"===e&&(n=Math.max(0,Math.min(255,Math.round(n))),s.value=n.toString()),r.handlePropertyChange(e,n)}));break;case"string":s.type="text",s.value=t.toString(),s.addEventListener("change",(function(){r.handlePropertyChange(e,s.value)}))}return o.appendChild(s),o},n.handlePropertyChange=function(e,n){this.propertyChangeCallback&&this.propertyChangeCallback(e,n)},n.showEmptyState=function(){if(this.propertiesContainer){this.currentNode=null,this.debugButton&&(this.debugButton.disabled=!0),this.refreshButton&&(this.refreshButton.style.display="none"),this.propertiesContainer.innerHTML="";var e=document.createElement("div");e.className="property-empty",e.textContent="请选择一个节点",this.propertiesContainer.appendChild(e)}},n.rgbToHex=function(e,n,t){return"#"+((1<<24)+(e<<16)+(n<<8)+t).toString(16).slice(1)},n.hexToRgb=function(e){var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null},n.onPropertyChange=function(e){this.propertyChangeCallback=e},n.onRefreshNode=function(e){this.refreshNodeCallback=e},n.onShowTooltip=function(e){this.showTooltipCallback=e},e}(),f=function(){function e(){}var n=e.prototype;return n.processChildren=function(e){var n=this,t=[];return e.children&&e.children.length>0&&e.children.forEach((function(e){t.push(n.convertCCNodeToNodeData(e))})),t},n.generateNodeId=function(e){if(e.uuid)return e.uuid;if(e._id)return e._id;this.nodeIdCache||(this.nodeIdCache=new WeakMap);var n=this.nodeIdCache.get(e);return n||(n=this.generateFallbackId(e),this.nodeIdCache.set(e,n)),n},n.generateFallbackId=function(e){var n=this.getNodePath(e);if(n)return"path_"+n;var t=e.name||"unknown",i=Math.floor(e.x||0),r=Math.floor(e.y||0);return this.nodeIdCounter||(this.nodeIdCounter=0),this.nodeIdCounter++,"node_"+t+"_"+i+"_"+r+"_"+this.nodeIdCounter},n.getNodePath=function(e){var n=[],t=e;try{for(;t&&t.parent;){var i=t.parent;if(i.children){var r=i.children.indexOf(t);r>=0&&n.unshift(r.toString())}t=i}return n.length>0?n.join("_"):null}catch(e){return null}},n.getNodeName=function(e){var n,t;return(null===(n=e.$gobj)||void 0===n?void 0:n.name)||(null===(t=e.$gobj)||void 0===t?void 0:t._name)||e.name||"未命名节点"},n.getNodeActive=function(e){return void 0===e.active||e.active},n.createDOMHighlight=function(e){try{var n=document.getElementById("node-inspector-highlight");n&&n.remove();var t=document.createElement("div");t.id="node-inspector-highlight",t.style.cssText="\n                position: fixed;\n                left: "+e.x+"px;\n                top: "+e.y+"px;\n                width: "+e.width+"px;\n                height: "+e.height+"px;\n                border: 4px solid #ffff00;\n                background: rgba(255, 255, 0, 0.65);\n                pointer-events: none;\n                z-index: 999999;\n                box-sizing: border-box;\n                border-radius: 4px;\n                animation: nodeInspectorHighlightBlink 1.5s ease-in-out forwards;\n            ",this.ensureHighlightStyles(),document.body.appendChild(t),setTimeout((function(){t&&t.parentNode&&t.remove()}),1500)}catch(e){console.error("创建DOM高亮层失败:",e)}},n.ensureHighlightStyles=function(){var e="node-inspector-highlight-styles";if(!document.getElementById(e)){var n=document.createElement("style");n.id=e,n.textContent="\n                @keyframes nodeInspectorHighlightBlink {\n                    0% { \n                        opacity: 1; \n                        transform: scale(1);\n                        box-shadow: 0 0 20px rgba(255, 255, 0, 0.8);\n                    }\n                    25% { \n                        opacity: 0.4; \n                        transform: scale(1.02);\n                        box-shadow: 0 0 30px rgba(255, 255, 0, 0.6);\n                    }\n                    50% { \n                        opacity: 1; \n                        transform: scale(1);\n                        box-shadow: 0 0 20px rgba(255, 255, 0, 0.8);\n                    }\n                    75% { \n                        opacity: 0.4; \n                        transform: scale(1.02);\n                        box-shadow: 0 0 30px rgba(255, 255, 0, 0.6);\n                    }\n                    100% { \n                        opacity: 0; \n                        transform: scale(1);\n                        box-shadow: 0 0 10px rgba(255, 255, 0, 0.3);\n                    }\n                }\n            ",document.head.appendChild(n)}},e}(),g=function(t){function i(){var e;e=t.call(this)||this,console.log("*********** 项目设置 ***********"),console.log("creator版本",(null===cc||void 0===cc?void 0:cc.ENGINE_VERSION)||"");var i=cc.game.canvas;if(!i)return void console.log("❌ 未找到GameCanvas元素")||n(e);var r=i.getBoundingClientRect(),o=cc.view.getDesignResolutionSize(),a=cc.view.getDevicePixelRatio();console.log("dom画布rect",r.x,r.y,r.width,r.height),console.log("设计尺寸",o.width,o.height),console.log("像素比",a);var s=cc.Canvas.instance;return s&&(s.fitWidth&&s.fitHeight?console.log("适配策略: 宽高适配"):s.fitHeight&&!s.fitWidth?console.log("适配策略: 高度适配"):!s.fitHeight&&s.fitWidth?console.log("适配策略: 宽度适配"):console.log("适配策略: 无适配")),console.log("********************************"),e}e(i,t);var r=i.prototype;return r.convertCCNodeToNodeData=function(e){return{id:this.generateNodeId(e),name:this.getNodeName(e),active:this.getNodeActive(e),position:{x:e.x||0,y:e.y||0},anchor:{x:e.anchorX||.5,y:e.anchorY||.5},size:{width:e.width||0,height:e.height||0},scale:{x:e.scaleX||1,y:e.scaleY||1},rotation:e.angle||0,color:{r:e.color.r||255,g:e.color.g||255,b:e.color.b||255,a:e.opacity||255},children:this.processChildren(e),ccNode:e}},r.updateNodeProperty=function(e,n,t){var i=e.ccNode;if(i)try{switch(n){case"active":i.active=Boolean(t);break;case"x":e.position.x=Number(t),i.setPosition(Number(t),e.position.y);break;case"y":e.position.y=Number(t),i.setPosition(e.position.x,Number(t));break;case"anchorX":e.anchor.x=Number(t),i.setAnchorPoint(Number(t),e.anchor.y);break;case"anchorY":e.anchor.y=Number(t),i.setAnchorPoint(e.anchor.x,Number(t));break;case"width":e.size.width=Number(t),i.setContentSize(Number(t),e.size.height);break;case"height":e.size.height=Number(t),i.setContentSize(e.size.width,Number(t));break;case"scaleX":e.scale.x=Number(t),i.setScale(Number(t),e.scale.y);break;case"scaleY":e.scale.y=Number(t),i.setScale(e.scale.x,Number(t));break;case"rotation":i.angle=Number(t);break;case"opacity":i.opacity=Number(t);break;case"color.r":e.color.r=Number(t),i.color=e.color;break;case"color.g":e.color.g=Number(t),i.color=e.color;break;case"color.b":e.color.b=Number(t),i.color=e.color}}catch(e){console.error("更新Creator 2.x节点属性失败:",e)}},r.getNodeScreenRect=function(e){try{var n=cc.Camera.findCamera(e)||cc.Camera.main;if(!n)return console.error("❌ 未找到节点专属摄像机"),null;var t=this.getNodeScreenAABB(e,n),i=this.getDomPosition(t.lt),r=this.getDomPosition(t.rb),o=Math.abs(i.x-r.x),a=Math.abs(i.y-r.y);return{x:i.x,y:Math.min(i.y,r.y),width:o,height:a}}catch(e){return console.error("获取Creator 2.x节点屏幕位置失败:",e),null}},r.getNodeScreenAABB=function(e,n){var t=e.getBoundingBoxToWorld();return{lt:n.getWorldToScreenPoint(cc.v2(t.x,t.y+t.height)),rb:n.getWorldToScreenPoint(cc.v2(t.x+t.width,t.y))}},r.getDomPosition=function(e){try{var n=cc.game.canvas;if(!n)return s.log("❌ 未找到GameCanvas元素"),{x:0,y:0};var t=n.getBoundingClientRect(),i=cc.view.getDesignResolutionSize(),r=cc.view.getDevicePixelRatio();s.log("像素比",r),s.log("dom画布rect",t.x,t.y,t.width,t.height),s.log("屏幕位置",e.x,e.y),s.log("设计尺寸",i.width,i.height);var o=t.width,a=t.height,l=0,c=0,d=cc.Canvas.instance;if(d)if(d.fitWidth&&d.fitHeight){var u=Math.min(o/i.width,a/i.height),h=.5*(o-i.width*u);l=t.x+h+e.x/i.width*(o-2*h);var p=.5*(a-i.height*u);c=t.y+a-p-e.y/i.height*(a-2*p)}else if(d.fitHeight&&!d.fitWidth){var f=a/i.height,g=.5*(o-i.width*f);l=t.x+e.x/i.width*(t.width-2*g);var m=.5*(a-i.height*f);c=t.y+a-m-e.y/i.height*(a-2*m)}else if(!d.fitHeight&&d.fitWidth){var y=o/i.width,b=.5*(o-i.width*y),v=.5*(a-i.height*y);l=t.x+b+e.x/i.width*(o-2*b),c=t.y+a-e.y/i.height*(a-2*v)}else{var x=Math.max(o/i.width,a/i.height),P=.5*(o-i.width*x),_=.5*(a-i.height*x);l=t.x+P+e.x/i.width*(o-2*P),c=t.y+a-e.y/i.height*(a-2*_)}return{x:l,y:c}}catch(e){return{x:0,y:0}}},i}(f),m=function(t){function i(){var e,i,r,o,a,s;e=t.call(this)||this,console.log("*********** 项目设置 ***********"),console.log("creator版本",(null===cc||void 0===cc?void 0:cc.ENGINE_VERSION)||"");var l=cc.game.canvas;if(!l)return void console.log("❌ 未找到GameCanvas元素")||n(e);var c=l.getBoundingClientRect(),d=cc.view.getDesignResolutionSize(),u=cc.screen.devicePixelRatio;console.log("dom画布rect",c.x,c.y,c.width,c.height),console.log("设计尺寸",d.width,d.height),console.log("像素比",u);var h=null===(s=null===(a=null===(o=null===(r=null===(i=cc.view)||void 0===i?void 0:i.getResolutionPolicy)||void 0===r?void 0:r.call(i))||void 0===o?void 0:o.getContentStrategy)||void 0===a?void 0:a.call(o))||void 0===s?void 0:s.strategy;return console.log("当前策略值=",h),h===cc.ResolutionPolicy.SHOW_ALL?console.log("适配策略: 宽高适配"):h===cc.ResolutionPolicy.FIXED_HEIGHT?console.log("适配策略: 高度适配"):h===cc.ResolutionPolicy.FIXED_WIDTH?console.log("适配策略: 宽度适配"):console.log("适配策略: 无适配"),console.log("********************************"),e}e(i,t);var r=i.prototype;return r.convertCCNodeToNodeData=function(e){var n=e.getComponent("cc.UITransform"),t=e.getComponent("cc.UIRenderer")||e.getComponent("cc.Renderable2D");return{id:this.generateNodeId(e),name:this.getNodeName(e),active:this.getNodeActive(e),position:{x:e.position.x||e.x||0,y:e.position.y||e.y||0},anchor:{x:(null==n?void 0:n.anchorX)||.5,y:(null==n?void 0:n.anchorY)||.5},size:{width:(null==n?void 0:n.width)||0,height:(null==n?void 0:n.height)||0},scale:{x:e.scale.x||1,y:e.scale.y||1},rotation:e.angle||0,color:t?{r:t.color.r||255,g:t.color.g||255,b:t.color.b||255,a:t.color.a||255}:{r:255,g:255,b:255,a:255},children:this.processChildren(e),ccNode:e}},r.updateNodeProperty=function(e,n,t){var i=e.ccNode;if(i)try{switch(n){case"active":i.active=Boolean(t);break;case"x":e.position.x=Number(t),i.setPosition(Number(t),e.position.y);break;case"y":e.position.y=Number(t),i.setPosition(e.position.x,Number(t));break;case"anchorX":e.anchor.x=Number(t);var r=i.getComponent("cc.UITransform");r&&r.setAnchorPoint(Number(t),e.anchor.y);break;case"anchorY":e.anchor.y=Number(t);var o=i.getComponent("cc.UITransform");o&&o.setAnchorPoint(e.anchor.x,Number(t));break;case"width":e.size.width=Number(t);var a=i.getComponent("cc.UITransform");a&&a.setContentSize(Number(t),e.size.height);break;case"height":e.size.height=Number(t);var s=i.getComponent("cc.UITransform");s&&s.setContentSize(e.size.width,Number(t));break;case"scaleX":e.scale.x=Number(t),i.setScale(Number(t),e.scale.y);break;case"scaleY":e.scale.y=Number(t),i.setScale(e.scale.x,Number(t));break;case"rotation":i.angle=Number(t);break;case"opacity":e.color.a=Number(t);var l=i.getComponent("cc.UIRenderer")||i.getComponent("cc.Renderable2D");l&&(l.color=e.color);break;case"color.r":e.color.r=Number(t);var c=i.getComponent("cc.UIRenderer")||i.getComponent("cc.Renderable2D");c&&(c.color=e.color);break;case"color.g":e.color.g=Number(t);var d=i.getComponent("cc.UIRenderer")||i.getComponent("cc.Renderable2D");d&&(d.color=e.color);break;case"color.b":e.color.b=Number(t);var u=i.getComponent("cc.UIRenderer")||i.getComponent("cc.Renderable2D");u&&(u.color=e.color)}}catch(e){console.error("更新Creator 3.x节点属性失败:",e)}},r.getNodeScreenRect=function(e){try{var n=this.findCamera(e);if(!n)return console.error("❌ 未找到节点专属摄像机"),null;var t=e.getComponent("cc.UITransform");if(!t)return null;var i=this.getNodeScreenAABB(t,n),r=this.getDomPosition(i.lt),o=this.getDomPosition(i.rb),a=Math.abs(r.x-o.x),s=Math.abs(r.y-o.y);return{x:r.x,y:Math.min(r.y,o.y),width:a,height:s}}catch(e){return console.error("获取Creator 3.x节点屏幕位置失败:",e),null}},r.findCamera=function(e){if(e.scene&&e.scene.renderScene)for(var n=e.scene.renderScene.cameras,t=0;t<n.length;t++){var i=n[t];if(i.visibility&e.layer)return i}return null},r.getScreenPosition=function(e,n){var t=e.convertToWorldSpaceAR(cc.v3(0,0,1));s.log("世界坐标 x:"+t.x+" y:"+t.y+" z:"+t.z);var i=cc.v3();return n.worldToScreen(i,t),s.log("屏幕坐标 x:"+i.x+" y:"+i.y+" z:"+i.z),i},r.getNodeScreenAABB=function(e,n){var t=e.getBoundingBoxToWorld();return{lt:n.worldToScreen(cc.v3(),cc.v3(t.x,t.y+t.height,0)),rb:n.worldToScreen(cc.v3(),cc.v3(t.x+t.width,t.y,0))}},r.getDomPosition=function(e){try{var n=cc.game.canvas;if(!n)return s.log("❌ 未找到GameCanvas元素"),{x:0,y:0};var t=n.getBoundingClientRect(),i=cc.view.getDesignResolutionSize(),r=cc.screen.devicePixelRatio;s.log("像素比",r),s.log("dom画布rect",t.x,t.y,t.width,t.height),s.log("屏幕位置",e.x,e.y),s.log("设计尺寸",i.width,i.height);return{x:t.x+e.x/r,y:t.y+t.height-e.y/r}}catch(e){return{x:0,y:0}}},i}(f),y=function(){function e(){this.selectedNode=null,this.nodeUpdateInterval=null,this.nodeTreePanel=new h,this.propertyPanel=new p,a()?this.calculator=new m:this.calculator=new g}var n=e.prototype;return n.initialize=function(e,n){this.createUI(e),this.bindEvents(),this.propertyPanel.onShowTooltip(n)},n.createUI=function(e){this.nodeTreePanel.create(e),this.propertyPanel.create(e)},n.bindEvents=function(){var e=this;this.nodeTreePanel.onNodeSelect((function(n){e.selectedNode=n,e.propertyPanel.displayNodeProperties(n)})),this.nodeTreePanel.onNodeHighlight((function(n){e.highlightNodeInScene(n)})),this.propertyPanel.onPropertyChange((function(n,t){e.selectedNode&&e.updateNodeProperty(e.selectedNode,n,t)})),this.propertyPanel.onRefreshNode((function(n){return n.ccNode?e.convertCCNodeToNodeData(n.ccNode):(console.warn("无法刷新节点：ccNode引用不存在"),n)}))},n.startNodeMonitoring=function(){var e=this;this.nodeUpdateInterval&&this.stopNodeMonitoring(),this.nodeUpdateInterval=window.setInterval((function(){e.updateNodeTree()}),150),console.log("节点监控已开始")},n.stopNodeMonitoring=function(){this.nodeUpdateInterval&&(clearInterval(this.nodeUpdateInterval),this.nodeUpdateInterval=null,console.log("节点监控已停止"))},n.updateNodeTree=function(){var e=this.getAllRootNodes();this.nodeTreePanel.updateTree(e)},n.getAllRootNodes=function(){var e,n=this,t=[];try{var i=null===(e=window.cc)||void 0===e?void 0:e.director;if(i){var r=i.getScene();r&&r.children&&r.children.length>0&&r.children.forEach((function(e){t.push(n.convertCCNodeToNodeData(e))}))}}catch(e){console.warn("无法获取Creator场景节点:",e)}return t},n.convertCCNodeToNodeData=function(e){return this.calculator.convertCCNodeToNodeData(e)},n.updateNodeProperty=function(e,n,t){if(e.ccNode)try{this.calculator.updateNodeProperty(e,n,t)}catch(e){console.error("更新节点属性失败:",e)}},n.highlightNodeInScene=function(e){var n=e.ccNode;if(n)if("undefined"!=typeof document)try{var t=this.calculator.getNodeScreenRect(n);if(!t)return void console.warn("无法获取节点屏幕位置");s.log("显示到dom上的rect",t.x,t.y,t.width,t.height),this.calculator.createDOMHighlight(t)}catch(e){console.error("高亮节点时出错:",e)}else console.warn("非浏览器环境，无法显示DOM高亮效果");else console.warn("无法高亮节点：ccNode引用不存在")},n.destroy=function(){this.stopNodeMonitoring()},e}(),b=function(){function e(){this.drawerUI=new o,this.rightDrawerUI=new u,this.resourceMemoryPanel=new d,this.nodeManager=new y}var n=e.prototype;return n.initialize=function(){this.createUI(),this.bindEvents()},n.createUI=function(){this.drawerUI.create(),this.rightDrawerUI.create();var e=this.rightDrawerUI.getContentContainer();this.resourceMemoryPanel.create(e);var n=this.drawerUI.getContentContainer();this.nodeManager.initialize(n,this.drawerUI.showTooltip.bind(this.drawerUI))},n.bindEvents=function(){var e=this;this.drawerUI.onToggle((function(n){e.handleDrawerToggle(n)})),this.rightDrawerUI.onToggle((function(n){e.handleRightDrawerToggle(n)}))},n.handleDrawerToggle=function(e){e?this.nodeManager.startNodeMonitoring():(this.nodeManager.stopNodeMonitoring(),this.drawerUI.resetWidth())},n.handleRightDrawerToggle=function(e){e?(this.resourceMemoryPanel.refreshData(),console.log("\x3c!----右侧抽屉已展开，资源内存监控已激活----\x3e")):(this.rightDrawerUI.resetWidth(),console.log("\x3c!----右侧抽屉已收起----\x3e"))},n.destroy=function(){this.nodeManager.destroy(),this.drawerUI.destroy(),this.rightDrawerUI.destroy(),this.resourceMemoryPanel.destroy()},e}();function v(){var e=new b;return e.initialize(),e}try{var x=function(){var e,n,t,i,r,o,s,l=!1,c=!1,d=!1;try{var u=window.cc;if(a())try{var h=null==u?void 0:u.env;h?(l=h.DEBUG||!1,c=h.EDITOR||!1):(l=(null==u?void 0:u.DEBUG)||window.DEBUG||window.CC_DEBUG||!1,c=(null==u?void 0:u.EDITOR)||window.EDITOR||window.CC_EDITOR||!1);var p=null===(e=window.cc)||void 0===e?void 0:e.sys;p&&(d=p.isBrowser||!1)}catch(e){l=window.DEBUG||!1,c=window.EDITOR||!1,d=(null===(t=null===(n=window.cc)||void 0===n?void 0:n.sys)||void 0===t?void 0:t.isBrowser)||!1}else l=window.CC_DEBUG||!1,c=window.CC_EDITOR||!1,d=(null===(r=null===(i=window.cc)||void 0===i?void 0:i.sys)||void 0===r?void 0:r.isBrowser)||!1}catch(e){console.warn("检测Creator环境变量失败:",e),l=window.DEBUG||window.CC_DEBUG||!1,c=window.EDITOR||window.CC_EDITOR||!1,d=(null===(s=null===(o=window.cc)||void 0===o?void 0:o.sys)||void 0===s?void 0:s.isBrowser)||!1}return{DEBUG:l,EDITOR:c,isBrowser:d}}(),P=x.DEBUG,_=x.EDITOR,C=x.isBrowser;P&&!_&&C&&(v(),console.log("Node Inspector已自动初始化"))}catch(r){console.warn("Node Inspector自动初始化失败，请手动调用 window?.initNodeInspector?.():",r)}window.initNodeInspector=v,i._RF.pop()}}}));

System.register("chunks:///_virtual/Loading.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts","./Utils.ts","./UIManager.ts","./ConfigManager.ts","./ProtoManager.ts","./GameData.ts"],(function(e){var n,r,t,a,o,i,c,s,u,l,p,f,d,g,h,v,w,b,x;return{setters:[function(e){n=e.applyDecoratedDescriptor,r=e.inheritsLoose,t=e.initializerDefineProperty,a=e.assertThisInitialized,o=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){c=e.cclegacy,s=e._decorator,u=e.ProgressBar,l=e.Label,p=e.director,f=e.Component,d=e.log},function(e){g=e.AudioManager},function(e){h=e.default},function(e){v=e.default},function(e){w=e.default},function(e){b=e.ProtoManager},function(e){x=e.GameData}],execute:function(){var m,y,k,S,L,D,M;c._RF.push({},"5b5ddpAHnNNF7PRNKlrnmNu","Loading",void 0);var P=s.ccclass,B=s.property;e("Loading",(m=P("Loading"),y=B(u),k=B(l),m((D=n((L=function(e){function n(){for(var n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,t(n,"loadingBar",D,a(n)),t(n,"loadingLabel",M,a(n)),n.dataSuccess=!1,n}r(n,e);var c=n.prototype;return c.start=function(){var e=o(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=p.getScene().getChildByName("__cutscene__"),p.addPersistRootNode(n),g.init(),this.loadingBar.progress=0,p.preloadScene("hall"),this.loadData(),this.loadSecne();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.loadData=function(){var e=o(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d("loading[onLoad]"),e.next=3,this.initWebSocket();case 3:return d("loading[onLoaded]"),e.next=6,this.loadConfig();case 6:return d("Reading user data..."),e.next=9,this.loadUserData();case 9:g.playMusic(),this.dataSuccess=!0;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.initWebSocket=function(){var e=o(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(o(i().mark((function e(n,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.init(1001);case 3:n(),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("WebSocket初始化失败:",e.t0),r(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c.loadConfig=function(){var e=o(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(o(i().mark((function e(n,r){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.load();case 2:if(!(t=e.sent).code){e.next=7;break}return v.showTip("加载配置表失败，正在重新尝试！"),e.next=7,h.wait(3e3);case 7:if(t.code){e.next=0;break}case 8:n(t);case 9:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c.loadUserData=function(){var e=o(i().mark((function e(){var n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1;case 1:return e.prev=1,e.next=4,x.load();case 4:r=e.sent,console.log("用户数据加载成功:",r),n=!1,e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(1),console.error("加载游戏数据失败:",e.t0),n=!0,e.next=15,h.wait(3e3);case 15:if(n){e.next=1;break}case 16:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),c.loadSecne=function(){var e=o(i().mark((function e(){var n=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d("Loading game resources..."),p.preloadScene("game",(function(e,r,t){n.loadingBar.progress=e/r,n.loadingLabel.string=Math.floor(100*n.loadingBar.progress)+"%"}),(function(e,n){if(e)return console.error("加载失败",e);d("加载场景成功",n),p.loadScene("hall")}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c.onToggleScene=function(){this.dataSuccess?p.loadScene("hall"):v.showTip("正在加载游戏数据请稍等～")},n}(f)).prototype,"loadingBar",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=n(L.prototype,"loadingLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=L))||S));c._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./kunpo-inspector.min.mjs","./BaseView.ts","./GameData.ts","./GameDefined.ts","./Utils.ts","./AccountLabel.ts","./Audio.ts","./AudioButton.ts","./CutsceneAnim.ts","./MuteButton.ts","./Base.ts","./Boss.ts","./Bullet.ts","./Chapter.ts","./Game.ts","./GameView.ts","./Role.ts","./RoleListItem.ts","./Skill.ts","./Hall.ts","./Loading.ts","./AudioManager.ts","./ConfigManager.ts","./EventManager.ts","./UIManager.ts","./BalanceView.ts","./TimeoutView.ts","./ProtoManager.ts","./Protocol.ts","./WebSocket.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MuteButton.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts","./GameData.ts"],(function(t){var e,n,o,i,r,u,a,c,s,l,p,f,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,u=t._decorator,a=t.SpriteFrame,c=t.Node,s=t.Sprite,l=t.Button},function(t){p=t.AudioManager,f=t.AudioType},function(t){h=t.GameData}],execute:function(){var m,d,g,y,M,I,v;r._RF.push({},"34eaeJ5RMRE04vjP6ZsJhRz","MuteButton",void 0);var b=u.ccclass,O=u.property;t("MuteButton",(m=b("MuteButton"),d=O(a),g=O(a),m((I=e((M=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];return(e=t.call.apply(t,[this].concat(r))||this)._transition=3,o(e,"muteOnIcon",I,i(e)),o(e,"muteOffIcon",v,i(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){this.updateIcon()},r.start=function(){this.node.on(c.EventType.TOUCH_END,this.onMuteToggle,this)},r.onMuteToggle=function(){p.play(f.click),p.toggleMusic(),this.updateIcon()},r.updateIcon=function(){h.mute?this.node.getComponent(s).spriteFrame=this.muteOffIcon:this.node.getComponent(s).spriteFrame=this.muteOnIcon},e}(l)).prototype,"muteOnIcon",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=e(M.prototype,"muteOffIcon",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=M))||y));r._RF.pop()}}}));

System.register("chunks:///_virtual/Protocol.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"3ba90ZkIXRJSJclIgpJvvqa","Protocol",void 0);e("CmdId",function(e){return e[e.Default=0]="Default",e[e.Ping=1e3]="Ping",e[e.GetUserInfo=1001]="GetUserInfo",e[e.StartGame=1002]="StartGame",e[e.StartBattle=1003]="StartBattle",e[e.UpdateCharacterDie=1004]="UpdateCharacterDie",e[e.GameResult=1005]="GameResult",e[e.EventOnReconnect=20001]="EventOnReconnect",e[e.EventServerReady=20002]="EventServerReady",e}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/ProtoManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./Protocol.ts","./WebSocket.ts","./GameData.ts","./index.js"],(function(e){var t,r,n,o,a,s,c,i,u,p,d,l;return{setters:[function(e){t=e.createForOfIteratorHelperLoose,r=e.asyncToGenerator,n=e.regeneratorRuntime,o=e.createClass},function(e){a=e.cclegacy,s=e.resources,c=e.TextAsset},null,function(e){i=e.CmdId},function(e){u=e.WebSocketManager,p=e.WebSocketEventType},function(e){d=e.GameData},function(e){l=e.default}],execute:function(){var f;a._RF.push({},"16d43YluTlCn6orbLXKerNo","ProtoManager",void 0);var m=function(){function e(){this.ws=null,this.root=new l.Root,this.proto=void 0,this.pingMessage=void 0}var a=e.prototype;return a.init=function(){var e=r(n().mark((function e(t){var o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(r(n().mark((function e(r,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.initProto();case 3:return e.next=5,o.initWebSocket(t);case 5:o.ws.on(p.BROADCAST,o.onBroadcastMessage.bind(o)),r(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),a(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.initProto=function(){var e=this;return new Promise((function(r,n){s.loadDir("proto",c,(function(o,a){if(o)n(o);else{for(var s,c=t(a);!(s=c()).done;){var i=s.value,u=i.name,p=i.text;try{l.parse(p,e.root,{keepCase:!0,alternateCommentMode:!0}),console.log("Parsed proto: "+u)}catch(e){console.error("Error parsing "+u+":",e)}}e.proto={message:e.root.lookupType("cmd.BaseCmd"),serverReady:e.root.lookupType("cmd.EventServerReady"),ping:e.root.lookupType("cmd.ReqPing"),EventOnReconnect:e.root.lookupType("cmd.EventOnReconnect"),ReqGetUserInfo:e.root.lookupType("cmd.ReqGetUserInfo"),RespUserInfo:e.root.lookupType("cmd.RetGetUserInfo"),ReqStartGame:e.root.lookupType("cmd.ReqStartGame"),RespStartGame:e.root.lookupType("cmd.RetStartGame"),ReqStartBattle:e.root.lookupType("cmd.ReqStartBattle"),RespStartBattle:e.root.lookupType("cmd.RetStartBattle"),ReqUpdateCharacterDie:e.root.lookupType("cmd.ReqUpdateCharacterDie"),RespUpdateCharacterDie:e.root.lookupType("cmd.RetUpdateCharacterDie"),ReqGameResult:e.root.lookupType("cmd.ReqGameResult"),RespGameResult:e.root.lookupType("cmd.RetGameResult")},r()}}))}))},a.initWebSocket=function(e){var t=this;return new Promise(r(n().mark((function e(r,o){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.pingMessage=t.proto.ping.encode(t.proto.ping.create({})).finish(),a=new u({url:"wss://api.hm2010.org/proxy/metalSlugW?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIsImxvZ2luVGltZSI6MTc1MzQ0NTQ4MiwidmVyIjo0OSwiaWF0IjoxNzUzNDQ1NDgyLCJleHAiOjE3Njg5OTc0ODJ9.7ZSAvMmu-lGm8N63URI3MAj1EEMnc4vAnUAf564emqM&currency=IDR",ping:t.pingMessage},t.encodeMessage.bind(t),t.decodeMessage.bind(t)),e.prev=2,a.on(p.BROADCAST,(function(e){if(e.CmdId==i.EventServerReady){var n=t.proto.serverReady.decode(e.Data),o=t.proto.serverReady.toObject(n);console.log("Server Ready Event:",o),a.off(p.ERROR),r()}})),e.next=6,a.connect();case 6:t.ws=a,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),o(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])}))))},a.encodeMessage=function(e,t,r){void 0===r&&(r=0);var n={CmdId:e,Data:t,ReqId:r},o=this.proto.message.create(n);return this.proto.message.encode(o).finish()},a.decodeMessage=function(e){var t=this.proto.message.decode(e);return this.proto.message.toObject(t)},a.onBroadcastMessage=function(e){switch(e.CmdId){case i.EventOnReconnect:console.log("Received reconnect event, disconnecting..."),this.ws.disconnect()}},a.request=function(e,t,o,a,s){var c=this;return void 0===s&&(s=!0),new Promise(r(n().mark((function r(i,u){var p,l,f,m,h;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,p=t.create(a),l=t.encode(p).finish(),r.next=5,c.ws.send(e,l,s);case 5:if(f=r.sent,s){r.next=9;break}return i(void 0),r.abrupt("return");case 9:if(f){r.next=12;break}return u(new Error("请求失败，未收到响应")),r.abrupt("return");case 12:m=o.decode(f),(h=o.toObject(m)).balance&&d.updateBalance(h.balance),console.log("Response: ",h),i(h),r.next=22;break;case 19:r.prev=19,r.t0=r.catch(0),u(r.t0);case 22:case"end":return r.stop()}}),r,null,[[0,19]])}))))},a.getUserInfo=function(){var e=r(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request(i.GetUserInfo,this.proto.ReqGetUserInfo,this.proto.RespUserInfo,{}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.startGame=function(){var e=r(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request(i.StartGame,this.proto.ReqStartGame,this.proto.RespStartGame,{difficultyId:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),a.startBattle=function(){var e=r(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request(i.StartBattle,this.proto.ReqStartBattle,this.proto.RespStartBattle,{id:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),a.updateRoleDie=function(){var e=r(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request(i.UpdateCharacterDie,this.proto.ReqUpdateCharacterDie,this.proto.RespUpdateCharacterDie,{id:t},!1));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),a.updateGameResult=function(){var e=r(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request(i.GameResult,this.proto.ReqGameResult,this.proto.RespGameResult,{win:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o(e,null,[{key:"Instance",get:function(){return e._instance}}]),e}();f=m,m._instance=new f;e("ProtoManager",m.Instance);a._RF.pop()}}}));

System.register("chunks:///_virtual/Role.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigManager.ts","./Utils.ts","./Bullet.ts","./EventManager.ts","./AudioManager.ts","./Skill.ts","./ProtoManager.ts","./GameData.ts"],(function(t){var i,e,s,n,o,a,h,l,r,d,c,u,p,f,g,m,v,C,D,b,k,A,y,R,P,S,w;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,s=t.initializerDefineProperty,n=t.assertThisInitialized,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){h=t.cclegacy,l=t._decorator,r=t.Prefab,d=t.sp,c=t.BoxCollider2D,u=t.Contact2DType,p=t.tween,f=t.Vec3,g=t.instantiate,m=t.Component,v=t.UITransform},function(t){C=t.default},function(t){D=t.default},function(t){b=t.Bullet},function(t){k=t.EventType,A=t.default},function(t){y=t.AudioManager,R=t.AudioType},function(t){P=t.Skill},function(t){S=t.ProtoManager},function(t){w=t.GameData}],execute:function(){var E,M,x,T,B,_,I;h._RF.push({},"1d12748JnFEmYjxUiJ9KY5P","Role",void 0);var G=l.ccclass,L=l.property,W=function(t){return t.dao="dao",t.hit="hit1",t.dead="hit2",t.idle="idle",t.run="run",t.shoot1="shoot1",t.shoot2="shoot2",t.stand="stand",t.win="win",t}(W||{}),O=function(t){return t[t.ready=0]="ready",t[t.idle=1]="idle",t[t.attack=2]="attack",t[t.hit=3]="hit",t[t.dead=4]="dead",t}(O||{});t("Role",(E=G("Role"),M=L(r),x=L(r),E((_=i((B=function(t){function i(){for(var i,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return i=t.call.apply(t,[this].concat(o))||this,s(i,"bulletPrefab",_,n(i)),s(i,"skillPrefab",I,n(i)),i.roleType=void 0,i.config=void 0,i.spine=void 0,i.boss=void 0,i.meleeRange=void 0,i.shootRange=void 0,i.skillRange=void 0,i.roleWidth=void 0,i.bossWidth=void 0,i.isDead=!1,i.status=void 0,i.hp=void 0,i.meleeCD=void 0,i.shootCD=void 0,i.skillCD=void 0,i.skillClip=void 0,i}e(i,t);var h=i.prototype;return h.onLoad=function(){this.spine=this.getComponent(d.Skeleton)},h.init=function(){var t=o(a().mark((function t(i,e){var s=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.roleType=i,this.status=O.ready,this.config=C.getRoleConfig(i),this.boss=e,this.hp=this.config.hp,this.meleeRange=this.config.mRange/10*C.MAX_RANGE,this.shootRange=this.config.rRange/10*C.MAX_RANGE,this.skillRange=this.config.sRange/10*C.MAX_RANGE,this.skillClip=this.config.sAmount,this.meleeCD=this.config.mSpeed,this.shootCD=this.config.rSpeed,this.skillCD=this.config.sCD,this.scheduleOnce((function(){return s.shootCD=0}),this.config.rSpeed),this.scheduleOnce((function(){return s.skillCD=0}),this.config.sCD),this.roleWidth=this.node.getComponent(v).width,this.bossWidth=this.boss.getComponent(v).width;case 16:case"end":return t.stop()}}),t,this)})));return function(i,e){return t.apply(this,arguments)}}(),h.start=function(){this.getComponent(c).on(u.BEGIN_CONTACT,this.onBeginContact,this),this.spine.setEventListener(this.onSpineEvent.bind(this)),this.node.on(k.melee,this.onMeleeEvent,this),A.Instance.add(k.boss_dead,this.onBossDeadEvent,this),this.moveToFront()},h.moveToFront=function(){var t=this,i=Math.min(160,this.boss.x-this.bossWidth/2-this.roleWidth/2),e=Math.max(this.node.x,i-100),s=D.random(e,i),n=.03*(s-this.node.x);p(this.node).delay(.3).call((function(){t.spine.setAnimation(0,W.run,!0)})).to(n,{position:new f(s)}).call((function(){t.spine.setAnimation(0,W.stand,!0),t.status=O.idle,t.boss.emit(k.role_enter,t.roleType,t.node)})).start()},h.onBeginContact=function(t,i){if(this.status!==O.dead){var e=i.node.getComponent(P).getDamage(),s=e[0],n=e[1];this.hit(s,n)}},h.onMeleeEvent=function(t){this.status!==O.dead&&this.hit(t,!1)},h.hit=function(t,i){var e=this;this.isDead||(this.hp-=t,this.hp<=0&&this.roleDead(),this.hp>0&&this.status!==O.hit&&(this.status=O.hit,this.spine.setCompleteListener((function(){e.status=O.idle,e.spine.setAnimation(0,W.stand,!0)})),this.spine.setAnimation(0,W.hit,!1)),A.Instance.emit(k.show_damage,t,i,this.node))},h.roleDead=function(){var t=this;this.isDead=!0,this.status=O.dead,A.Instance.emit(k.role_dead,this.roleType),this.spine.unscheduleAllCallbacks(),this.unscheduleAllCallbacks(),this.node.off(k.melee),this.spine.setAnimation(0,W.dead,!1),this.spine.setCompleteListener((function(){A.Instance.remove(k.boss_dead,t.onBossDeadEvent,t),t.scheduleOnce((function(){t.node.parent=null,t.node.destroy()}),.5)})),w.isGuide||S.updateRoleDie(this.config.id).catch((function(t){console.error("更新角色死亡状态失败",t)}))},h.onBossDeadEvent=function(){this.enabled=!1,this.spine.setAnimation(0,W.win,!0)},h.onSpineEvent=function(t,i){switch(t.animation.name){case W.dao:this.boss.emit(k.melee,this.config.mDPS);break;case W.shoot1:this.createBullet(!1);break;case W.shoot2:this.createBullet(!0)}},h.createBullet=function(t){var i;t?((i=g(this.skillPrefab)).position=new f(this.node.x+this.config.skillPos[0],this.node.y+this.config.skillPos[1]),y.play(R.rocket,.5)):((i=g(this.bulletPrefab)).position=new f(this.node.x+this.config.shootPos[0],this.node.y+this.config.shootPos[1]),y.play(R.shoot)),i.setSiblingIndex(this.node.getSiblingIndex()-1),i.getComponent(b).init(this.config.rDPS,this.config.rHit),i.parent=this.node.parent},h.play=function(){if(0!==arguments.length){this.spine.setAnimation(0,arguments.length<=0?void 0:arguments[0],!1);for(var t=1;t<arguments.length;t++)this.spine.addAnimation(0,t<0||arguments.length<=t?void 0:arguments[t],!1);this.spine.addAnimation(0,W.stand,!0)}},h.playAttackAnim=function(t){var i=this;this.status=O.attack,this.spine.setCompleteListener((function(){i.status=O.idle,i.spine.setCompleteListener(null),i.spine.setAnimation(0,W.stand,!0)})),this.spine.setAnimation(0,t,!1)},h.update=function(t){var i=this;if(this.status===O.idle&&!this.isDead){var e=Math.abs(this.boss.x-this.bossWidth/2-(this.node.x+this.roleWidth/2));return this.skillCD<=0&&e<=this.skillRange?(this.skillClip--,this.skillClip<=0&&(this.skillClip=this.config.sAmount,this.skillCD=this.config.sCD,this.scheduleOnce((function(){return i.skillCD=0}),this.config.sCD)),void this.playAttackAnim(W.shoot2)):this.shootCD<=0&&e<=this.shootRange?(this.shootCD=this.config.rSpeed,this.scheduleOnce((function(){return i.shootCD=0}),this.config.rSpeed),void this.playAttackAnim(W.shoot1)):void(this.meleeCD<=0&&e<=this.meleeRange&&(this.meleeCD=this.config.mSpeed,this.scheduleOnce((function(){return i.meleeCD=0}),this.config.mSpeed),this.playAttackAnim(W.dao)))}},i}(m)).prototype,"bulletPrefab",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=i(B.prototype,"skillPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=B))||T));h._RF.pop()}}}));

System.register("chunks:///_virtual/RoleListItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameDefined.ts","./EventManager.ts","./ConfigManager.ts"],(function(t){var e,i,n,o,a,s,r,l,u,c,f,p,h,d,g,b,y,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized,a=t.createClass},function(t){s=t.cclegacy,r=t._decorator,l=t.Enum,u=t.Sprite,c=t.SpriteFrame,f=t.UITransform,p=t.Button,h=t.tween,d=t.Component},function(t){g=t.RoleType},function(t){b=t.default,y=t.EventType},function(t){m=t.default}],execute:function(){var v,L,R,I,M,T,z,F,O,k,w,C,D;s._RF.push({},"5ac883ix+VMiKb0lazPE5co","RoleListItem",void 0);var E=r.ccclass,_=r.property;t("RoleListItem",(v=E("RoleListItem"),L=_({type:l(g)}),R=_(u),I=_(c),M=_(c),T=_(f),v((O=e((F=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,n(e,"roleType",O,o(e)),n(e,"statusLabel",k,o(e)),n(e,"statusOn",w,o(e)),n(e,"statusOff",C,o(e)),n(e,"cdMask",D,o(e)),e.config=void 0,e}i(e,t);var s=e.prototype;return s.onLoad=function(){this.cdMask.height=0,this.config=m.getRoleConfig(this.roleType)},s.start=function(){b.Instance.add(y.role_dead,this.onRoleDeadEvent,this),b.Instance.add(y.init_role,this.onInitRole,this)},s.onInitRole=function(t){t===this.roleType&&(this.statusLabel.spriteFrame=this.statusOn)},s.onRoleDeadEvent=function(t){this.roleType===t&&(this.statusLabel.spriteFrame=this.statusOff)},s.toggleFight=function(){var t=this;this.statusLabel.spriteFrame=this.statusOn,this.cdMask.height=90,this.scheduleOnce((function(){t.node.getComponent(p).enabled=!1}),.1),h(this.cdMask).to(this.config.sendCD,{height:0}).call((function(){t.node.getComponent(p).enabled=!0})).start()},s.getFee=function(){return this.config.fee},a(e,[{key:"id",get:function(){return this.config.id}}]),e}(d)).prototype,"roleType",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=e(F.prototype,"statusLabel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=e(F.prototype,"statusOn",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=e(F.prototype,"statusOff",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=e(F.prototype,"cdMask",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=F))||z));s._RF.pop()}}}));

System.register("chunks:///_virtual/Skill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Utils.ts","./ConfigManager.ts"],(function(t){var n,o,i,e,s,r,c,a,h,l,u;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator,e=t.Vec3,s=t.sp,r=t.tween,c=t.BoxCollider2D,a=t.Contact2DType,h=t.Component},function(t){l=t.default},function(t){u=t.default}],execute:function(){var d;o._RF.push({},"e7c87x+arJOArRzQzpyCV8f","Skill",void 0);var p=i.ccclass;i.property,t("Skill",p("Skill")(d=function(t){function o(){for(var n,o=arguments.length,i=new Array(o),e=0;e<o;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).spine=void 0,n.isBoom=void 0,n.dps=void 0,n.hit=void 0,n}n(o,t);var i=o.prototype;return i.init=function(t,n){this.dps=t,this.hit=n,this.node.scale=new e(0,0,1),this.isBoom=!1},i.onLoad=function(){this.spine=this.getComponent(s.Skeleton)},i.start=function(){r(this.node).to(.1,{scale:new e(1,1,1)}).start(),this.getComponent(c).once(a.BEGIN_CONTACT,this.onBeginContact,this)},i.getDamage=function(){var t=l.random(0,1e3)<=this.hit;return[t?2*this.dps:this.dps,t]},i.onBeginContact=function(t,n){this.isBoom=!0,this.node.destroy()},i.update=function(t){this.isBoom||(this.node.x-=u.ATTACK_MOVE_SPEED*t,Math.abs(this.node.x)>390&&this.node.destroy())},o}(h))||d);o._RF.pop()}}}));

System.register("chunks:///_virtual/TimeoutView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseView.ts"],(function(e){var t,o,i,n,c;return{setters:[function(e){t=e.inheritsLoose},function(e){o=e.cclegacy,i=e._decorator,n=e.director},function(e){c=e.default}],execute:function(){var r,u;o._RF.push({},"bd161c5T1NCNogY39fP/gUz","TimeoutView",void 0);var s=i.ccclass;i.property,e("TimeoutView",s("TimeoutView")(((u=function(e){function o(){return e.apply(this,arguments)||this}return t(o,e),o.prototype.onBackHall=function(){n.loadScene("hall")},o}(c)).PREFAB_NAME="timeout",r=u))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/UIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseView.ts","./Utils.ts","./CutsceneAnim.ts"],(function(e){var t,n,r,a,i,s,o,c,u,p,l,f;return{setters:[function(e){t=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){r=e.cclegacy,a=e.director,i=e.Widget,s=e.tween,o=e.Vec3,c=e.UIOpacity,u=e.Label},function(e){p=e.default},function(e){l=e.default},function(e){f=e.CutsceneAnim}],execute:function(){r._RF.push({},"898e5z+JQhNp4srNMH9e2Vf","UIManager",void 0),e("default",function(){function e(){}return e.open=function(){var e=t(n().mark((function e(t){var r,u,p,f,h,g;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.getUI(t.URL)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,l.loadPrefab(t.URL);case 4:if((r=e.sent)&&!this.getUI(t.URL)){e.next=7;break}return e.abrupt("return");case 7:return a.getScene().children[0].addChild(r),(u=r.getComponent(t)).tag=t.URL,this.panelList.push(u),u.openAnim&&(p=r.getChildByName("background"),(f=r.getChildByName("content"))&&(f.getComponent(i)&&f.getComponent(i).updateAlignment(),f.setScale(0,0),s(f).delay(.02).to(.3,{scale:new o(1,1,1)},{easing:"backOut"}).start()),p&&(h=p.getComponent(c),g=h.opacity,h.opacity=0,s(h).to(.3,{opacity:g}).start())),e.abrupt("return",u);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e.waitOpen=function(r){for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];return new Promise(t(n().mark((function t(a,s){var o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.open(r);case 2:(o=t.sent)._closeCallBack=a,o.init.apply(o,i);case 5:case"end":return t.stop()}}),t)}))))},e.openPrefab=function(){var e=t(n().mark((function e(t){var r,i,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="view/"+t,e.next=3,l.loadPrefab(r);case 3:if(i=e.sent,s=i.getComponent(p),i&&!this.getUI(r)){e.next=7;break}return e.abrupt("return");case 7:a.getScene().addChild(i),s.tag=r,this.panelList.push(s);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e.getUI=function(e){for(var t=null,n=0;n<this.panelList.length;++n)if(this.panelList[n].tag===e){t=this.panelList[n];break}return t},e.close=function(e){for(var t=0;t<this.panelList.length;++t){if(e instanceof p){if(this.panelList[t]!==e)continue}else if(this.panelList[t].tag!==e.URL)continue;this.panelList[t].node.destroy(),this.panelList.splice(t,1);break}},e.showTip=function(){var e=t(n().mark((function e(t,r){var i,o,p;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=1),i=a.getScene().getChildByName("Canvas"),e.next=4,l.loadPrefab("tip/tip");case 4:o=e.sent,o.getComponentInChildren(u).string=t,o.setSiblingIndex(1e3),i.addChild(o),(p=o.getComponent(c)).opacity=0,s(o).then(s(p).to(.2,{opacity:255})).delay(r).parallel(s(p).to(.2,{opacity:0}),s(o).by(.2,{y:30})).destroySelf().start();case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.playCutsceneAnim=function(e){a.getScene().getChildByName("__cutscene__").getComponent(f).playCutsceneAnim(e)},e}()).panelList=[],r._RF.pop()}}}));

System.register("chunks:///_virtual/Utils.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,r,e,o,a,i,u,c,s,f,l,p,d;return{setters:[function(n){t=n.asyncToGenerator,r=n.regeneratorRuntime},function(n){e=n.cclegacy,o=n.isValid,a=n.Node,i=n.Animation,u=n.sys,c=n.resources,s=n.Prefab,f=n.instantiate,l=n.warn,p=n.sp,d=n.SpriteFrame}],execute:function(){e._RF.push({},"71d2dKJhvxNRqVr80BE5Qwt","Utils",void 0);n("default",function(){function n(){}return n.random=function(n,t){return Math.floor(Math.random()*(t-n+1)+n)},n.randOneList=function(n){return n[this.random(0,n.length-1)]},n.toTimeStr=function(n){var t=Math.floor(n/60)+"",r=Math.floor(n%60)+"";return(t=1===t.length?"0"+t:t)+" : "+(r=1===r.length?"0"+r:r)},n.clone=function(n){return JSON.parse(JSON.stringify(n))},n.wait=function(n){return void 0===n&&(n=1e3),new Promise((function(t,r){setTimeout((function(){t()}),n)}))},n.loadPrefab=function(){var n=t(r().mark((function n(t){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){var e=c.get(t,s);if(e){var o=f(e);n(o)}else c.load(t,s,(function(e,o){if(e)return l("loadPrefab error:"+t),void r(e);var a=f(o);n(a)}))})));case 1:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),n.loadSpine=function(){var n=t(r().mark((function n(t){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){var e=c.get("spine/"+t,p.SkeletonData);e?n(e):c.load("spine/"+t,p.SkeletonData,(function(e,o){if(e)return l("loadSpine error:spine/"+t),void r(e);n(o)}))})));case 1:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),n.loadSpriteFrame=function(){var n=t(r().mark((function n(t,e){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){var e=c.get(t,d);e?n(e):c.load(t,d,(function(t,e){t?r(t):n(e)}))})));case 1:case"end":return n.stop()}}),n)})));return function(t,r){return n.apply(this,arguments)}}(),n.playAnim=function(n,t,r){return void 0===r&&(r=0),new Promise((function(e){var u;o(n,!0)?u=n instanceof a?n.getComponent(i):n:e(null),u?(u.play(t),u.node.once("end",(function(){var n=u.getState(t);e(n)})),u.once(i.EventType.FINISHED,(function(){1==r?n instanceof a&&(n.active=!1):2==r&&n.destroy();var o=u.getState(t);e(o)}))):e(null)}))},n.tryParseJSON=function(n,t){var r=t;try{r=JSON.parse(n)||t}catch(n){}return r},n.getLocalStorage=function(n,t){var r=u.localStorage.getItem(n);return this.tryParseJSON(r,t)},n.setLocalStorage=function(n,t){u.localStorage.setItem(n,JSON.stringify(t))},n}());e._RF.pop()}}}));

System.register("chunks:///_virtual/WebSocket.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Protocol.ts","./env"],(function(e){var t,n,o,i;return{setters:[function(e){t=e.createClass,n=e.extends},function(e){o=e.cclegacy},function(e){i=e.CmdId},function(e){e.DEBUG}],execute:function(){o._RF.push({},"6cf3dHqgslOvJYTU23Y3WEr","WebSocket",void 0);var c=e("WebSocketEventType",function(e){return e.CONNECTED="connected",e.INTERRUPT="interrupt",e.DISCONNECTED="disconnected",e.BROADCAST="broadcast",e.ERROR="error",e.RECONNECTING="reconnecting",e}({})),s=e("WSState",function(e){return e[e.Connected=0]="Connected",e[e.Connecting=1]="Connecting",e[e.Disconnect=2]="Disconnect",e[e.Interrupt=3]="Interrupt",e[e.Reconnect=4]="Reconnect",e}({}));e("WebSocketManager",function(){function e(e,t,o){this.ws=void 0,this._state=s.Disconnect,this.config=void 0,this.eventListeners=new Map,this.encode=void 0,this.decode=void 0,this.heartbeatTimer=null,this.reconnectTimer=null,this.connectTimeout=null,this.reconnectAttempts=0,this.reqIdCounter=1,this.pendingRequests=new Map,this.encode=t,this.decode=o,this.config=n({heartbeatInterval:3e4,reconnectInterval:5e3,maxReconnectAttempts:5,timeout:1e4},e)}var o=e.prototype;return o.connect=function(){var e=this;return new Promise((function(t,n){if(e._state!==s.Connected&&e._state!==s.Connecting){e._state=s.Connecting,e.emit(c.CONNECTED,null);try{e.ws=new WebSocket(e.config.url),e.ws.binaryType="arraybuffer",e.connectTimeout=setTimeout((function(){var t;e._state===s.Connecting&&(null==(t=e.ws)||t.close(),n(new Error("Connection timeout")))}),e.config.timeout),e.ws.onopen=function(){e.connectTimeout&&(clearTimeout(e.connectTimeout),e.connectTimeout=null),e._state=s.Connected,e.reconnectAttempts=0,e.startHeartbeat(),console.log("WebSocket connected"),t()},e.ws.onmessage=function(t){e.handleMessage(t)},e.ws.onerror=function(t){console.error("WebSocket error:",t),e.emit(c.ERROR,t)},e.ws.onclose=function(t){console.log("WebSocket closed:",t.code,t.reason),e.emit(c.INTERRUPT,{code:t.code,reason:t.reason}),e.handleDisconnect()}}catch(t){e._state=s.Disconnect,n(t)}}else t()}))},o.disconnect=function(){this.eventListeners.clear(),this.clearTimers(),this.clearPendingRequests(),this.ws&&(this.ws.close(),this.ws=null),this._state=s.Disconnect,this.emit(c.DISCONNECTED,null)},o.send=function(e,t,n){var o=this;return void 0===t&&(t=new Uint8Array(0)),void 0===n&&(n=!1),new Promise((function(i,c){if(o._state===s.Connected&&o.ws)try{var r=n?o.generateReqId():0,a=o.encode(e,t,r);if(n){var u=setTimeout((function(){o.pendingRequests.delete(r),c(new Error("Request timeout"))}),1e4);o.pendingRequests.set(r,{resolve:i,reject:c,timer:u})}o.ws.send(a),n||i()}catch(e){c(e)}else c(new Error("WebSocket not connected"))}))},o.on=function(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push(t)},o.off=function(e,t){if(this.eventListeners.has(e))if(t){var n=this.eventListeners.get(e),o=n.indexOf(t);o>-1&&n.splice(o,1)}else this.eventListeners.delete(e)},o.handleMessage=function(e){try{var t;if(e.data instanceof ArrayBuffer)t=new Uint8Array(e.data);else{if(!(e.data instanceof Uint8Array))return void console.error("Unsupported message type:",typeof e.data);t=e.data}var n=this.decode(t);if(!n)return void console.error("Failed to decode BaseCmd");if(n.ReqId>0&&this.pendingRequests.has(n.ReqId)){var o=this.pendingRequests.get(n.ReqId);return this.pendingRequests.delete(n.ReqId),o.timer&&clearTimeout(o.timer),n.code?void(0===n.code?o.resolve(n.Data):(console.log("message: ",n),o.reject(n))):void o.resolve(n.Data)}n.ReqId||this.emit(c.BROADCAST,n)}catch(e){console.error("Handle message error:",e),this.emit(c.ERROR,e)}},o.handleDisconnect=function(){this.clearTimers(),this._state=s.Disconnect,this.config&&this.reconnectAttempts<this.config.maxReconnectAttempts&&this.attemptReconnect()},o.attemptReconnect=function(){var e=this;this._state!==s.Reconnect&&(this._state=s.Reconnect,this.reconnectAttempts++,console.log("Attempting to reconnect ("+this.reconnectAttempts+"/"+this.config.maxReconnectAttempts+")..."),this.reconnectTimer=setTimeout((function(){e.connect().catch((function(t){console.error("Reconnect failed:",t),e.reconnectAttempts>=e.config.maxReconnectAttempts&&(console.error("Max reconnect attempts reached"),e.emit(c.ERROR,new Error("Max reconnect attempts reached")))}))}),this.config.reconnectInterval))},o.ping=function(){return this.send(i.Ping,this.config.ping,!0)},o.startHeartbeat=function(){var e=this;this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((function(){e.isConnected&&e.ping().catch((function(e){console.error("Ping failed:",e)}))}),this.config.heartbeatInterval)},o.clearTimers=function(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=null)},o.clearPendingRequests=function(){this.pendingRequests.forEach((function(e){e.timer&&clearTimeout(e.timer),e.reject(new Error("Connection closed"))})),this.pendingRequests.clear()},o.generateReqId=function(){return this.reqIdCounter++},o.emit=function(e,t){var n=this.eventListeners.get(e);n&&n.forEach((function(n){try{n(t)}catch(t){console.error("Error in event listener for "+e+":",t)}}))},t(e,[{key:"status",get:function(){return this._state}},{key:"isConnected",get:function(){return this._state===s.Connected}}]),e}());o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});